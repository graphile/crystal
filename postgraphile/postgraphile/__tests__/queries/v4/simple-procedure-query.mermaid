%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect46[["PgSelect[46∈0] ➊<br />ᐸint_set_queryᐳ"]]:::plan
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant90{{"Constant[90∈0] ➊<br />ᐸ5ᐳ"}}:::plan
    Constant45{{"Constant[45∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant92{{"Constant[92∈0] ➊<br />ᐸ6ᐳ"}}:::plan
    Constant7{{"Constant[7∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    Object11 & Constant90 & Constant45 & Constant92 & Constant7 & Constant7 --> PgSelect46
    PgSelect25[["PgSelect[25∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Lambda27{{"Lambda[27∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    ApplyInput28{{"ApplyInput[28∈0] ➊"}}:::plan
    Object11 & Lambda27 & Constant7 & Constant7 & ApplyInput28 --> PgSelect25
    PgSelect35[["PgSelect[35∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Constant91{{"Constant[91∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput38{{"ApplyInput[38∈0] ➊"}}:::plan
    Object11 & Lambda27 & Constant91 & Constant91 & ApplyInput38 --> PgSelect35
    PgSelect71[["PgSelect[71∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda73{{"Lambda[73∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Constant93{{"Constant[93∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    ApplyInput74{{"ApplyInput[74∈0] ➊"}}:::plan
    Object11 & Lambda73 & Constant93 & Constant7 & ApplyInput74 --> PgSelect71
    PgSelect8[["PgSelect[8∈0] ➊<br />ᐸcompound_type_set_queryᐳ"]]:::plan
    Object11 & Constant90 & Constant7 --> PgSelect8
    PgSelect52[["PgSelect[52∈0] ➊<br />ᐸstatic_big_integerᐳ"]]:::plan
    Object11 & Constant7 & Constant7 --> PgSelect52
    PgSelect58[["PgSelect[58∈0] ➊<br />ᐸquery_interval_setᐳ"]]:::plan
    Object11 & Constant7 & Constant7 --> PgSelect58
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    PgSelectRows12[["PgSelectRows[12∈0] ➊"]]:::plan
    PgSelect8 --> PgSelectRows12
    Constant7 --> Lambda27
    Constant7 --> ApplyInput28
    PgSelectRows29[["PgSelectRows[29∈0] ➊"]]:::plan
    PgSelect25 --> PgSelectRows29
    Constant7 --> ApplyInput38
    PgSelectRows39[["PgSelectRows[39∈0] ➊"]]:::plan
    PgSelect35 --> PgSelectRows39
    PgSelectRows48[["PgSelectRows[48∈0] ➊"]]:::plan
    PgSelect46 --> PgSelectRows48
    PgSelectRows54[["PgSelectRows[54∈0] ➊"]]:::plan
    PgSelect52 --> PgSelectRows54
    PgSelectRows60[["PgSelectRows[60∈0] ➊"]]:::plan
    PgSelect58 --> PgSelectRows60
    Constant7 --> Lambda73
    Constant7 --> ApplyInput74
    PgSelectRows75[["PgSelectRows[75∈0] ➊"]]:::plan
    PgSelect71 --> PgSelectRows75
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item13[/"__Item[13∈1]<br />ᐸ12ᐳ"\]:::itemplan
    PgSelectRows12 ==> __Item13
    PgSelectSingle14{{"PgSelectSingle[14∈1]<br />ᐸcompound_type_set_queryᐳ"}}:::plan
    __Item13 --> PgSelectSingle14
    PgClassExpression15{{"PgClassExpression[15∈2]<br />ᐸ__compound...uery__.”a”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression15
    PgClassExpression16{{"PgClassExpression[16∈2]<br />ᐸ__compound...uery__.”b”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈2]<br />ᐸ__compound...uery__.”c”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression17
    PgClassExpression18{{"PgClassExpression[18∈2]<br />ᐸ__compound...uery__.”d”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression18
    PgClassExpression19{{"PgClassExpression[19∈2]<br />ᐸ__compound...uery__.”e”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression19
    PgClassExpression20{{"PgClassExpression[20∈2]<br />ᐸ__compound...uery__.”f”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression20
    PgClassExpression21{{"PgClassExpression[21∈2]<br />ᐸ__compound...uery__.”g”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression21
    __Item30[/"__Item[30∈4]<br />ᐸ29ᐳ"\]:::itemplan
    PgSelectRows29 ==> __Item30
    PgSelectSingle31{{"PgSelectSingle[31∈4]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item30 --> PgSelectSingle31
    PgClassExpression32{{"PgClassExpression[32∈5]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle31 --> PgClassExpression32
    __Item40[/"__Item[40∈6]<br />ᐸ39ᐳ"\]:::itemplan
    PgSelectRows39 ==> __Item40
    PgSelectSingle41{{"PgSelectSingle[41∈6]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item40 --> PgSelectSingle41
    PgClassExpression42{{"PgClassExpression[42∈7]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle41 --> PgClassExpression42
    __Item49[/"__Item[49∈8]<br />ᐸ48ᐳ"\]:::itemplan
    PgSelectRows48 ==> __Item49
    PgSelectSingle50{{"PgSelectSingle[50∈8]<br />ᐸint_set_queryᐳ"}}:::plan
    __Item49 --> PgSelectSingle50
    PgClassExpression51{{"PgClassExpression[51∈8]<br />ᐸ__int_set_query__.vᐳ"}}:::plan
    PgSelectSingle50 --> PgClassExpression51
    __Item55[/"__Item[55∈9]<br />ᐸ54ᐳ"\]:::itemplan
    PgSelectRows54 ==> __Item55
    PgSelectSingle56{{"PgSelectSingle[56∈9]<br />ᐸstatic_big_integerᐳ"}}:::plan
    __Item55 --> PgSelectSingle56
    PgClassExpression57{{"PgClassExpression[57∈9]<br />ᐸ__static_b...nteger__.vᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression57
    __Item61[/"__Item[61∈10]<br />ᐸ60ᐳ"\]:::itemplan
    PgSelectRows60 ==> __Item61
    PgSelectSingle62{{"PgSelectSingle[62∈10]<br />ᐸquery_interval_setᐳ"}}:::plan
    __Item61 --> PgSelectSingle62
    PgClassExpression63{{"PgClassExpression[63∈10]<br />ᐸ__query_in...al_set__.vᐳ"}}:::plan
    PgSelectSingle62 --> PgClassExpression63
    PgSelect80[["PgSelect[80∈12]<br />ᐸpost_computed_interval_setᐳ"]]:::plan
    PgClassExpression79{{"PgClassExpression[79∈12]<br />ᐸ__post__ᐳ"}}:::plan
    Object11 & PgClassExpression79 & Constant7 & Constant7 --> PgSelect80
    __Item76[/"__Item[76∈12]<br />ᐸ75ᐳ"\]:::itemplan
    PgSelectRows75 ==> __Item76
    PgSelectSingle77{{"PgSelectSingle[77∈12]<br />ᐸpostᐳ"}}:::plan
    __Item76 --> PgSelectSingle77
    PgClassExpression78{{"PgClassExpression[78∈12]<br />ᐸ__post__.”id”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression78
    PgSelectSingle77 --> PgClassExpression79
    PgSelectRows84[["PgSelectRows[84∈12]"]]:::plan
    PgSelect80 --> PgSelectRows84
    __Item85[/"__Item[85∈13]<br />ᐸ84ᐳ"\]:::itemplan
    PgSelectRows84 ==> __Item85
    PgSelectSingle86{{"PgSelectSingle[86∈13]<br />ᐸpost_computed_interval_setᐳ"}}:::plan
    __Item85 --> PgSelectSingle86
    PgClassExpression87{{"PgClassExpression[87∈13]<br />ᐸ__post_com...al_set__.vᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression87

    %% define steps

    subgraph "Buckets for queries/v4/simple-procedure-query"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 7, 9, 10, 45, 90, 91, 92, 93, 11, 27, 28, 38, 73, 74<br />2: 8, 25, 35, 46, 52, 58, 71<br />3: 12, 29, 39, 48, 54, 60, 75"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant7,PgSelect8,Access9,Access10,Object11,PgSelectRows12,PgSelect25,Lambda27,ApplyInput28,PgSelectRows29,PgSelect35,ApplyInput38,PgSelectRows39,Constant45,PgSelect46,PgSelectRows48,PgSelect52,PgSelectRows54,PgSelect58,PgSelectRows60,PgSelect71,Lambda73,ApplyInput74,PgSelectRows75,Constant90,Constant91,Constant92,Constant93 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ12ᐳ[13]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item13,PgSelectSingle14 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 14<br /><br />ROOT PgSelectSingle{1}ᐸcompound_type_set_queryᐳ[14]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression15,PgClassExpression16,PgClassExpression17,PgClassExpression18,PgClassExpression19,PgClassExpression20,PgClassExpression21 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 21<br /><br />ROOT PgClassExpression{2}ᐸ__compound...uery__.”g”ᐳ[21]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ29ᐳ[30]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item30,PgSelectSingle31 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 31<br /><br />ROOT PgSelectSingle{4}ᐸtable_set_queryᐳ[31]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression32 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ39ᐳ[40]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item40,PgSelectSingle41 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 41<br /><br />ROOT PgSelectSingle{6}ᐸtable_set_queryᐳ[41]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression42 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ48ᐳ[49]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item49,PgSelectSingle50,PgClassExpression51 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ54ᐳ[55]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item55,PgSelectSingle56,PgClassExpression57 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ60ᐳ[61]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item61,PgSelectSingle62,PgClassExpression63 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 63<br /><br />ROOT PgClassExpression{10}ᐸ__query_in...al_set__.vᐳ[63]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11 bucket11
    Bucket12("Bucket 12 (listItem)<br />Deps: 11, 7<br /><br />ROOT __Item{12}ᐸ75ᐳ[76]<br />1: <br />ᐳ: 77, 78, 79<br />2: PgSelect[80]<br />3: PgSelectRows[84]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,__Item76,PgSelectSingle77,PgClassExpression78,PgClassExpression79,PgSelect80,PgSelectRows84 bucket12
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ84ᐳ[85]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item85,PgSelectSingle86,PgClassExpression87 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 87<br /><br />ROOT PgClassExpression{13}ᐸ__post_com...al_set__.vᐳ[87]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14
    Bucket0 --> Bucket1 & Bucket4 & Bucket6 & Bucket8 & Bucket9 & Bucket10 & Bucket12
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket4 --> Bucket5
    Bucket6 --> Bucket7
    Bucket10 --> Bucket11
    Bucket12 --> Bucket13
    Bucket13 --> Bucket14
    end
