%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect34[["PgSelect[34∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Lambda27{{"Lambda[27∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Constant88{{"Constant[88∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    Object11 & Lambda27 & Constant88 & Constant88 --> PgSelect34
    PgSelect44[["PgSelect[44∈0] ➊<br />ᐸint_set_queryᐳ"]]:::plan
    Constant87{{"Constant[87∈0] ➊<br />ᐸ5ᐳ"}}:::plan
    Constant43{{"Constant[43∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant89{{"Constant[89∈0] ➊<br />ᐸ6ᐳ"}}:::plan
    Object11 & Constant87 & Constant43 & Constant89 --> PgSelect44
    PgSelect69[["PgSelect[69∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda71{{"Lambda[71∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Constant90{{"Constant[90∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object11 & Lambda71 & Constant90 --> PgSelect69
    PgSelect8[["PgSelect[8∈0] ➊<br />ᐸcompound_type_set_queryᐳ"]]:::plan
    Object11 & Constant87 --> PgSelect8
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    PgSelect25[["PgSelect[25∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Object11 & Lambda27 --> PgSelect25
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    PgSelectRows12[["PgSelectRows[12∈0] ➊"]]:::plan
    PgSelect8 --> PgSelectRows12
    Constant7{{"Constant[7∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    Constant7 --> Lambda27
    PgSelectRows28[["PgSelectRows[28∈0] ➊"]]:::plan
    PgSelect25 --> PgSelectRows28
    PgSelectRows37[["PgSelectRows[37∈0] ➊"]]:::plan
    PgSelect34 --> PgSelectRows37
    PgSelectRows46[["PgSelectRows[46∈0] ➊"]]:::plan
    PgSelect44 --> PgSelectRows46
    PgSelect50[["PgSelect[50∈0] ➊<br />ᐸstatic_big_integerᐳ"]]:::plan
    Object11 --> PgSelect50
    PgSelectRows52[["PgSelectRows[52∈0] ➊"]]:::plan
    PgSelect50 --> PgSelectRows52
    PgSelect56[["PgSelect[56∈0] ➊<br />ᐸquery_interval_setᐳ"]]:::plan
    Object11 --> PgSelect56
    PgSelectRows58[["PgSelectRows[58∈0] ➊"]]:::plan
    PgSelect56 --> PgSelectRows58
    Constant7 --> Lambda71
    PgSelectRows72[["PgSelectRows[72∈0] ➊"]]:::plan
    PgSelect69 --> PgSelectRows72
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item13[/"__Item[13∈1]<br />ᐸ12ᐳ"\]:::itemplan
    PgSelectRows12 ==> __Item13
    PgSelectSingle14{{"PgSelectSingle[14∈1]<br />ᐸcompound_type_set_queryᐳ"}}:::plan
    __Item13 --> PgSelectSingle14
    PgClassExpression15{{"PgClassExpression[15∈2]<br />ᐸ__compound...uery__.”a”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression15
    PgClassExpression16{{"PgClassExpression[16∈2]<br />ᐸ__compound...uery__.”b”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈2]<br />ᐸ__compound...uery__.”c”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression17
    PgClassExpression18{{"PgClassExpression[18∈2]<br />ᐸ__compound...uery__.”d”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression18
    PgClassExpression19{{"PgClassExpression[19∈2]<br />ᐸ__compound...uery__.”e”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression19
    PgClassExpression20{{"PgClassExpression[20∈2]<br />ᐸ__compound...uery__.”f”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression20
    PgClassExpression21{{"PgClassExpression[21∈2]<br />ᐸ__compound...uery__.”g”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression21
    __Item29[/"__Item[29∈4]<br />ᐸ28ᐳ"\]:::itemplan
    PgSelectRows28 ==> __Item29
    PgSelectSingle30{{"PgSelectSingle[30∈4]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item29 --> PgSelectSingle30
    PgClassExpression31{{"PgClassExpression[31∈5]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle30 --> PgClassExpression31
    __Item38[/"__Item[38∈6]<br />ᐸ37ᐳ"\]:::itemplan
    PgSelectRows37 ==> __Item38
    PgSelectSingle39{{"PgSelectSingle[39∈6]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item38 --> PgSelectSingle39
    PgClassExpression40{{"PgClassExpression[40∈7]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle39 --> PgClassExpression40
    __Item47[/"__Item[47∈8]<br />ᐸ46ᐳ"\]:::itemplan
    PgSelectRows46 ==> __Item47
    PgSelectSingle48{{"PgSelectSingle[48∈8]<br />ᐸint_set_queryᐳ"}}:::plan
    __Item47 --> PgSelectSingle48
    PgClassExpression49{{"PgClassExpression[49∈8]<br />ᐸ__int_set_query__.vᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression49
    __Item53[/"__Item[53∈9]<br />ᐸ52ᐳ"\]:::itemplan
    PgSelectRows52 ==> __Item53
    PgSelectSingle54{{"PgSelectSingle[54∈9]<br />ᐸstatic_big_integerᐳ"}}:::plan
    __Item53 --> PgSelectSingle54
    PgClassExpression55{{"PgClassExpression[55∈9]<br />ᐸ__static_b...nteger__.vᐳ"}}:::plan
    PgSelectSingle54 --> PgClassExpression55
    __Item59[/"__Item[59∈10]<br />ᐸ58ᐳ"\]:::itemplan
    PgSelectRows58 ==> __Item59
    PgSelectSingle60{{"PgSelectSingle[60∈10]<br />ᐸquery_interval_setᐳ"}}:::plan
    __Item59 --> PgSelectSingle60
    PgClassExpression61{{"PgClassExpression[61∈10]<br />ᐸ__query_in...al_set__.vᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression61
    PgSelect77[["PgSelect[77∈12]<br />ᐸpost_computed_interval_setᐳ"]]:::plan
    PgClassExpression76{{"PgClassExpression[76∈12]<br />ᐸ__post__ᐳ"}}:::plan
    Object11 & PgClassExpression76 --> PgSelect77
    __Item73[/"__Item[73∈12]<br />ᐸ72ᐳ"\]:::itemplan
    PgSelectRows72 ==> __Item73
    PgSelectSingle74{{"PgSelectSingle[74∈12]<br />ᐸpostᐳ"}}:::plan
    __Item73 --> PgSelectSingle74
    PgClassExpression75{{"PgClassExpression[75∈12]<br />ᐸ__post__.”id”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression75
    PgSelectSingle74 --> PgClassExpression76
    PgSelectRows81[["PgSelectRows[81∈12]"]]:::plan
    PgSelect77 --> PgSelectRows81
    __Item82[/"__Item[82∈13]<br />ᐸ81ᐳ"\]:::itemplan
    PgSelectRows81 ==> __Item82
    PgSelectSingle83{{"PgSelectSingle[83∈13]<br />ᐸpost_computed_interval_setᐳ"}}:::plan
    __Item82 --> PgSelectSingle83
    PgClassExpression84{{"PgClassExpression[84∈13]<br />ᐸ__post_com...al_set__.vᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression84

    %% define steps

    subgraph "Buckets for queries/v4/simple-procedure-query"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 7, 9, 10, 43, 87, 88, 89, 90, 11, 27, 71<br />2: 8, 25, 34, 44, 50, 56, 69<br />3: 12, 28, 37, 46, 52, 58, 72"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant7,PgSelect8,Access9,Access10,Object11,PgSelectRows12,PgSelect25,Lambda27,PgSelectRows28,PgSelect34,PgSelectRows37,Constant43,PgSelect44,PgSelectRows46,PgSelect50,PgSelectRows52,PgSelect56,PgSelectRows58,PgSelect69,Lambda71,PgSelectRows72,Constant87,Constant88,Constant89,Constant90 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ12ᐳ[13]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item13,PgSelectSingle14 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 14<br /><br />ROOT PgSelectSingle{1}ᐸcompound_type_set_queryᐳ[14]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression15,PgClassExpression16,PgClassExpression17,PgClassExpression18,PgClassExpression19,PgClassExpression20,PgClassExpression21 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 21<br /><br />ROOT PgClassExpression{2}ᐸ__compound...uery__.”g”ᐳ[21]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ28ᐳ[29]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item29,PgSelectSingle30 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 30<br /><br />ROOT PgSelectSingle{4}ᐸtable_set_queryᐳ[30]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression31 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ37ᐳ[38]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item38,PgSelectSingle39 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 39<br /><br />ROOT PgSelectSingle{6}ᐸtable_set_queryᐳ[39]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression40 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ46ᐳ[47]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item47,PgSelectSingle48,PgClassExpression49 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ52ᐳ[53]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item53,PgSelectSingle54,PgClassExpression55 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ58ᐳ[59]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item59,PgSelectSingle60,PgClassExpression61 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 61<br /><br />ROOT PgClassExpression{10}ᐸ__query_in...al_set__.vᐳ[61]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11 bucket11
    Bucket12("Bucket 12 (listItem)<br />Deps: 11<br /><br />ROOT __Item{12}ᐸ72ᐳ[73]<br />1: <br />ᐳ: 74, 75, 76<br />2: PgSelect[77]<br />3: PgSelectRows[81]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,__Item73,PgSelectSingle74,PgClassExpression75,PgClassExpression76,PgSelect77,PgSelectRows81 bucket12
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ81ᐳ[82]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item82,PgSelectSingle83,PgClassExpression84 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 84<br /><br />ROOT PgClassExpression{13}ᐸ__post_com...al_set__.vᐳ[84]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14
    Bucket0 --> Bucket1 & Bucket4 & Bucket6 & Bucket8 & Bucket9 & Bucket10 & Bucket12
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket4 --> Bucket5
    Bucket6 --> Bucket7
    Bucket10 --> Bucket11
    Bucket12 --> Bucket13
    Bucket13 --> Bucket14
    end
