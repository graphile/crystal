%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/simple-procedure-query"
    Bucket0("Bucket 0 (root)<br /><br />1: PgSelectInlineApply[85]<br />ᐳ: 7, 9, 10, 66, 89, 90, 91, 92, 11, 22<br />2: 8, 12, 16, 20, 23, 25, 28<br />ᐳ: Access[86]<br />3: 30, 31, 32, 33, 34, 35, 36"):::bucket
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ30ᐳ[37]"):::bucket
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ31ᐳ[39]"):::bucket
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ32ᐳ[41]"):::bucket
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ33ᐳ[43]"):::bucket
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ34ᐳ[46]"):::bucket
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ35ᐳ[49]"):::bucket
    Bucket7("Bucket 7 (listItem)<br />Deps: 86<br /><br />ROOT __Item{7}ᐸ36ᐳ[52]<br />1: <br />ᐳ: 53, 87, 58, 88<br />2: PgSelectRows[76]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 38<br /><br />ROOT PgSelectSingle{1}ᐸcompound_type_set_queryᐳ[38]"):::bucket
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 40<br /><br />ROOT PgSelectSingle{2}ᐸtable_set_queryᐳ[40]"):::bucket
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 42<br /><br />ROOT PgSelectSingle{3}ᐸtable_set_queryᐳ[42]"):::bucket
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 51<br /><br />ROOT PgClassExpression{6}ᐸ__query_in...al_set__.vᐳ[51]"):::bucket
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 75<br /><br />ROOT PgClassExpression{8}ᐸ__compound...uery__.”g”ᐳ[75]"):::bucket
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ76ᐳ[77]"):::bucket
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 79<br /><br />ROOT PgClassExpression{13}ᐸ__post_com...al_set__.vᐳ[79]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7
    Bucket1 --> Bucket8
    Bucket2 --> Bucket9
    Bucket3 --> Bucket10
    Bucket6 --> Bucket11
    Bucket7 --> Bucket13
    Bucket8 --> Bucket12
    Bucket13 --> Bucket14

    %% plan dependencies
    PgSelect28[["PgSelect[28∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant92{{"Constant[92∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    PgFromExpression66{{"PgFromExpression[66∈0] ➊"}}:::plan
    PgSelectInlineApply85["PgSelectInlineApply[85∈0] ➊"]:::plan
    Object11 & Constant92 & PgFromExpression66 & PgSelectInlineApply85 --> PgSelect28
    PgSelect16[["PgSelect[16∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Constant90{{"Constant[90∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    Object11 --> PgSelect16
    Constant90 -- 2 --> PgSelect16
    PgFromExpression22{{"PgFromExpression[22∈0] ➊"}}:::plan
    Constant89{{"Constant[89∈0] ➊<br />ᐸ5ᐳ"}}:::plan
    Constant91{{"Constant[91∈0] ➊<br />ᐸ6ᐳ"}}:::plan
    Constant89 & Constant91 --> PgFromExpression22
    PgSelect8[["PgSelect[8∈0] ➊<br />ᐸcompound_type_set_queryᐳ"]]:::plan
    Object11 & Constant89 --> PgSelect8
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    PgSelect20[["PgSelect[20∈0] ➊<br />ᐸint_set_queryᐳ"]]:::plan
    Object11 & PgFromExpression22 --> PgSelect20
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    PgSelect12[["PgSelect[12∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Object11 --> PgSelect12
    PgSelect23[["PgSelect[23∈0] ➊<br />ᐸstatic_big_integerᐳ"]]:::plan
    Object11 --> PgSelect23
    PgSelect25[["PgSelect[25∈0] ➊<br />ᐸquery_interval_setᐳ"]]:::plan
    Object11 --> PgSelect25
    PgSelectRows30[["PgSelectRows[30∈0] ➊"]]:::plan
    PgSelect8 --> PgSelectRows30
    PgSelectRows31[["PgSelectRows[31∈0] ➊"]]:::plan
    PgSelect12 --> PgSelectRows31
    PgSelectRows32[["PgSelectRows[32∈0] ➊"]]:::plan
    PgSelect16 --> PgSelectRows32
    PgSelectRows33[["PgSelectRows[33∈0] ➊"]]:::plan
    PgSelect20 --> PgSelectRows33
    PgSelectRows34[["PgSelectRows[34∈0] ➊"]]:::plan
    PgSelect23 --> PgSelectRows34
    PgSelectRows35[["PgSelectRows[35∈0] ➊"]]:::plan
    PgSelect25 --> PgSelectRows35
    PgSelectRows36[["PgSelectRows[36∈0] ➊"]]:::plan
    PgSelect28 --> PgSelectRows36
    Access86{{"Access[86∈0] ➊<br />ᐸ28.m.subqueryDetailsFor62ᐳ"}}:::plan
    PgSelect28 --> Access86
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item37[/"__Item[37∈1]<br />ᐸ30ᐳ"\]:::itemplan
    PgSelectRows30 ==> __Item37
    PgSelectSingle38{{"PgSelectSingle[38∈1]<br />ᐸcompound_type_set_queryᐳ"}}:::plan
    __Item37 --> PgSelectSingle38
    __Item39[/"__Item[39∈2]<br />ᐸ31ᐳ"\]:::itemplan
    PgSelectRows31 ==> __Item39
    PgSelectSingle40{{"PgSelectSingle[40∈2]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item39 --> PgSelectSingle40
    __Item41[/"__Item[41∈3]<br />ᐸ32ᐳ"\]:::itemplan
    PgSelectRows32 ==> __Item41
    PgSelectSingle42{{"PgSelectSingle[42∈3]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item41 --> PgSelectSingle42
    __Item43[/"__Item[43∈4]<br />ᐸ33ᐳ"\]:::itemplan
    PgSelectRows33 ==> __Item43
    PgSelectSingle44{{"PgSelectSingle[44∈4]<br />ᐸint_set_queryᐳ"}}:::plan
    __Item43 --> PgSelectSingle44
    PgClassExpression45{{"PgClassExpression[45∈4]<br />ᐸ__int_set_query__.vᐳ"}}:::plan
    PgSelectSingle44 --> PgClassExpression45
    __Item46[/"__Item[46∈5]<br />ᐸ34ᐳ"\]:::itemplan
    PgSelectRows34 ==> __Item46
    PgSelectSingle47{{"PgSelectSingle[47∈5]<br />ᐸstatic_big_integerᐳ"}}:::plan
    __Item46 --> PgSelectSingle47
    PgClassExpression48{{"PgClassExpression[48∈5]<br />ᐸ__static_b...nteger__.vᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression48
    __Item49[/"__Item[49∈6]<br />ᐸ35ᐳ"\]:::itemplan
    PgSelectRows35 ==> __Item49
    PgSelectSingle50{{"PgSelectSingle[50∈6]<br />ᐸquery_interval_setᐳ"}}:::plan
    __Item49 --> PgSelectSingle50
    PgClassExpression51{{"PgClassExpression[51∈6]<br />ᐸ__query_in...al_set__.vᐳ"}}:::plan
    PgSelectSingle50 --> PgClassExpression51
    List87{{"List[87∈7]<br />ᐸ86,52ᐳ"}}:::plan
    __Item52[/"__Item[52∈7]<br />ᐸ36ᐳ"\]:::itemplan
    Access86 & __Item52 --> List87
    PgSelectRows36 ==> __Item52
    PgSelectSingle53{{"PgSelectSingle[53∈7]<br />ᐸpostᐳ"}}:::plan
    __Item52 --> PgSelectSingle53
    PgClassExpression58{{"PgClassExpression[58∈7]<br />ᐸ__post__.”id”ᐳ"}}:::plan
    PgSelectSingle53 --> PgClassExpression58
    PgSelectRows76[["PgSelectRows[76∈7]"]]:::plan
    Lambda88{{"Lambda[88∈7]<br />ᐸpgInlineViaSubqueryTransformᐳ"}}:::plan
    Lambda88 --> PgSelectRows76
    List87 --> Lambda88
    PgClassExpression54{{"PgClassExpression[54∈8]<br />ᐸ__compound...uery__.”a”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression54
    PgClassExpression59{{"PgClassExpression[59∈8]<br />ᐸ__compound...uery__.”b”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression59
    PgClassExpression67{{"PgClassExpression[67∈8]<br />ᐸ__compound...uery__.”c”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression67
    PgClassExpression69{{"PgClassExpression[69∈8]<br />ᐸ__compound...uery__.”d”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression69
    PgClassExpression71{{"PgClassExpression[71∈8]<br />ᐸ__compound...uery__.”e”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression71
    PgClassExpression73{{"PgClassExpression[73∈8]<br />ᐸ__compound...uery__.”f”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression73
    PgClassExpression75{{"PgClassExpression[75∈8]<br />ᐸ__compound...uery__.”g”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression75
    PgClassExpression55{{"PgClassExpression[55∈9]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle40 --> PgClassExpression55
    PgClassExpression56{{"PgClassExpression[56∈10]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle42 --> PgClassExpression56
    __Item77[/"__Item[77∈13]<br />ᐸ76ᐳ"\]:::itemplan
    PgSelectRows76 ==> __Item77
    PgSelectSingle78{{"PgSelectSingle[78∈13]<br />ᐸpost_computed_interval_setᐳ"}}:::plan
    __Item77 --> PgSelectSingle78
    PgClassExpression79{{"PgClassExpression[79∈13]<br />ᐸ__post_com...al_set__.vᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression79

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect8,Access9,Access10,Object11,PgSelect12,PgSelect16,PgSelect20,PgFromExpression22,PgSelect23,PgSelect25,PgSelect28,PgSelectRows30,PgSelectRows31,PgSelectRows32,PgSelectRows33,PgSelectRows34,PgSelectRows35,PgSelectRows36,PgFromExpression66,PgSelectInlineApply85,Access86,Constant89,Constant90,Constant91,Constant92 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item37,PgSelectSingle38 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item39,PgSelectSingle40 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item41,PgSelectSingle42 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item43,PgSelectSingle44,PgClassExpression45 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item46,PgSelectSingle47,PgClassExpression48 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item49,PgSelectSingle50,PgClassExpression51 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item52,PgSelectSingle53,PgClassExpression58,PgSelectRows76,List87,Lambda88 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression54,PgClassExpression59,PgClassExpression67,PgClassExpression69,PgClassExpression71,PgClassExpression73,PgClassExpression75 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgClassExpression55 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression56 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12 bucket12
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item77,PgSelectSingle78,PgClassExpression79 bucket13
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14

