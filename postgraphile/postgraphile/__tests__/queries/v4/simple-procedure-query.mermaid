%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect48[["PgSelect[48∈0] ➊<br />ᐸint_set_queryᐳ"]]:::plan
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant96{{"Constant[96∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant47{{"Constant[47∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant160{{"Constant[160∈0] ➊<br />ᐸ6ᐳ"}}:::plan
    Lambda109{{"Lambda[109∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object11 & Constant96 & Constant47 & Constant160 & Lambda109 --> PgSelect48
    PgSelect77[["PgSelect[77∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda158{{"Lambda[158∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object11 & Lambda109 & Lambda158 --> PgSelect77
    PgSelect8[["PgSelect[8∈0] ➊<br />ᐸcompound_type_set_queryᐳ"]]:::plan
    Lambda101{{"Lambda[101∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object11 & Lambda101 --> PgSelect8
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    PgSelect28[["PgSelect[28∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Object11 & Lambda109 --> PgSelect28
    PgSelect37[["PgSelect[37∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Lambda117{{"Lambda[117∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object11 & Lambda117 --> PgSelect37
    PgSelect55[["PgSelect[55∈0] ➊<br />ᐸstatic_big_integerᐳ"]]:::plan
    Object11 & Lambda109 --> PgSelect55
    PgSelect62[["PgSelect[62∈0] ➊<br />ᐸquery_interval_setᐳ"]]:::plan
    Object11 & Lambda109 --> PgSelect62
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    Constant161{{"Constant[161∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant161 --> Lambda101
    Constant162{{"Constant[162∈0] ➊<br />ᐸ[Object: null prototype] {   cursorLower: null,   cursorUppeᐳ"}}:::plan
    Constant162 --> Lambda109
    Constant163{{"Constant[163∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant163 --> Lambda117
    Constant164{{"Constant[164∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant164 --> Lambda158
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item12[/"__Item[12∈1]<br />ᐸ8ᐳ"\]:::itemplan
    PgSelect8 ==> __Item12
    PgSelectSingle13{{"PgSelectSingle[13∈1]<br />ᐸcompound_type_set_queryᐳ"}}:::plan
    __Item12 --> PgSelectSingle13
    PgClassExpression14{{"PgClassExpression[14∈2]<br />ᐸ__compound...uery__.”a”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression14
    PgClassExpression15{{"PgClassExpression[15∈2]<br />ᐸ__compound...uery__.”b”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression15
    PgClassExpression16{{"PgClassExpression[16∈2]<br />ᐸ__compound...uery__.”c”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈2]<br />ᐸ__compound...uery__.”d”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression17
    PgClassExpression18{{"PgClassExpression[18∈2]<br />ᐸ__compound...uery__.”e”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression18
    PgClassExpression19{{"PgClassExpression[19∈2]<br />ᐸ__compound...uery__.”f”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression19
    PgClassExpression20{{"PgClassExpression[20∈2]<br />ᐸ__compound...uery__.”g”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression20
    __Item30[/"__Item[30∈4]<br />ᐸ28ᐳ"\]:::itemplan
    PgSelect28 ==> __Item30
    PgSelectSingle31{{"PgSelectSingle[31∈4]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item30 --> PgSelectSingle31
    PgClassExpression32{{"PgClassExpression[32∈5]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle31 --> PgClassExpression32
    __Item39[/"__Item[39∈6]<br />ᐸ37ᐳ"\]:::itemplan
    PgSelect37 ==> __Item39
    PgSelectSingle40{{"PgSelectSingle[40∈6]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item39 --> PgSelectSingle40
    PgClassExpression41{{"PgClassExpression[41∈7]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle40 --> PgClassExpression41
    __Item50[/"__Item[50∈8]<br />ᐸ48ᐳ"\]:::itemplan
    PgSelect48 ==> __Item50
    PgSelectSingle51{{"PgSelectSingle[51∈8]<br />ᐸint_set_queryᐳ"}}:::plan
    __Item50 --> PgSelectSingle51
    PgClassExpression52{{"PgClassExpression[52∈8]<br />ᐸ__int_set_query__.vᐳ"}}:::plan
    PgSelectSingle51 --> PgClassExpression52
    __Item57[/"__Item[57∈9]<br />ᐸ55ᐳ"\]:::itemplan
    PgSelect55 ==> __Item57
    PgSelectSingle58{{"PgSelectSingle[58∈9]<br />ᐸstatic_big_integerᐳ"}}:::plan
    __Item57 --> PgSelectSingle58
    PgClassExpression59{{"PgClassExpression[59∈9]<br />ᐸ__static_b...nteger__.vᐳ"}}:::plan
    PgSelectSingle58 --> PgClassExpression59
    __Item64[/"__Item[64∈10]<br />ᐸ62ᐳ"\]:::itemplan
    PgSelect62 ==> __Item64
    PgSelectSingle65{{"PgSelectSingle[65∈10]<br />ᐸquery_interval_setᐳ"}}:::plan
    __Item64 --> PgSelectSingle65
    PgClassExpression66{{"PgClassExpression[66∈10]<br />ᐸ__query_in...al_set__.vᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression66
    __Item79[/"__Item[79∈12]<br />ᐸ77ᐳ"\]:::itemplan
    PgSelect77 ==> __Item79
    PgSelectSingle80{{"PgSelectSingle[80∈12]<br />ᐸpostᐳ"}}:::plan
    __Item79 --> PgSelectSingle80
    PgClassExpression81{{"PgClassExpression[81∈12]<br />ᐸ__post__.”id”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression81
    Access150{{"Access[150∈12]<br />ᐸ79.1ᐳ"}}:::plan
    __Item79 --> Access150
    __Item89[/"__Item[89∈13]<br />ᐸ150ᐳ"\]:::itemplan
    Access150 ==> __Item89
    PgSelectSingle90{{"PgSelectSingle[90∈13]<br />ᐸpost_computed_interval_setᐳ"}}:::plan
    __Item89 --> PgSelectSingle90
    PgClassExpression91{{"PgClassExpression[91∈13]<br />ᐸ__post_com...al_set__.vᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression91

    %% define steps

    subgraph "Buckets for queries/v4/simple-procedure-query"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 9, 10, 47, 96, 160, 161, 162, 163, 164, 11, 101, 109, 117, 158<br />2: 8, 28, 37, 48, 55, 62, 77"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect8,Access9,Access10,Object11,PgSelect28,PgSelect37,Constant47,PgSelect48,PgSelect55,PgSelect62,PgSelect77,Constant96,Lambda101,Lambda109,Lambda117,Lambda158,Constant160,Constant161,Constant162,Constant163,Constant164 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ8ᐳ[12]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item12,PgSelectSingle13 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 13<br /><br />ROOT PgSelectSingle{1}ᐸcompound_type_set_queryᐳ[13]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression14,PgClassExpression15,PgClassExpression16,PgClassExpression17,PgClassExpression18,PgClassExpression19,PgClassExpression20 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 20<br /><br />ROOT PgClassExpression{2}ᐸ__compound...uery__.”g”ᐳ[20]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ28ᐳ[30]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item30,PgSelectSingle31 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 31<br /><br />ROOT PgSelectSingle{4}ᐸtable_set_queryᐳ[31]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression32 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ37ᐳ[39]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item39,PgSelectSingle40 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 40<br /><br />ROOT PgSelectSingle{6}ᐸtable_set_queryᐳ[40]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression41 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ48ᐳ[50]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item50,PgSelectSingle51,PgClassExpression52 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ55ᐳ[57]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item57,PgSelectSingle58,PgClassExpression59 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ62ᐳ[64]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item64,PgSelectSingle65,PgClassExpression66 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 66<br /><br />ROOT PgClassExpression{10}ᐸ__query_in...al_set__.vᐳ[66]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11 bucket11
    Bucket12("Bucket 12 (listItem)<br /><br />ROOT __Item{12}ᐸ77ᐳ[79]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,__Item79,PgSelectSingle80,PgClassExpression81,Access150 bucket12
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ150ᐳ[89]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item89,PgSelectSingle90,PgClassExpression91 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 91<br /><br />ROOT PgClassExpression{13}ᐸ__post_com...al_set__.vᐳ[91]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14
    Bucket0 --> Bucket1 & Bucket4 & Bucket6 & Bucket8 & Bucket9 & Bucket10 & Bucket12
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket4 --> Bucket5
    Bucket6 --> Bucket7
    Bucket10 --> Bucket11
    Bucket12 --> Bucket13
    Bucket13 --> Bucket14
    end
