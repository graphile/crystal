%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Connection15{{"Connection[15∈0] ➊<br />ᐸ11ᐳ"}}:::plan
    Constant188{{"Constant[188∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    Lambda16{{"Lambda[16∈0] ➊<br />ᐸparseCursorᐳ"}}:::plan
    PgValidateParsedCursor18["PgValidateParsedCursor[18∈0] ➊"]:::plan
    Constant188 & Lambda16 & PgValidateParsedCursor18 & PgValidateParsedCursor18 & PgValidateParsedCursor18 & PgValidateParsedCursor18 & PgValidateParsedCursor18 & PgValidateParsedCursor18 --> Connection15
    Connection73{{"Connection[73∈0] ➊<br />ᐸ71ᐳ"}}:::plan
    Lambda74{{"Lambda[74∈0] ➊<br />ᐸparseCursorᐳ"}}:::plan
    PgValidateParsedCursor76["PgValidateParsedCursor[76∈0] ➊"]:::plan
    Constant188 & Lambda74 & PgValidateParsedCursor76 & PgValidateParsedCursor76 & PgValidateParsedCursor76 & PgValidateParsedCursor76 & PgValidateParsedCursor76 & PgValidateParsedCursor76 --> Connection73
    Object135{{"Object[135∈0] ➊<br />ᐸ{reverse,orders,alias,codec}ᐳ"}}:::plan
    Lambda127{{"Lambda[127∈0] ➊<br />ᐸcalculateShouldReverseOrderᐳ"}}:::plan
    Constant132{{"Constant[132∈0] ➊<br />ᐸ[ { codec: Codec(int4), fragment: { n: [Array], f: 0, c: 266ᐳ"}}:::plan
    Constant133{{"Constant[133∈0] ➊<br />ᐸsql.identifier(”person”)ᐳ"}}:::plan
    Constant134{{"Constant[134∈0] ➊<br />ᐸRecordCodec(person)ᐳ"}}:::plan
    Lambda127 & Constant132 & Constant133 & Constant134 --> Object135
    Object151{{"Object[151∈0] ➊<br />ᐸ{reverse,orders,alias,codec}ᐳ"}}:::plan
    Lambda144{{"Lambda[144∈0] ➊<br />ᐸcalculateShouldReverseOrderᐳ"}}:::plan
    Constant148{{"Constant[148∈0] ➊<br />ᐸ[]ᐳ"}}:::plan
    Lambda144 & Constant148 & Constant133 & Constant134 --> Object151
    Object166{{"Object[166∈0] ➊<br />ᐸ{reverse,orders,alias,codec}ᐳ"}}:::plan
    Constant163{{"Constant[163∈0] ➊<br />ᐸ[ { codec: Codec(int4), fragment: { n: [Array], f: 0, c: 266ᐳ"}}:::plan
    Lambda127 & Constant163 & Constant133 & Constant134 --> Object166
    Object181{{"Object[181∈0] ➊<br />ᐸ{reverse,orders,alias,codec}ᐳ"}}:::plan
    Constant178{{"Constant[178∈0] ➊<br />ᐸ[]ᐳ"}}:::plan
    Lambda144 & Constant178 & Constant133 & Constant134 --> Object181
    Object14{{"Object[14∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access12 & Access13 --> Object14
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access12
    __Value2 --> Access13
    Constant189{{"Constant[189∈0] ➊<br />ᐸ''ᐳ"}}:::plan
    Constant189 --> Lambda16
    Lambda16 --> PgValidateParsedCursor18
    Access19{{"Access[19∈0] ➊<br />ᐸ16.1ᐳ"}}:::plan
    Lambda16 --> Access19
    Constant190{{"Constant[190∈0] ➊<br />ᐸ'27'ᐳ"}}:::plan
    Constant190 --> Lambda74
    Lambda74 --> PgValidateParsedCursor76
    Access77{{"Access[77∈0] ➊<br />ᐸ74.1ᐳ"}}:::plan
    Lambda74 --> Access77
    Constant197{{"Constant[197∈0] ➊<br />ᐸ§{ first: 2, last: null, cursorLower: null, cursorUpper: nulᐳ"}}:::plan
    Constant197 --> Lambda127
    Lambda130{{"Lambda[130∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Constant198{{"Constant[198∈0] ➊<br />ᐸ§{ first: 2, last: null, cursorLower: null, cursorUpper: nulᐳ"}}:::plan
    Constant198 --> Lambda130
    Access131{{"Access[131∈0] ➊<br />ᐸ130.0ᐳ"}}:::plan
    Lambda130 --> Access131
    Lambda136{{"Lambda[136∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Object135 --> Lambda136
    Lambda142{{"Lambda[142∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Constant193{{"Constant[193∈0] ➊<br />ᐸ§{ reverse: false, orders: [ { codec: Codec(int4), fragment:ᐳ"}}:::plan
    Constant193 --> Lambda142
    Constant191{{"Constant[191∈0] ➊<br />ᐸ§{ first: null, last: null, cursorLower: null, cursorUpper: ᐳ"}}:::plan
    Constant191 --> Lambda144
    Lambda146{{"Lambda[146∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Constant192{{"Constant[192∈0] ➊<br />ᐸ§{ first: null, last: null, cursorLower: null, cursorUpper: ᐳ"}}:::plan
    Constant192 --> Lambda146
    Access147{{"Access[147∈0] ➊<br />ᐸ146.0ᐳ"}}:::plan
    Lambda146 --> Access147
    Lambda152{{"Lambda[152∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Object151 --> Lambda152
    Lambda157{{"Lambda[157∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Constant194{{"Constant[194∈0] ➊<br />ᐸ§{ reverse: false, orders: [], alias: sql.identifier(”personᐳ"}}:::plan
    Constant194 --> Lambda157
    Lambda167{{"Lambda[167∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Object166 --> Lambda167
    Lambda172{{"Lambda[172∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Constant195{{"Constant[195∈0] ➊<br />ᐸ§{ reverse: false, orders: [ { codec: Codec(int4), fragment:ᐳ"}}:::plan
    Constant195 --> Lambda172
    Lambda182{{"Lambda[182∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Object181 --> Lambda182
    Lambda187{{"Lambda[187∈0] ➊<br />ᐸcalculateOrderBySQLᐳ"}}:::plan
    Constant196{{"Constant[196∈0] ➊<br />ᐸ§{ reverse: false, orders: [], alias: sql.identifier(”personᐳ"}}:::plan
    Constant196 --> Lambda187
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant7{{"Constant[7∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    Constant28{{"Constant[28∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    PgSelect17[["PgSelect[17∈1] ➊<br />ᐸperson+1ᐳ"]]:::plan
    Object14 & Connection15 & Lambda16 & Constant188 & Access19 & Lambda127 & Access131 & Lambda136 & Lambda142 --> PgSelect17
    PgSelect49[["PgSelect[49∈1] ➊<br />ᐸperson(aggregate)ᐳ"]]:::plan
    Object14 & Connection15 & Lambda144 & Access147 & Lambda152 & Lambda157 --> PgSelect49
    Object46{{"Object[46∈1] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access40{{"Access[40∈1] ➊<br />ᐸ17.hasMoreᐳ"}}:::plan
    Constant188 & Constant7 & Constant7 & Access40 --> Object46
    Object41{{"Object[41∈1] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Constant188 & Constant7 & Access40 --> Object41
    List29{{"List[29∈1] ➊<br />ᐸ28,27ᐳ"}}:::plan
    List27{{"List[27∈1] ➊<br />ᐸ26ᐳ"}}:::plan
    Constant28 & List27 --> List29
    List37{{"List[37∈1] ➊<br />ᐸ28,36ᐳ"}}:::plan
    List36{{"List[36∈1] ➊<br />ᐸ35ᐳ"}}:::plan
    Constant28 & List36 --> List37
    PgPageInfo20{{"PgPageInfo[20∈1] ➊"}}:::plan
    Connection15 --> PgPageInfo20
    First22{{"First[22∈1] ➊"}}:::plan
    PgSelect17 --> First22
    PgSelectSingle23{{"PgSelectSingle[23∈1] ➊<br />ᐸpersonᐳ"}}:::plan
    First22 --> PgSelectSingle23
    PgCursor24{{"PgCursor[24∈1] ➊"}}:::plan
    List29 --> PgCursor24
    PgClassExpression26{{"PgClassExpression[26∈1] ➊<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression26
    PgClassExpression26 --> List27
    Last31{{"Last[31∈1] ➊"}}:::plan
    PgSelect17 --> Last31
    PgSelectSingle32{{"PgSelectSingle[32∈1] ➊<br />ᐸpersonᐳ"}}:::plan
    Last31 --> PgSelectSingle32
    PgCursor33{{"PgCursor[33∈1] ➊"}}:::plan
    List37 --> PgCursor33
    PgClassExpression35{{"PgClassExpression[35∈1] ➊<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle32 --> PgClassExpression35
    PgClassExpression35 --> List36
    PgSelect17 --> Access40
    Lambda42{{"Lambda[42∈1] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object41 --> Lambda42
    Lambda47{{"Lambda[47∈1] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object46 --> Lambda47
    First50{{"First[50∈1] ➊"}}:::plan
    PgSelect49 --> First50
    PgSelectSingle51{{"PgSelectSingle[51∈1] ➊<br />ᐸpersonᐳ"}}:::plan
    First50 --> PgSelectSingle51
    PgClassExpression52{{"PgClassExpression[52∈1] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle51 --> PgClassExpression52
    __Item55[/"__Item[55∈2]<br />ᐸ17ᐳ"\]:::itemplan
    PgSelect17 ==> __Item55
    PgSelectSingle56{{"PgSelectSingle[56∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item55 --> PgSelectSingle56
    List61{{"List[61∈3]<br />ᐸ28,59ᐳ"}}:::plan
    List59{{"List[59∈3]<br />ᐸ58ᐳ"}}:::plan
    Constant28 & List59 --> List61
    PgCursor57{{"PgCursor[57∈3]"}}:::plan
    List61 --> PgCursor57
    PgClassExpression58{{"PgClassExpression[58∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression58
    PgClassExpression58 --> List59
    PgClassExpression63{{"PgClassExpression[63∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression63
    PgClassExpression64{{"PgClassExpression[64∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression64
    PgClassExpression65{{"PgClassExpression[65∈3]<br />ᐸ__person__.”config”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression65
    PgClassExpression66{{"PgClassExpression[66∈3]<br />ᐸ__person__...n_from_ip”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression66
    PgSelect75[["PgSelect[75∈4] ➊<br />ᐸperson+1ᐳ"]]:::plan
    Object14 & Connection73 & Lambda74 & Constant188 & Access77 & Lambda127 & Access131 & Lambda167 & Lambda172 --> PgSelect75
    PgSelect107[["PgSelect[107∈4] ➊<br />ᐸperson(aggregate)ᐳ"]]:::plan
    Object14 & Connection73 & Lambda144 & Access147 & Lambda182 & Lambda187 --> PgSelect107
    Object104{{"Object[104∈4] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access98{{"Access[98∈4] ➊<br />ᐸ75.hasMoreᐳ"}}:::plan
    Constant188 & Constant7 & Constant7 & Access98 --> Object104
    Object99{{"Object[99∈4] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Constant188 & Constant7 & Access98 --> Object99
    List87{{"List[87∈4] ➊<br />ᐸ28,85ᐳ"}}:::plan
    List85{{"List[85∈4] ➊<br />ᐸ84ᐳ"}}:::plan
    Constant28 & List85 --> List87
    List95{{"List[95∈4] ➊<br />ᐸ28,94ᐳ"}}:::plan
    List94{{"List[94∈4] ➊<br />ᐸ93ᐳ"}}:::plan
    Constant28 & List94 --> List95
    PgPageInfo78{{"PgPageInfo[78∈4] ➊"}}:::plan
    Connection73 --> PgPageInfo78
    First80{{"First[80∈4] ➊"}}:::plan
    PgSelect75 --> First80
    PgSelectSingle81{{"PgSelectSingle[81∈4] ➊<br />ᐸpersonᐳ"}}:::plan
    First80 --> PgSelectSingle81
    PgCursor82{{"PgCursor[82∈4] ➊"}}:::plan
    List87 --> PgCursor82
    PgClassExpression84{{"PgClassExpression[84∈4] ➊<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression84
    PgClassExpression84 --> List85
    Last89{{"Last[89∈4] ➊"}}:::plan
    PgSelect75 --> Last89
    PgSelectSingle90{{"PgSelectSingle[90∈4] ➊<br />ᐸpersonᐳ"}}:::plan
    Last89 --> PgSelectSingle90
    PgCursor91{{"PgCursor[91∈4] ➊"}}:::plan
    List95 --> PgCursor91
    PgClassExpression93{{"PgClassExpression[93∈4] ➊<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression93
    PgClassExpression93 --> List94
    PgSelect75 --> Access98
    Lambda100{{"Lambda[100∈4] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object99 --> Lambda100
    Lambda105{{"Lambda[105∈4] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object104 --> Lambda105
    First108{{"First[108∈4] ➊"}}:::plan
    PgSelect107 --> First108
    PgSelectSingle109{{"PgSelectSingle[109∈4] ➊<br />ᐸpersonᐳ"}}:::plan
    First108 --> PgSelectSingle109
    PgClassExpression110{{"PgClassExpression[110∈4] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle109 --> PgClassExpression110
    __Item113[/"__Item[113∈5]<br />ᐸ75ᐳ"\]:::itemplan
    PgSelect75 ==> __Item113
    PgSelectSingle114{{"PgSelectSingle[114∈5]<br />ᐸpersonᐳ"}}:::plan
    __Item113 --> PgSelectSingle114
    List119{{"List[119∈6]<br />ᐸ28,117ᐳ"}}:::plan
    List117{{"List[117∈6]<br />ᐸ116ᐳ"}}:::plan
    Constant28 & List117 --> List119
    PgCursor115{{"PgCursor[115∈6]"}}:::plan
    List119 --> PgCursor115
    PgClassExpression116{{"PgClassExpression[116∈6]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression116
    PgClassExpression116 --> List117
    PgClassExpression121{{"PgClassExpression[121∈6]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression121
    PgClassExpression122{{"PgClassExpression[122∈6]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression122
    PgClassExpression123{{"PgClassExpression[123∈6]<br />ᐸ__person__.”config”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression123
    PgClassExpression124{{"PgClassExpression[124∈6]<br />ᐸ__person__...n_from_ip”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression124

    %% define steps

    subgraph "Buckets for queries/v4/connections-blankcursor"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 7, 12, 13, 28, 132, 133, 134, 148, 163, 178, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 14, 16, 19, 74, 77, 127, 130, 131, 135, 136, 142, 144, 146, 147, 151, 152, 157, 166, 167, 172, 181, 182, 187<br />2: 18, 76<br />ᐳ: Connection[15], Connection[73]"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant7,Access12,Access13,Object14,Connection15,Lambda16,PgValidateParsedCursor18,Access19,Constant28,Connection73,Lambda74,PgValidateParsedCursor76,Access77,Lambda127,Lambda130,Access131,Constant132,Constant133,Constant134,Object135,Lambda136,Lambda142,Lambda144,Lambda146,Access147,Constant148,Object151,Lambda152,Lambda157,Constant163,Object166,Lambda167,Lambda172,Constant178,Object181,Lambda182,Lambda187,Constant188,Constant189,Constant190,Constant191,Constant192,Constant193,Constant194,Constant195,Constant196,Constant197,Constant198 bucket0
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 14, 15, 16, 188, 19, 127, 131, 136, 142, 28, 7, 144, 147, 152, 157<br /><br />ROOT Connectionᐸ11ᐳ[15]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect17,PgPageInfo20,First22,PgSelectSingle23,PgCursor24,PgClassExpression26,List27,List29,Last31,PgSelectSingle32,PgCursor33,PgClassExpression35,List36,List37,Access40,Object41,Lambda42,Object46,Lambda47,PgSelect49,First50,PgSelectSingle51,PgClassExpression52 bucket1
    Bucket2("Bucket 2 (listItem)<br />Deps: 28<br /><br />ROOT __Item{2}ᐸ17ᐳ[55]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item55,PgSelectSingle56 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 56, 28<br /><br />ROOT PgSelectSingle{2}ᐸpersonᐳ[56]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgCursor57,PgClassExpression58,List59,List61,PgClassExpression63,PgClassExpression64,PgClassExpression65,PgClassExpression66 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 14, 73, 74, 188, 77, 127, 131, 167, 172, 28, 7, 144, 147, 182, 187<br /><br />ROOT Connectionᐸ71ᐳ[73]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect75,PgPageInfo78,First80,PgSelectSingle81,PgCursor82,PgClassExpression84,List85,List87,Last89,PgSelectSingle90,PgCursor91,PgClassExpression93,List94,List95,Access98,Object99,Lambda100,Object104,Lambda105,PgSelect107,First108,PgSelectSingle109,PgClassExpression110 bucket4
    Bucket5("Bucket 5 (listItem)<br />Deps: 28<br /><br />ROOT __Item{5}ᐸ75ᐳ[113]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item113,PgSelectSingle114 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 114, 28<br /><br />ROOT PgSelectSingle{5}ᐸpersonᐳ[114]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgCursor115,PgClassExpression116,List117,List119,PgClassExpression121,PgClassExpression122,PgClassExpression123,PgClassExpression124 bucket6
    Bucket0 --> Bucket1 & Bucket4
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket4 --> Bucket5
    Bucket5 --> Bucket6
    end
