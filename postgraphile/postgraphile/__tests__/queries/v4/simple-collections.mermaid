%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 9, 45, 117, 118, 119, 120, 10, 22, 26, 28, 32, 44, 48<br />2: 7, 12, 15, 19, 24, 30, 35, 38, 41, 46, 51<br />3: 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64"):::bucket
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ54ᐳ[65]"):::bucket
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ55ᐳ[67]"):::bucket
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ56ᐳ[69]"):::bucket
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ57ᐳ[71]"):::bucket
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ58ᐳ[73]"):::bucket
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ59ᐳ[75]"):::bucket
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ60ᐳ[77]"):::bucket
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ61ᐳ[79]"):::bucket
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ62ᐳ[81]"):::bucket
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ63ᐳ[83]"):::bucket
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ64ᐳ[85]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11

    %% plan dependencies
    PgSelect30[["PgSelect[30∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant117{{"Constant[117∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput32{{"ApplyInput[32∈0] ➊"}}:::plan
    Object10 & Constant117 & ApplyInput32 --> PgSelect30
    PgSelect35[["PgSelect[35∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant118{{"Constant[118∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    Constant119{{"Constant[119∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object10 & Constant118 & Constant119 --> PgSelect35
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    PgSelect12[["PgSelect[12∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Constant117 --> PgSelect12
    __InputObject22{{"__InputObject[22∈0] ➊"}}:::plan
    Constant117 --> __InputObject22
    PgSelect24[["PgSelect[24∈0] ➊<br />ᐸpostᐳ"]]:::plan
    ApplyInput26{{"ApplyInput[26∈0] ➊"}}:::plan
    Object10 & ApplyInput26 --> PgSelect24
    __InputObject28{{"__InputObject[28∈0] ➊"}}:::plan
    Constant117 --> __InputObject28
    PgSelect38[["PgSelect[38∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant120{{"Constant[120∈0] ➊<br />ᐸ0ᐳ"}}:::plan
    Object10 & Constant120 --> PgSelect38
    __InputObject44{{"__InputObject[44∈0] ➊"}}:::plan
    Constant45{{"Constant[45∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant45 --> __InputObject44
    PgSelect46[["PgSelect[46∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput48{{"ApplyInput[48∈0] ➊"}}:::plan
    Object10 & ApplyInput48 --> PgSelect46
    PgSelect51[["PgSelect[51∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object10 & Constant118 --> PgSelect51
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect7
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    PgSelect15[["PgSelect[15∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect15
    PgSelect19[["PgSelect[19∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect19
    __InputObject22 --> ApplyInput26
    __InputObject28 --> ApplyInput32
    PgSelect41[["PgSelect[41∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect41
    __InputObject44 --> ApplyInput48
    PgSelectRows54[["PgSelectRows[54∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows54
    PgSelectRows55[["PgSelectRows[55∈0] ➊"]]:::plan
    PgSelect12 --> PgSelectRows55
    PgSelectRows56[["PgSelectRows[56∈0] ➊"]]:::plan
    PgSelect15 --> PgSelectRows56
    PgSelectRows57[["PgSelectRows[57∈0] ➊"]]:::plan
    PgSelect19 --> PgSelectRows57
    PgSelectRows58[["PgSelectRows[58∈0] ➊"]]:::plan
    PgSelect24 --> PgSelectRows58
    PgSelectRows59[["PgSelectRows[59∈0] ➊"]]:::plan
    PgSelect30 --> PgSelectRows59
    PgSelectRows60[["PgSelectRows[60∈0] ➊"]]:::plan
    PgSelect35 --> PgSelectRows60
    PgSelectRows61[["PgSelectRows[61∈0] ➊"]]:::plan
    PgSelect38 --> PgSelectRows61
    PgSelectRows62[["PgSelectRows[62∈0] ➊"]]:::plan
    PgSelect41 --> PgSelectRows62
    PgSelectRows63[["PgSelectRows[63∈0] ➊"]]:::plan
    PgSelect46 --> PgSelectRows63
    PgSelectRows64[["PgSelectRows[64∈0] ➊"]]:::plan
    PgSelect51 --> PgSelectRows64
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item65[/"__Item[65∈1]<br />ᐸ54ᐳ"\]:::itemplan
    PgSelectRows54 ==> __Item65
    PgSelectSingle66{{"PgSelectSingle[66∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item65 --> PgSelectSingle66
    PgClassExpression87{{"PgClassExpression[87∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression87
    PgClassExpression98{{"PgClassExpression[98∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression98
    PgClassExpression109{{"PgClassExpression[109∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression109
    __Item67[/"__Item[67∈2]<br />ᐸ55ᐳ"\]:::itemplan
    PgSelectRows55 ==> __Item67
    PgSelectSingle68{{"PgSelectSingle[68∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item67 --> PgSelectSingle68
    PgClassExpression88{{"PgClassExpression[88∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression88
    PgClassExpression99{{"PgClassExpression[99∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression99
    PgClassExpression110{{"PgClassExpression[110∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression110
    __Item69[/"__Item[69∈3]<br />ᐸ56ᐳ"\]:::itemplan
    PgSelectRows56 ==> __Item69
    PgSelectSingle70{{"PgSelectSingle[70∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item69 --> PgSelectSingle70
    PgClassExpression89{{"PgClassExpression[89∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle70 --> PgClassExpression89
    PgClassExpression100{{"PgClassExpression[100∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle70 --> PgClassExpression100
    PgClassExpression111{{"PgClassExpression[111∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle70 --> PgClassExpression111
    __Item71[/"__Item[71∈4]<br />ᐸ57ᐳ"\]:::itemplan
    PgSelectRows57 ==> __Item71
    PgSelectSingle72{{"PgSelectSingle[72∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item71 --> PgSelectSingle72
    PgClassExpression90{{"PgClassExpression[90∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle72 --> PgClassExpression90
    PgClassExpression101{{"PgClassExpression[101∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle72 --> PgClassExpression101
    PgClassExpression112{{"PgClassExpression[112∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle72 --> PgClassExpression112
    __Item73[/"__Item[73∈5]<br />ᐸ58ᐳ"\]:::itemplan
    PgSelectRows58 ==> __Item73
    PgSelectSingle74{{"PgSelectSingle[74∈5]<br />ᐸpostᐳ"}}:::plan
    __Item73 --> PgSelectSingle74
    PgClassExpression91{{"PgClassExpression[91∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression91
    PgClassExpression102{{"PgClassExpression[102∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression102
    __Item75[/"__Item[75∈6]<br />ᐸ59ᐳ"\]:::itemplan
    PgSelectRows59 ==> __Item75
    PgSelectSingle76{{"PgSelectSingle[76∈6]<br />ᐸpostᐳ"}}:::plan
    __Item75 --> PgSelectSingle76
    PgClassExpression92{{"PgClassExpression[92∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle76 --> PgClassExpression92
    PgClassExpression103{{"PgClassExpression[103∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle76 --> PgClassExpression103
    __Item77[/"__Item[77∈7]<br />ᐸ60ᐳ"\]:::itemplan
    PgSelectRows60 ==> __Item77
    PgSelectSingle78{{"PgSelectSingle[78∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item77 --> PgSelectSingle78
    PgClassExpression93{{"PgClassExpression[93∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression93
    PgClassExpression104{{"PgClassExpression[104∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression104
    PgClassExpression113{{"PgClassExpression[113∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression113
    __Item79[/"__Item[79∈8]<br />ᐸ61ᐳ"\]:::itemplan
    PgSelectRows61 ==> __Item79
    PgSelectSingle80{{"PgSelectSingle[80∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item79 --> PgSelectSingle80
    PgClassExpression94{{"PgClassExpression[94∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression94
    PgClassExpression105{{"PgClassExpression[105∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression105
    PgClassExpression114{{"PgClassExpression[114∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression114
    __Item81[/"__Item[81∈9]<br />ᐸ62ᐳ"\]:::itemplan
    PgSelectRows62 ==> __Item81
    PgSelectSingle82{{"PgSelectSingle[82∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item81 --> PgSelectSingle82
    PgClassExpression95{{"PgClassExpression[95∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle82 --> PgClassExpression95
    PgClassExpression106{{"PgClassExpression[106∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle82 --> PgClassExpression106
    PgClassExpression115{{"PgClassExpression[115∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle82 --> PgClassExpression115
    __Item83[/"__Item[83∈10]<br />ᐸ63ᐳ"\]:::itemplan
    PgSelectRows63 ==> __Item83
    PgSelectSingle84{{"PgSelectSingle[84∈10]<br />ᐸpersonᐳ"}}:::plan
    __Item83 --> PgSelectSingle84
    PgClassExpression96{{"PgClassExpression[96∈10]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression96
    PgClassExpression107{{"PgClassExpression[107∈10]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression107
    PgClassExpression116{{"PgClassExpression[116∈10]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression116
    __Item85[/"__Item[85∈11]<br />ᐸ64ᐳ"\]:::itemplan
    PgSelectRows64 ==> __Item85
    PgSelectSingle86{{"PgSelectSingle[86∈11]<br />ᐸpostᐳ"}}:::plan
    __Item85 --> PgSelectSingle86
    PgClassExpression97{{"PgClassExpression[97∈11]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression97
    PgClassExpression108{{"PgClassExpression[108∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression108

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect7,Access8,Access9,Object10,PgSelect12,PgSelect15,PgSelect19,__InputObject22,PgSelect24,ApplyInput26,__InputObject28,PgSelect30,ApplyInput32,PgSelect35,PgSelect38,PgSelect41,__InputObject44,Constant45,PgSelect46,ApplyInput48,PgSelect51,PgSelectRows54,PgSelectRows55,PgSelectRows56,PgSelectRows57,PgSelectRows58,PgSelectRows59,PgSelectRows60,PgSelectRows61,PgSelectRows62,PgSelectRows63,PgSelectRows64,Constant117,Constant118,Constant119,Constant120 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item65,PgSelectSingle66,PgClassExpression87,PgClassExpression98,PgClassExpression109 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item67,PgSelectSingle68,PgClassExpression88,PgClassExpression99,PgClassExpression110 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item69,PgSelectSingle70,PgClassExpression89,PgClassExpression100,PgClassExpression111 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item71,PgSelectSingle72,PgClassExpression90,PgClassExpression101,PgClassExpression112 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item73,PgSelectSingle74,PgClassExpression91,PgClassExpression102 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item75,PgSelectSingle76,PgClassExpression92,PgClassExpression103 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item77,PgSelectSingle78,PgClassExpression93,PgClassExpression104,PgClassExpression113 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item79,PgSelectSingle80,PgClassExpression94,PgClassExpression105,PgClassExpression114 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item81,PgSelectSingle82,PgClassExpression95,PgClassExpression106,PgClassExpression115 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item83,PgSelectSingle84,PgClassExpression96,PgClassExpression107,PgClassExpression116 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item85,PgSelectSingle86,PgClassExpression97,PgClassExpression108 bucket11

