%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect52[["PgSelect[52∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Lambda54{{"Lambda[54∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Constant6{{"Constant[6∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    ApplyInput55{{"ApplyInput[55∈0] ➊"}}:::plan
    Object10 & Lambda54 & Constant6 & Constant6 & ApplyInput55 --> PgSelect52
    PgSelect64[["PgSelect[64∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Constant129{{"Constant[129∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput67{{"ApplyInput[67∈0] ➊"}}:::plan
    Object10 & Lambda54 & Constant129 & Constant6 & ApplyInput67 --> PgSelect64
    PgSelect107[["PgSelect[107∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda11{{"Lambda[11∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    ApplyInput110{{"ApplyInput[110∈0] ➊"}}:::plan
    Object10 & Lambda11 & Constant6 & Constant6 & ApplyInput110 --> PgSelect107
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Lambda11 & Constant6 & Constant6 --> PgSelect7
    PgSelect19[["PgSelect[19∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Lambda11 & Constant129 & Constant6 --> PgSelect19
    PgSelect30[["PgSelect[30∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda32{{"Lambda[32∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Object10 & Lambda32 & Constant6 & Constant6 --> PgSelect30
    PgSelect41[["PgSelect[41∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda43{{"Lambda[43∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Object10 & Lambda43 & Constant6 & Constant6 --> PgSelect41
    PgSelect75[["PgSelect[75∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant134{{"Constant[134∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    Constant135{{"Constant[135∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object10 & Lambda11 & Constant134 & Constant135 --> PgSelect75
    PgSelect85[["PgSelect[85∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant136{{"Constant[136∈0] ➊<br />ᐸ0ᐳ"}}:::plan
    Object10 & Lambda11 & Constant136 & Constant6 --> PgSelect85
    PgSelect96[["PgSelect[96∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda98{{"Lambda[98∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Object10 & Lambda98 & Constant6 & Constant6 --> PgSelect96
    PgSelect121[["PgSelect[121∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda123{{"Lambda[123∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Object10 & Lambda123 & Constant134 & Constant6 --> PgSelect121
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    __InputObject50{{"__InputObject[50∈0] ➊"}}:::plan
    Constant6 & Constant129 --> __InputObject50
    __InputObject62{{"__InputObject[62∈0] ➊"}}:::plan
    Constant6 & Constant129 --> __InputObject62
    __InputObject105{{"__InputObject[105∈0] ➊"}}:::plan
    Constant139{{"Constant[139∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant6 & Constant139 --> __InputObject105
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    Constant6 --> Lambda11
    PgSelectRows12[["PgSelectRows[12∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows12
    PgSelectRows22[["PgSelectRows[22∈0] ➊"]]:::plan
    PgSelect19 --> PgSelectRows22
    Constant143{{"Constant[143∈0] ➊<br />ᐸ[ 'NAME_ASC' ]ᐳ"}}:::plan
    Constant143 --> Lambda32
    PgSelectRows33[["PgSelectRows[33∈0] ➊"]]:::plan
    PgSelect30 --> PgSelectRows33
    Constant144{{"Constant[144∈0] ➊<br />ᐸ[ 'NAME_DESC' ]ᐳ"}}:::plan
    Constant144 --> Lambda43
    PgSelectRows44[["PgSelectRows[44∈0] ➊"]]:::plan
    PgSelect41 --> PgSelectRows44
    Constant6 --> Lambda54
    __InputObject50 --> ApplyInput55
    PgSelectRows56[["PgSelectRows[56∈0] ➊"]]:::plan
    PgSelect52 --> PgSelectRows56
    __InputObject62 --> ApplyInput67
    PgSelectRows68[["PgSelectRows[68∈0] ➊"]]:::plan
    PgSelect64 --> PgSelectRows68
    PgSelectRows78[["PgSelectRows[78∈0] ➊"]]:::plan
    PgSelect75 --> PgSelectRows78
    PgSelectRows88[["PgSelectRows[88∈0] ➊"]]:::plan
    PgSelect85 --> PgSelectRows88
    Constant145{{"Constant[145∈0] ➊<br />ᐸ[ 'PRIMARY_KEY_ASC' ]ᐳ"}}:::plan
    Constant145 --> Lambda98
    PgSelectRows99[["PgSelectRows[99∈0] ➊"]]:::plan
    PgSelect96 --> PgSelectRows99
    __InputObject105 --> ApplyInput110
    PgSelectRows111[["PgSelectRows[111∈0] ➊"]]:::plan
    PgSelect107 --> PgSelectRows111
    Constant146{{"Constant[146∈0] ➊<br />ᐸ[ 'AUTHOR_ID_DESC', 'HEADLINE_DESC' ]ᐳ"}}:::plan
    Constant146 --> Lambda123
    PgSelectRows124[["PgSelectRows[124∈0] ➊"]]:::plan
    PgSelect121 --> PgSelectRows124
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item13[/"__Item[13∈1]<br />ᐸ12ᐳ"\]:::itemplan
    PgSelectRows12 ==> __Item13
    PgSelectSingle14{{"PgSelectSingle[14∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item13 --> PgSelectSingle14
    PgClassExpression15{{"PgClassExpression[15∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression15
    PgClassExpression16{{"PgClassExpression[16∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle14 --> PgClassExpression17
    __Item23[/"__Item[23∈2]<br />ᐸ22ᐳ"\]:::itemplan
    PgSelectRows22 ==> __Item23
    PgSelectSingle24{{"PgSelectSingle[24∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item23 --> PgSelectSingle24
    PgClassExpression25{{"PgClassExpression[25∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle24 --> PgClassExpression25
    PgClassExpression26{{"PgClassExpression[26∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle24 --> PgClassExpression26
    PgClassExpression27{{"PgClassExpression[27∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle24 --> PgClassExpression27
    __Item34[/"__Item[34∈3]<br />ᐸ33ᐳ"\]:::itemplan
    PgSelectRows33 ==> __Item34
    PgSelectSingle35{{"PgSelectSingle[35∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item34 --> PgSelectSingle35
    PgClassExpression36{{"PgClassExpression[36∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle35 --> PgClassExpression36
    PgClassExpression37{{"PgClassExpression[37∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle35 --> PgClassExpression37
    PgClassExpression38{{"PgClassExpression[38∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle35 --> PgClassExpression38
    __Item45[/"__Item[45∈4]<br />ᐸ44ᐳ"\]:::itemplan
    PgSelectRows44 ==> __Item45
    PgSelectSingle46{{"PgSelectSingle[46∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item45 --> PgSelectSingle46
    PgClassExpression47{{"PgClassExpression[47∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle46 --> PgClassExpression47
    PgClassExpression48{{"PgClassExpression[48∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle46 --> PgClassExpression48
    PgClassExpression49{{"PgClassExpression[49∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle46 --> PgClassExpression49
    __Item57[/"__Item[57∈5]<br />ᐸ56ᐳ"\]:::itemplan
    PgSelectRows56 ==> __Item57
    PgSelectSingle58{{"PgSelectSingle[58∈5]<br />ᐸpostᐳ"}}:::plan
    __Item57 --> PgSelectSingle58
    PgClassExpression59{{"PgClassExpression[59∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle58 --> PgClassExpression59
    PgClassExpression60{{"PgClassExpression[60∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle58 --> PgClassExpression60
    __Item69[/"__Item[69∈6]<br />ᐸ68ᐳ"\]:::itemplan
    PgSelectRows68 ==> __Item69
    PgSelectSingle70{{"PgSelectSingle[70∈6]<br />ᐸpostᐳ"}}:::plan
    __Item69 --> PgSelectSingle70
    PgClassExpression71{{"PgClassExpression[71∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle70 --> PgClassExpression71
    PgClassExpression72{{"PgClassExpression[72∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle70 --> PgClassExpression72
    __Item79[/"__Item[79∈7]<br />ᐸ78ᐳ"\]:::itemplan
    PgSelectRows78 ==> __Item79
    PgSelectSingle80{{"PgSelectSingle[80∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item79 --> PgSelectSingle80
    PgClassExpression81{{"PgClassExpression[81∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression81
    PgClassExpression82{{"PgClassExpression[82∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression82
    PgClassExpression83{{"PgClassExpression[83∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression83
    __Item89[/"__Item[89∈8]<br />ᐸ88ᐳ"\]:::itemplan
    PgSelectRows88 ==> __Item89
    PgSelectSingle90{{"PgSelectSingle[90∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item89 --> PgSelectSingle90
    PgClassExpression91{{"PgClassExpression[91∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression91
    PgClassExpression92{{"PgClassExpression[92∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression92
    PgClassExpression93{{"PgClassExpression[93∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression93
    __Item100[/"__Item[100∈9]<br />ᐸ99ᐳ"\]:::itemplan
    PgSelectRows99 ==> __Item100
    PgSelectSingle101{{"PgSelectSingle[101∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item100 --> PgSelectSingle101
    PgClassExpression102{{"PgClassExpression[102∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression102
    PgClassExpression103{{"PgClassExpression[103∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression103
    PgClassExpression104{{"PgClassExpression[104∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression104
    __Item112[/"__Item[112∈10]<br />ᐸ111ᐳ"\]:::itemplan
    PgSelectRows111 ==> __Item112
    PgSelectSingle113{{"PgSelectSingle[113∈10]<br />ᐸpersonᐳ"}}:::plan
    __Item112 --> PgSelectSingle113
    PgClassExpression114{{"PgClassExpression[114∈10]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle113 --> PgClassExpression114
    PgClassExpression115{{"PgClassExpression[115∈10]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle113 --> PgClassExpression115
    PgClassExpression116{{"PgClassExpression[116∈10]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle113 --> PgClassExpression116
    __Item125[/"__Item[125∈11]<br />ᐸ124ᐳ"\]:::itemplan
    PgSelectRows124 ==> __Item125
    PgSelectSingle126{{"PgSelectSingle[126∈11]<br />ᐸpostᐳ"}}:::plan
    __Item125 --> PgSelectSingle126
    PgClassExpression127{{"PgClassExpression[127∈11]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle126 --> PgClassExpression127
    PgClassExpression128{{"PgClassExpression[128∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle126 --> PgClassExpression128

    %% define steps

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 9, 129, 134, 135, 136, 139, 143, 144, 145, 146, 10, 11, 32, 43, 50, 54, 55, 62, 67, 98, 105, 110, 123<br />2: 7, 19, 30, 41, 52, 64, 75, 85, 96, 107, 121<br />3: 12, 22, 33, 44, 56, 68, 78, 88, 99, 111, 124"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant6,PgSelect7,Access8,Access9,Object10,Lambda11,PgSelectRows12,PgSelect19,PgSelectRows22,PgSelect30,Lambda32,PgSelectRows33,PgSelect41,Lambda43,PgSelectRows44,__InputObject50,PgSelect52,Lambda54,ApplyInput55,PgSelectRows56,__InputObject62,PgSelect64,ApplyInput67,PgSelectRows68,PgSelect75,PgSelectRows78,PgSelect85,PgSelectRows88,PgSelect96,Lambda98,PgSelectRows99,__InputObject105,PgSelect107,ApplyInput110,PgSelectRows111,PgSelect121,Lambda123,PgSelectRows124,Constant129,Constant134,Constant135,Constant136,Constant139,Constant143,Constant144,Constant145,Constant146 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ12ᐳ[13]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item13,PgSelectSingle14,PgClassExpression15,PgClassExpression16,PgClassExpression17 bucket1
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ22ᐳ[23]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item23,PgSelectSingle24,PgClassExpression25,PgClassExpression26,PgClassExpression27 bucket2
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ33ᐳ[34]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item34,PgSelectSingle35,PgClassExpression36,PgClassExpression37,PgClassExpression38 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ44ᐳ[45]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item45,PgSelectSingle46,PgClassExpression47,PgClassExpression48,PgClassExpression49 bucket4
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ56ᐳ[57]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item57,PgSelectSingle58,PgClassExpression59,PgClassExpression60 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ68ᐳ[69]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item69,PgSelectSingle70,PgClassExpression71,PgClassExpression72 bucket6
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ78ᐳ[79]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,__Item79,PgSelectSingle80,PgClassExpression81,PgClassExpression82,PgClassExpression83 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ88ᐳ[89]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item89,PgSelectSingle90,PgClassExpression91,PgClassExpression92,PgClassExpression93 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ99ᐳ[100]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item100,PgSelectSingle101,PgClassExpression102,PgClassExpression103,PgClassExpression104 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ111ᐳ[112]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item112,PgSelectSingle113,PgClassExpression114,PgClassExpression115,PgClassExpression116 bucket10
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ124ᐳ[125]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item125,PgSelectSingle126,PgClassExpression127,PgClassExpression128 bucket11
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11
    end
