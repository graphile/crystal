%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect65[["PgSelect[65∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object13{{"Object[13∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant164{{"Constant[164∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Lambda161{{"Lambda[161∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object13 & Constant164 & Lambda161 --> PgSelect65
    PgSelect82[["PgSelect[82∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda169{{"Lambda[169∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object13 & Constant164 & Lambda169 --> PgSelect82
    PgSelect10[["PgSelect[10∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object13 & Lambda161 --> PgSelect10
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access12 --> Object13
    PgSelect23[["PgSelect[23∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object13 & Lambda169 --> PgSelect23
    PgSelect35[["PgSelect[35∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object13 & Lambda161 --> PgSelect35
    PgSelect47[["PgSelect[47∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object13 & Lambda161 --> PgSelect47
    PgSelect92[["PgSelect[92∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda209{{"Lambda[209∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object13 & Lambda209 --> PgSelect92
    PgSelect103[["PgSelect[103∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Lambda217{{"Lambda[217∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object13 & Lambda217 --> PgSelect103
    PgSelect135[["PgSelect[135∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object13 & Lambda161 --> PgSelect135
    PgSelect148[["PgSelect[148∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Lambda233{{"Lambda[233∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Object13 & Lambda233 --> PgSelect148
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access12
    Constant236{{"Constant[236∈0] ➊<br />ᐸ[Object: null prototype] {   cursorLower: null,   cursorUppeᐳ"}}:::plan
    Constant236 --> Lambda161
    Constant237{{"Constant[237∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant237 --> Lambda169
    Constant238{{"Constant[238∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant238 --> Lambda209
    Constant239{{"Constant[239∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant239 --> Lambda217
    Constant240{{"Constant[240∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Constant240 --> Lambda233
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item14[/"__Item[14∈1]<br />ᐸ10ᐳ"\]:::itemplan
    PgSelect10 ==> __Item14
    PgSelectSingle15{{"PgSelectSingle[15∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item14 --> PgSelectSingle15
    PgClassExpression16{{"PgClassExpression[16∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression17
    PgClassExpression18{{"PgClassExpression[18∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression18
    __Item25[/"__Item[25∈2]<br />ᐸ23ᐳ"\]:::itemplan
    PgSelect23 ==> __Item25
    PgSelectSingle26{{"PgSelectSingle[26∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item25 --> PgSelectSingle26
    PgClassExpression27{{"PgClassExpression[27∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle26 --> PgClassExpression27
    PgClassExpression28{{"PgClassExpression[28∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle26 --> PgClassExpression28
    PgClassExpression29{{"PgClassExpression[29∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle26 --> PgClassExpression29
    __Item37[/"__Item[37∈3]<br />ᐸ35ᐳ"\]:::itemplan
    PgSelect35 ==> __Item37
    PgSelectSingle38{{"PgSelectSingle[38∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item37 --> PgSelectSingle38
    PgClassExpression39{{"PgClassExpression[39∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression39
    PgClassExpression40{{"PgClassExpression[40∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression40
    PgClassExpression41{{"PgClassExpression[41∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression41
    __Item49[/"__Item[49∈4]<br />ᐸ47ᐳ"\]:::itemplan
    PgSelect47 ==> __Item49
    PgSelectSingle50{{"PgSelectSingle[50∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item49 --> PgSelectSingle50
    PgClassExpression51{{"PgClassExpression[51∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle50 --> PgClassExpression51
    PgClassExpression52{{"PgClassExpression[52∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle50 --> PgClassExpression52
    PgClassExpression53{{"PgClassExpression[53∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle50 --> PgClassExpression53
    __Item67[/"__Item[67∈5]<br />ᐸ65ᐳ"\]:::itemplan
    PgSelect65 ==> __Item67
    PgSelectSingle68{{"PgSelectSingle[68∈5]<br />ᐸpostᐳ"}}:::plan
    __Item67 --> PgSelectSingle68
    PgClassExpression69{{"PgClassExpression[69∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression69
    PgClassExpression70{{"PgClassExpression[70∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression70
    __Item84[/"__Item[84∈6]<br />ᐸ82ᐳ"\]:::itemplan
    PgSelect82 ==> __Item84
    PgSelectSingle85{{"PgSelectSingle[85∈6]<br />ᐸpostᐳ"}}:::plan
    __Item84 --> PgSelectSingle85
    PgClassExpression86{{"PgClassExpression[86∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle85 --> PgClassExpression86
    PgClassExpression87{{"PgClassExpression[87∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle85 --> PgClassExpression87
    __Item94[/"__Item[94∈7]<br />ᐸ92ᐳ"\]:::itemplan
    PgSelect92 ==> __Item94
    PgSelectSingle95{{"PgSelectSingle[95∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item94 --> PgSelectSingle95
    PgClassExpression96{{"PgClassExpression[96∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression96
    PgClassExpression97{{"PgClassExpression[97∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression97
    PgClassExpression98{{"PgClassExpression[98∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression98
    __Item105[/"__Item[105∈8]<br />ᐸ103ᐳ"\]:::itemplan
    PgSelect103 ==> __Item105
    PgSelectSingle106{{"PgSelectSingle[106∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item105 --> PgSelectSingle106
    PgClassExpression107{{"PgClassExpression[107∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression107
    PgClassExpression108{{"PgClassExpression[108∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression108
    PgClassExpression109{{"PgClassExpression[109∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression109
    __Item137[/"__Item[137∈9]<br />ᐸ135ᐳ"\]:::itemplan
    PgSelect135 ==> __Item137
    PgSelectSingle138{{"PgSelectSingle[138∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item137 --> PgSelectSingle138
    PgClassExpression139{{"PgClassExpression[139∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle138 --> PgClassExpression139
    PgClassExpression140{{"PgClassExpression[140∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle138 --> PgClassExpression140
    PgClassExpression141{{"PgClassExpression[141∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle138 --> PgClassExpression141
    __Item150[/"__Item[150∈10]<br />ᐸ148ᐳ"\]:::itemplan
    PgSelect148 ==> __Item150
    PgSelectSingle151{{"PgSelectSingle[151∈10]<br />ᐸpostᐳ"}}:::plan
    __Item150 --> PgSelectSingle151
    PgClassExpression152{{"PgClassExpression[152∈10]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle151 --> PgClassExpression152
    PgClassExpression153{{"PgClassExpression[153∈10]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle151 --> PgClassExpression153

    %% define steps

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 11, 12, 164, 236, 237, 238, 239, 240, 13, 161, 169, 209, 217, 233<br />2: 10, 23, 35, 47, 65, 82, 92, 103, 135, 148"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect10,Access11,Access12,Object13,PgSelect23,PgSelect35,PgSelect47,PgSelect65,PgSelect82,PgSelect92,PgSelect103,PgSelect135,PgSelect148,Lambda161,Constant164,Lambda169,Lambda209,Lambda217,Lambda233,Constant236,Constant237,Constant238,Constant239,Constant240 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ10ᐳ[14]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item14,PgSelectSingle15,PgClassExpression16,PgClassExpression17,PgClassExpression18 bucket1
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ23ᐳ[25]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item25,PgSelectSingle26,PgClassExpression27,PgClassExpression28,PgClassExpression29 bucket2
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ35ᐳ[37]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item37,PgSelectSingle38,PgClassExpression39,PgClassExpression40,PgClassExpression41 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ47ᐳ[49]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item49,PgSelectSingle50,PgClassExpression51,PgClassExpression52,PgClassExpression53 bucket4
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ65ᐳ[67]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item67,PgSelectSingle68,PgClassExpression69,PgClassExpression70 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ82ᐳ[84]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item84,PgSelectSingle85,PgClassExpression86,PgClassExpression87 bucket6
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ92ᐳ[94]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,__Item94,PgSelectSingle95,PgClassExpression96,PgClassExpression97,PgClassExpression98 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ103ᐳ[105]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item105,PgSelectSingle106,PgClassExpression107,PgClassExpression108,PgClassExpression109 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ135ᐳ[137]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item137,PgSelectSingle138,PgClassExpression139,PgClassExpression140,PgClassExpression141 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ148ᐳ[150]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item150,PgSelectSingle151,PgClassExpression152,PgClassExpression153 bucket10
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10
    end
