%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect28[["PgSelect[28∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant6{{"Constant[6∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    ApplyInput30{{"ApplyInput[30∈0] ➊"}}:::plan
    Object10 & Constant6 & Constant6 & ApplyInput30 --> PgSelect28
    PgSelect39[["PgSelect[39∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput41{{"ApplyInput[41∈0] ➊"}}:::plan
    Object10 & Constant6 & Constant6 & ApplyInput41 --> PgSelect39
    PgSelect50[["PgSelect[50∈0] ➊<br />ᐸpostᐳ"]]:::plan
    ApplyInput52{{"ApplyInput[52∈0] ➊"}}:::plan
    Object10 & Constant6 & Constant6 & ApplyInput52 --> PgSelect50
    PgSelect61[["PgSelect[61∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Constant122{{"Constant[122∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput63{{"ApplyInput[63∈0] ➊"}}:::plan
    Object10 & Constant122 & Constant6 & ApplyInput63 --> PgSelect61
    PgSelect90[["PgSelect[90∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput92{{"ApplyInput[92∈0] ➊"}}:::plan
    Object10 & Constant6 & Constant6 & ApplyInput92 --> PgSelect90
    PgSelect101[["PgSelect[101∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput103{{"ApplyInput[103∈0] ➊"}}:::plan
    Object10 & Constant6 & Constant6 & ApplyInput103 --> PgSelect101
    PgSelect114[["PgSelect[114∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Constant127{{"Constant[127∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    ApplyInput116{{"ApplyInput[116∈0] ➊"}}:::plan
    Object10 & Constant127 & Constant6 & ApplyInput116 --> PgSelect114
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Constant6 & Constant6 --> PgSelect7
    PgSelect18[["PgSelect[18∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Constant122 & Constant6 --> PgSelect18
    PgSelect71[["PgSelect[71∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant128{{"Constant[128∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object10 & Constant127 & Constant128 --> PgSelect71
    PgSelect80[["PgSelect[80∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant129{{"Constant[129∈0] ➊<br />ᐸ0ᐳ"}}:::plan
    Object10 & Constant129 & Constant6 --> PgSelect80
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    __InputObject48{{"__InputObject[48∈0] ➊"}}:::plan
    Constant6 & Constant122 --> __InputObject48
    __InputObject59{{"__InputObject[59∈0] ➊"}}:::plan
    Constant6 & Constant122 --> __InputObject59
    __InputObject99{{"__InputObject[99∈0] ➊"}}:::plan
    Constant132{{"Constant[132∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant6 & Constant132 --> __InputObject99
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    PgSelectRows11[["PgSelectRows[11∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows11
    PgSelectRows20[["PgSelectRows[20∈0] ➊"]]:::plan
    PgSelect18 --> PgSelectRows20
    Constant136{{"Constant[136∈0] ➊<br />ᐸ[ 'NAME_ASC' ]ᐳ"}}:::plan
    Constant136 --> ApplyInput30
    PgSelectRows31[["PgSelectRows[31∈0] ➊"]]:::plan
    PgSelect28 --> PgSelectRows31
    Constant137{{"Constant[137∈0] ➊<br />ᐸ[ 'NAME_DESC' ]ᐳ"}}:::plan
    Constant137 --> ApplyInput41
    PgSelectRows42[["PgSelectRows[42∈0] ➊"]]:::plan
    PgSelect39 --> PgSelectRows42
    __InputObject48 --> ApplyInput52
    PgSelectRows53[["PgSelectRows[53∈0] ➊"]]:::plan
    PgSelect50 --> PgSelectRows53
    __InputObject59 --> ApplyInput63
    PgSelectRows64[["PgSelectRows[64∈0] ➊"]]:::plan
    PgSelect61 --> PgSelectRows64
    PgSelectRows73[["PgSelectRows[73∈0] ➊"]]:::plan
    PgSelect71 --> PgSelectRows73
    PgSelectRows82[["PgSelectRows[82∈0] ➊"]]:::plan
    PgSelect80 --> PgSelectRows82
    Constant138{{"Constant[138∈0] ➊<br />ᐸ[ 'PRIMARY_KEY_ASC' ]ᐳ"}}:::plan
    Constant138 --> ApplyInput92
    PgSelectRows93[["PgSelectRows[93∈0] ➊"]]:::plan
    PgSelect90 --> PgSelectRows93
    __InputObject99 --> ApplyInput103
    PgSelectRows104[["PgSelectRows[104∈0] ➊"]]:::plan
    PgSelect101 --> PgSelectRows104
    Constant139{{"Constant[139∈0] ➊<br />ᐸ[ 'AUTHOR_ID_DESC', 'HEADLINE_DESC' ]ᐳ"}}:::plan
    Constant139 --> ApplyInput116
    PgSelectRows117[["PgSelectRows[117∈0] ➊"]]:::plan
    PgSelect114 --> PgSelectRows117
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item12[/"__Item[12∈1]<br />ᐸ11ᐳ"\]:::itemplan
    PgSelectRows11 ==> __Item12
    PgSelectSingle13{{"PgSelectSingle[13∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item12 --> PgSelectSingle13
    PgClassExpression14{{"PgClassExpression[14∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression14
    PgClassExpression15{{"PgClassExpression[15∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression15
    PgClassExpression16{{"PgClassExpression[16∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression16
    __Item21[/"__Item[21∈2]<br />ᐸ20ᐳ"\]:::itemplan
    PgSelectRows20 ==> __Item21
    PgSelectSingle22{{"PgSelectSingle[22∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item21 --> PgSelectSingle22
    PgClassExpression23{{"PgClassExpression[23∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression23
    PgClassExpression24{{"PgClassExpression[24∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression24
    PgClassExpression25{{"PgClassExpression[25∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression25
    __Item32[/"__Item[32∈3]<br />ᐸ31ᐳ"\]:::itemplan
    PgSelectRows31 ==> __Item32
    PgSelectSingle33{{"PgSelectSingle[33∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item32 --> PgSelectSingle33
    PgClassExpression34{{"PgClassExpression[34∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle33 --> PgClassExpression34
    PgClassExpression35{{"PgClassExpression[35∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle33 --> PgClassExpression35
    PgClassExpression36{{"PgClassExpression[36∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle33 --> PgClassExpression36
    __Item43[/"__Item[43∈4]<br />ᐸ42ᐳ"\]:::itemplan
    PgSelectRows42 ==> __Item43
    PgSelectSingle44{{"PgSelectSingle[44∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item43 --> PgSelectSingle44
    PgClassExpression45{{"PgClassExpression[45∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle44 --> PgClassExpression45
    PgClassExpression46{{"PgClassExpression[46∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle44 --> PgClassExpression46
    PgClassExpression47{{"PgClassExpression[47∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle44 --> PgClassExpression47
    __Item54[/"__Item[54∈5]<br />ᐸ53ᐳ"\]:::itemplan
    PgSelectRows53 ==> __Item54
    PgSelectSingle55{{"PgSelectSingle[55∈5]<br />ᐸpostᐳ"}}:::plan
    __Item54 --> PgSelectSingle55
    PgClassExpression56{{"PgClassExpression[56∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression56
    PgClassExpression57{{"PgClassExpression[57∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression57
    __Item65[/"__Item[65∈6]<br />ᐸ64ᐳ"\]:::itemplan
    PgSelectRows64 ==> __Item65
    PgSelectSingle66{{"PgSelectSingle[66∈6]<br />ᐸpostᐳ"}}:::plan
    __Item65 --> PgSelectSingle66
    PgClassExpression67{{"PgClassExpression[67∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression67
    PgClassExpression68{{"PgClassExpression[68∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression68
    __Item74[/"__Item[74∈7]<br />ᐸ73ᐳ"\]:::itemplan
    PgSelectRows73 ==> __Item74
    PgSelectSingle75{{"PgSelectSingle[75∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item74 --> PgSelectSingle75
    PgClassExpression76{{"PgClassExpression[76∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression76
    PgClassExpression77{{"PgClassExpression[77∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression77
    PgClassExpression78{{"PgClassExpression[78∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression78
    __Item83[/"__Item[83∈8]<br />ᐸ82ᐳ"\]:::itemplan
    PgSelectRows82 ==> __Item83
    PgSelectSingle84{{"PgSelectSingle[84∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item83 --> PgSelectSingle84
    PgClassExpression85{{"PgClassExpression[85∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression85
    PgClassExpression86{{"PgClassExpression[86∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression86
    PgClassExpression87{{"PgClassExpression[87∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression87
    __Item94[/"__Item[94∈9]<br />ᐸ93ᐳ"\]:::itemplan
    PgSelectRows93 ==> __Item94
    PgSelectSingle95{{"PgSelectSingle[95∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item94 --> PgSelectSingle95
    PgClassExpression96{{"PgClassExpression[96∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression96
    PgClassExpression97{{"PgClassExpression[97∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression97
    PgClassExpression98{{"PgClassExpression[98∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression98
    __Item105[/"__Item[105∈10]<br />ᐸ104ᐳ"\]:::itemplan
    PgSelectRows104 ==> __Item105
    PgSelectSingle106{{"PgSelectSingle[106∈10]<br />ᐸpersonᐳ"}}:::plan
    __Item105 --> PgSelectSingle106
    PgClassExpression107{{"PgClassExpression[107∈10]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression107
    PgClassExpression108{{"PgClassExpression[108∈10]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression108
    PgClassExpression109{{"PgClassExpression[109∈10]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle106 --> PgClassExpression109
    __Item118[/"__Item[118∈11]<br />ᐸ117ᐳ"\]:::itemplan
    PgSelectRows117 ==> __Item118
    PgSelectSingle119{{"PgSelectSingle[119∈11]<br />ᐸpostᐳ"}}:::plan
    __Item118 --> PgSelectSingle119
    PgClassExpression120{{"PgClassExpression[120∈11]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle119 --> PgClassExpression120
    PgClassExpression121{{"PgClassExpression[121∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle119 --> PgClassExpression121

    %% define steps

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 9, 122, 127, 128, 129, 132, 136, 137, 138, 139, 10, 30, 41, 48, 52, 59, 63, 92, 99, 103, 116<br />2: 7, 18, 28, 39, 50, 61, 71, 80, 90, 101, 114<br />3: 11, 20, 31, 42, 53, 64, 73, 82, 93, 104, 117"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant6,PgSelect7,Access8,Access9,Object10,PgSelectRows11,PgSelect18,PgSelectRows20,PgSelect28,ApplyInput30,PgSelectRows31,PgSelect39,ApplyInput41,PgSelectRows42,__InputObject48,PgSelect50,ApplyInput52,PgSelectRows53,__InputObject59,PgSelect61,ApplyInput63,PgSelectRows64,PgSelect71,PgSelectRows73,PgSelect80,PgSelectRows82,PgSelect90,ApplyInput92,PgSelectRows93,__InputObject99,PgSelect101,ApplyInput103,PgSelectRows104,PgSelect114,ApplyInput116,PgSelectRows117,Constant122,Constant127,Constant128,Constant129,Constant132,Constant136,Constant137,Constant138,Constant139 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ11ᐳ[12]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item12,PgSelectSingle13,PgClassExpression14,PgClassExpression15,PgClassExpression16 bucket1
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ20ᐳ[21]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item21,PgSelectSingle22,PgClassExpression23,PgClassExpression24,PgClassExpression25 bucket2
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ31ᐳ[32]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item32,PgSelectSingle33,PgClassExpression34,PgClassExpression35,PgClassExpression36 bucket3
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ42ᐳ[43]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item43,PgSelectSingle44,PgClassExpression45,PgClassExpression46,PgClassExpression47 bucket4
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ53ᐳ[54]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item54,PgSelectSingle55,PgClassExpression56,PgClassExpression57 bucket5
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ64ᐳ[65]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item65,PgSelectSingle66,PgClassExpression67,PgClassExpression68 bucket6
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ73ᐳ[74]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,__Item74,PgSelectSingle75,PgClassExpression76,PgClassExpression77,PgClassExpression78 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ82ᐳ[83]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item83,PgSelectSingle84,PgClassExpression85,PgClassExpression86,PgClassExpression87 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ93ᐳ[94]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item94,PgSelectSingle95,PgClassExpression96,PgClassExpression97,PgClassExpression98 bucket9
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ104ᐳ[105]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item105,PgSelectSingle106,PgClassExpression107,PgClassExpression108,PgClassExpression109 bucket10
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ117ᐳ[118]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item118,PgSelectSingle119,PgClassExpression120,PgClassExpression121 bucket11
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11
    end
