%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸconstructorᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Lambda11{{"Lambda[11∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    Constant6{{"Constant[6∈0] ➊<br />ᐸundefinedᐳ"}}:::plan
    ApplyInput12{{"ApplyInput[12∈0] ➊"}}:::plan
    Object10 & Lambda11 & Constant6 & Constant6 & ApplyInput12 --> PgSelect7
    PgSelect43[["PgSelect[43∈0] ➊<br />ᐸyieldᐳ"]]:::plan
    Lambda45{{"Lambda[45∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    ApplyInput46{{"ApplyInput[46∈0] ➊"}}:::plan
    Object10 & Lambda45 & Constant6 & Constant6 & ApplyInput46 --> PgSelect43
    PgSelect69[["PgSelect[69∈0] ➊<br />ᐸ__proto__ᐳ"]]:::plan
    Lambda71{{"Lambda[71∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    ApplyInput72{{"ApplyInput[72∈0] ➊"}}:::plan
    Object10 & Lambda71 & Constant6 & Constant6 & ApplyInput72 --> PgSelect69
    PgSelect95[["PgSelect[95∈0] ➊<br />ᐸnullᐳ"]]:::plan
    Lambda97{{"Lambda[97∈0] ➊<br />ᐸextractList_grafast_applyᐳ"}}:::plan
    ApplyInput98{{"ApplyInput[98∈0] ➊"}}:::plan
    Object10 & Lambda97 & Constant6 & Constant6 & ApplyInput98 --> PgSelect95
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    PgSelect20[["PgSelect[20∈0] ➊<br />ᐸconstructorᐳ"]]:::plan
    Constant129{{"Constant[129∈0] ➊<br />ᐸ'Copper Wire'ᐳ"}}:::plan
    Object10 & Constant129 --> PgSelect20
    PgSelect28[["PgSelect[28∈0] ➊<br />ᐸconstructorᐳ"]]:::plan
    Constant130{{"Constant[130∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    Object10 & Constant130 --> PgSelect28
    PgSelect36[["PgSelect[36∈0] ➊<br />ᐸconstructorᐳ"]]:::plan
    Constant131{{"Constant[131∈0] ➊<br />ᐸ'Iron Mine'ᐳ"}}:::plan
    Object10 & Constant131 --> PgSelect36
    PgSelect54[["PgSelect[54∈0] ➊<br />ᐸyieldᐳ"]]:::plan
    Constant132{{"Constant[132∈0] ➊<br />ᐸ'UK'ᐳ"}}:::plan
    Object10 & Constant132 --> PgSelect54
    PgSelect62[["PgSelect[62∈0] ➊<br />ᐸyieldᐳ"]]:::plan
    Object10 & Constant130 --> PgSelect62
    PgSelect80[["PgSelect[80∈0] ➊<br />ᐸ__proto__ᐳ"]]:::plan
    Constant133{{"Constant[133∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object10 & Constant133 --> PgSelect80
    PgSelect88[["PgSelect[88∈0] ➊<br />ᐸ__proto__ᐳ"]]:::plan
    Constant134{{"Constant[134∈0] ➊<br />ᐸ'VCS'ᐳ"}}:::plan
    Object10 & Constant134 --> PgSelect88
    PgSelect106[["PgSelect[106∈0] ➊<br />ᐸnullᐳ"]]:::plan
    Constant135{{"Constant[135∈0] ➊<br />ᐸ'10 am'ᐳ"}}:::plan
    Object10 & Constant135 --> PgSelect106
    PgSelect114[["PgSelect[114∈0] ➊<br />ᐸnullᐳ"]]:::plan
    Constant136{{"Constant[136∈0] ➊<br />ᐸ'flat'ᐳ"}}:::plan
    Object10 & Constant136 --> PgSelect114
    PgSelect122[["PgSelect[122∈0] ➊<br />ᐸnullᐳ"]]:::plan
    Constant137{{"Constant[137∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    Object10 & Constant137 --> PgSelect122
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    Constant6 --> Lambda11
    Constant6 --> ApplyInput12
    PgSelectRows13[["PgSelectRows[13∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows13
    First22{{"First[22∈0] ➊"}}:::plan
    PgSelectRows23[["PgSelectRows[23∈0] ➊"]]:::plan
    PgSelectRows23 --> First22
    PgSelect20 --> PgSelectRows23
    PgSelectSingle24{{"PgSelectSingle[24∈0] ➊<br />ᐸconstructorᐳ"}}:::plan
    First22 --> PgSelectSingle24
    First30{{"First[30∈0] ➊"}}:::plan
    PgSelectRows31[["PgSelectRows[31∈0] ➊"]]:::plan
    PgSelectRows31 --> First30
    PgSelect28 --> PgSelectRows31
    PgSelectSingle32{{"PgSelectSingle[32∈0] ➊<br />ᐸconstructorᐳ"}}:::plan
    First30 --> PgSelectSingle32
    First38{{"First[38∈0] ➊"}}:::plan
    PgSelectRows39[["PgSelectRows[39∈0] ➊"]]:::plan
    PgSelectRows39 --> First38
    PgSelect36 --> PgSelectRows39
    PgSelectSingle40{{"PgSelectSingle[40∈0] ➊<br />ᐸconstructorᐳ"}}:::plan
    First38 --> PgSelectSingle40
    Constant6 --> Lambda45
    Constant6 --> ApplyInput46
    PgSelectRows47[["PgSelectRows[47∈0] ➊"]]:::plan
    PgSelect43 --> PgSelectRows47
    First56{{"First[56∈0] ➊"}}:::plan
    PgSelectRows57[["PgSelectRows[57∈0] ➊"]]:::plan
    PgSelectRows57 --> First56
    PgSelect54 --> PgSelectRows57
    PgSelectSingle58{{"PgSelectSingle[58∈0] ➊<br />ᐸyieldᐳ"}}:::plan
    First56 --> PgSelectSingle58
    First64{{"First[64∈0] ➊"}}:::plan
    PgSelectRows65[["PgSelectRows[65∈0] ➊"]]:::plan
    PgSelectRows65 --> First64
    PgSelect62 --> PgSelectRows65
    PgSelectSingle66{{"PgSelectSingle[66∈0] ➊<br />ᐸyieldᐳ"}}:::plan
    First64 --> PgSelectSingle66
    Constant6 --> Lambda71
    Constant6 --> ApplyInput72
    PgSelectRows73[["PgSelectRows[73∈0] ➊"]]:::plan
    PgSelect69 --> PgSelectRows73
    First82{{"First[82∈0] ➊"}}:::plan
    PgSelectRows83[["PgSelectRows[83∈0] ➊"]]:::plan
    PgSelectRows83 --> First82
    PgSelect80 --> PgSelectRows83
    PgSelectSingle84{{"PgSelectSingle[84∈0] ➊<br />ᐸ__proto__ᐳ"}}:::plan
    First82 --> PgSelectSingle84
    First90{{"First[90∈0] ➊"}}:::plan
    PgSelectRows91[["PgSelectRows[91∈0] ➊"]]:::plan
    PgSelectRows91 --> First90
    PgSelect88 --> PgSelectRows91
    PgSelectSingle92{{"PgSelectSingle[92∈0] ➊<br />ᐸ__proto__ᐳ"}}:::plan
    First90 --> PgSelectSingle92
    Constant6 --> Lambda97
    Constant6 --> ApplyInput98
    PgSelectRows99[["PgSelectRows[99∈0] ➊"]]:::plan
    PgSelect95 --> PgSelectRows99
    First108{{"First[108∈0] ➊"}}:::plan
    PgSelectRows109[["PgSelectRows[109∈0] ➊"]]:::plan
    PgSelectRows109 --> First108
    PgSelect106 --> PgSelectRows109
    PgSelectSingle110{{"PgSelectSingle[110∈0] ➊<br />ᐸnullᐳ"}}:::plan
    First108 --> PgSelectSingle110
    First116{{"First[116∈0] ➊"}}:::plan
    PgSelectRows117[["PgSelectRows[117∈0] ➊"]]:::plan
    PgSelectRows117 --> First116
    PgSelect114 --> PgSelectRows117
    PgSelectSingle118{{"PgSelectSingle[118∈0] ➊<br />ᐸnullᐳ"}}:::plan
    First116 --> PgSelectSingle118
    First124{{"First[124∈0] ➊"}}:::plan
    PgSelectRows125[["PgSelectRows[125∈0] ➊"]]:::plan
    PgSelectRows125 --> First124
    PgSelect122 --> PgSelectRows125
    PgSelectSingle126{{"PgSelectSingle[126∈0] ➊<br />ᐸnullᐳ"}}:::plan
    First124 --> PgSelectSingle126
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item14[/"__Item[14∈1]<br />ᐸ13ᐳ"\]:::itemplan
    PgSelectRows13 ==> __Item14
    PgSelectSingle15{{"PgSelectSingle[15∈1]<br />ᐸconstructorᐳ"}}:::plan
    __Item14 --> PgSelectSingle15
    PgClassExpression16{{"PgClassExpression[16∈1]<br />ᐸ__constructor__.”name”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression16
    PgClassExpression17{{"PgClassExpression[17∈1]<br />ᐸ__construc..._.”export”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression17
    PgClassExpression18{{"PgClassExpression[18∈1]<br />ᐸ__constructor__.”id”ᐳ"}}:::plan
    PgSelectSingle15 --> PgClassExpression18
    PgClassExpression25{{"PgClassExpression[25∈2] ➊<br />ᐸ__constructor__.”name”ᐳ"}}:::plan
    PgSelectSingle24 --> PgClassExpression25
    PgClassExpression26{{"PgClassExpression[26∈2] ➊<br />ᐸ__constructor__.”id”ᐳ"}}:::plan
    PgSelectSingle24 --> PgClassExpression26
    PgClassExpression33{{"PgClassExpression[33∈3] ➊<br />ᐸ__construc..._.”export”ᐳ"}}:::plan
    PgSelectSingle32 --> PgClassExpression33
    PgClassExpression34{{"PgClassExpression[34∈3] ➊<br />ᐸ__constructor__.”name”ᐳ"}}:::plan
    PgSelectSingle32 --> PgClassExpression34
    PgClassExpression41{{"PgClassExpression[41∈4] ➊<br />ᐸ__construc..._.”export”ᐳ"}}:::plan
    PgSelectSingle40 --> PgClassExpression41
    PgClassExpression42{{"PgClassExpression[42∈4] ➊<br />ᐸ__constructor__.”id”ᐳ"}}:::plan
    PgSelectSingle40 --> PgClassExpression42
    __Item48[/"__Item[48∈5]<br />ᐸ47ᐳ"\]:::itemplan
    PgSelectRows47 ==> __Item48
    PgSelectSingle49{{"PgSelectSingle[49∈5]<br />ᐸyieldᐳ"}}:::plan
    __Item48 --> PgSelectSingle49
    PgClassExpression50{{"PgClassExpression[50∈5]<br />ᐸ__yield__.”crop”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression50
    PgClassExpression51{{"PgClassExpression[51∈5]<br />ᐸ__yield__.”export”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression51
    PgClassExpression52{{"PgClassExpression[52∈5]<br />ᐸ__yield__.”id”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression52
    PgClassExpression59{{"PgClassExpression[59∈6] ➊<br />ᐸ__yield__.”crop”ᐳ"}}:::plan
    PgSelectSingle58 --> PgClassExpression59
    PgClassExpression60{{"PgClassExpression[60∈6] ➊<br />ᐸ__yield__.”id”ᐳ"}}:::plan
    PgSelectSingle58 --> PgClassExpression60
    PgClassExpression67{{"PgClassExpression[67∈7] ➊<br />ᐸ__yield__.”crop”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression67
    PgClassExpression68{{"PgClassExpression[68∈7] ➊<br />ᐸ__yield__.”export”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression68
    __Item74[/"__Item[74∈8]<br />ᐸ73ᐳ"\]:::itemplan
    PgSelectRows73 ==> __Item74
    PgSelectSingle75{{"PgSelectSingle[75∈8]<br />ᐸ__proto__ᐳ"}}:::plan
    __Item74 --> PgSelectSingle75
    PgClassExpression76{{"PgClassExpression[76∈8]<br />ᐸ__proto__.”id”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression76
    PgClassExpression77{{"PgClassExpression[77∈8]<br />ᐸ__proto__.”name”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression77
    PgClassExpression78{{"PgClassExpression[78∈8]<br />ᐸ__proto__.”brand”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression78
    PgClassExpression85{{"PgClassExpression[85∈9] ➊<br />ᐸ__proto__.”brand”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression85
    PgClassExpression86{{"PgClassExpression[86∈9] ➊<br />ᐸ__proto__.”name”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression86
    PgClassExpression93{{"PgClassExpression[93∈10] ➊<br />ᐸ__proto__.”brand”ᐳ"}}:::plan
    PgSelectSingle92 --> PgClassExpression93
    PgClassExpression94{{"PgClassExpression[94∈10] ➊<br />ᐸ__proto__.”id”ᐳ"}}:::plan
    PgSelectSingle92 --> PgClassExpression94
    __Item100[/"__Item[100∈11]<br />ᐸ99ᐳ"\]:::itemplan
    PgSelectRows99 ==> __Item100
    PgSelectSingle101{{"PgSelectSingle[101∈11]<br />ᐸnullᐳ"}}:::plan
    __Item100 --> PgSelectSingle101
    PgClassExpression102{{"PgClassExpression[102∈11]<br />ᐸ__null__.”break”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression102
    PgClassExpression103{{"PgClassExpression[103∈11]<br />ᐸ__null__.”...nProperty”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression103
    PgClassExpression104{{"PgClassExpression[104∈11]<br />ᐸ__null__.”id”ᐳ"}}:::plan
    PgSelectSingle101 --> PgClassExpression104
    PgClassExpression111{{"PgClassExpression[111∈12] ➊<br />ᐸ__null__.”...nProperty”ᐳ"}}:::plan
    PgSelectSingle110 --> PgClassExpression111
    PgClassExpression112{{"PgClassExpression[112∈12] ➊<br />ᐸ__null__.”id”ᐳ"}}:::plan
    PgSelectSingle110 --> PgClassExpression112
    PgClassExpression119{{"PgClassExpression[119∈13] ➊<br />ᐸ__null__.”break”ᐳ"}}:::plan
    PgSelectSingle118 --> PgClassExpression119
    PgClassExpression120{{"PgClassExpression[120∈13] ➊<br />ᐸ__null__.”id”ᐳ"}}:::plan
    PgSelectSingle118 --> PgClassExpression120
    PgClassExpression127{{"PgClassExpression[127∈14] ➊<br />ᐸ__null__.”break”ᐳ"}}:::plan
    PgSelectSingle126 --> PgClassExpression127
    PgClassExpression128{{"PgClassExpression[128∈14] ➊<br />ᐸ__null__.”...nProperty”ᐳ"}}:::plan
    PgSelectSingle126 --> PgClassExpression128

    %% define steps

    subgraph "Buckets for queries/v4/js-reserved-table-names"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 9, 129, 130, 131, 132, 133, 134, 135, 136, 137, 10, 11, 12, 45, 46, 71, 72, 97, 98<br />2: 7, 20, 28, 36, 43, 54, 62, 69, 80, 88, 95, 106, 114, 122<br />3: 13, 23, 31, 39, 47, 57, 65, 73, 83, 91, 99, 109, 117, 125<br />ᐳ: 22, 24, 30, 32, 38, 40, 56, 58, 64, 66, 82, 84, 90, 92, 108, 110, 116, 118, 124, 126"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Constant6,PgSelect7,Access8,Access9,Object10,Lambda11,ApplyInput12,PgSelectRows13,PgSelect20,First22,PgSelectRows23,PgSelectSingle24,PgSelect28,First30,PgSelectRows31,PgSelectSingle32,PgSelect36,First38,PgSelectRows39,PgSelectSingle40,PgSelect43,Lambda45,ApplyInput46,PgSelectRows47,PgSelect54,First56,PgSelectRows57,PgSelectSingle58,PgSelect62,First64,PgSelectRows65,PgSelectSingle66,PgSelect69,Lambda71,ApplyInput72,PgSelectRows73,PgSelect80,First82,PgSelectRows83,PgSelectSingle84,PgSelect88,First90,PgSelectRows91,PgSelectSingle92,PgSelect95,Lambda97,ApplyInput98,PgSelectRows99,PgSelect106,First108,PgSelectRows109,PgSelectSingle110,PgSelect114,First116,PgSelectRows117,PgSelectSingle118,PgSelect122,First124,PgSelectRows125,PgSelectSingle126,Constant129,Constant130,Constant131,Constant132,Constant133,Constant134,Constant135,Constant136,Constant137 bucket0
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ13ᐳ[14]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item14,PgSelectSingle15,PgClassExpression16,PgClassExpression17,PgClassExpression18 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 24<br /><br />ROOT PgSelectSingleᐸconstructorᐳ[24]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression25,PgClassExpression26 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 32<br /><br />ROOT PgSelectSingleᐸconstructorᐳ[32]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression33,PgClassExpression34 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 40<br /><br />ROOT PgSelectSingleᐸconstructorᐳ[40]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression41,PgClassExpression42 bucket4
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ47ᐳ[48]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item48,PgSelectSingle49,PgClassExpression50,PgClassExpression51,PgClassExpression52 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 58<br /><br />ROOT PgSelectSingleᐸyieldᐳ[58]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgClassExpression59,PgClassExpression60 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 66<br /><br />ROOT PgSelectSingleᐸyieldᐳ[66]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression67,PgClassExpression68 bucket7
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ73ᐳ[74]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item74,PgSelectSingle75,PgClassExpression76,PgClassExpression77,PgClassExpression78 bucket8
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 84<br /><br />ROOT PgSelectSingleᐸ__proto__ᐳ[84]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgClassExpression85,PgClassExpression86 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 92<br /><br />ROOT PgSelectSingleᐸ__proto__ᐳ[92]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression93,PgClassExpression94 bucket10
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ99ᐳ[100]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item100,PgSelectSingle101,PgClassExpression102,PgClassExpression103,PgClassExpression104 bucket11
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 110<br /><br />ROOT PgSelectSingleᐸnullᐳ[110]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgClassExpression111,PgClassExpression112 bucket12
    Bucket13("Bucket 13 (nullableBoundary)<br />Deps: 118<br /><br />ROOT PgSelectSingleᐸnullᐳ[118]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgClassExpression119,PgClassExpression120 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 126<br /><br />ROOT PgSelectSingleᐸnullᐳ[126]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14,PgClassExpression127,PgClassExpression128 bucket14
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11 & Bucket12 & Bucket13 & Bucket14
    end
