%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/polymorphic/vulns"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 11, 12, 16, 21, 36, 78, 108, 109, 110, 13, 15<br />2: 10, 19, 28<br />ᐳ: 62, 106, 107, 29, 32<br />3: Connection[14]<br />4: ConnectionItems[25]<br />ᐳ: 61, 63, 66, 67"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 14, 62, 78, 25, 13, 32, 63, 67<br /><br />ROOT Connectionᐸ10ᐳ[14]"):::bucket
    Bucket2("Bucket 2 (listItem)<br />Deps: 36, 13<br /><br />ROOT __Item{2}ᐸ106ᐳ[23]"):::bucket
    Bucket4("Bucket 4 (polymorphic)<br />__typename: Access[40]<br />Deps: 40, 13, 41"):::bucket
    Bucket5("Bucket 5 (polymorphicPartition)<br />|FirstPartyVulnerability<br />Deps: 13, 41<br />ᐳFirstPartyVulnerability<br /><br />1: PgSelect[42]<br />2: PgSelectRows[47]<br />ᐳ: 46, 48, 59, 64, 68"):::bucket
    Bucket6("Bucket 6 (polymorphicPartition)<br />|ThirdPartyVulnerability<br />Deps: 13, 41<br />ᐳThirdPartyVulnerability<br /><br />1: PgSelect[50]<br />2: PgSelectRows[55]<br />ᐳ: 54, 56, 60, 65, 69, 71"):::bucket
    Bucket7("Bucket 7 (listItem)<br />Deps: 62, 78, 13<br /><br />ROOT __Item{7}ᐸ25ᐳ[57]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 80, 58, 13, 83, 74<br /><br />ROOT Edge{7}[58]"):::bucket
    Bucket9("Bucket 9 (polymorphic)<br />__typename: Access[82]<br />Deps: 82, 13, 83"):::bucket
    Bucket10("Bucket 10 (polymorphicPartition)<br />|FirstPartyVulnerability<br />Deps: 13, 83<br />ᐳFirstPartyVulnerability<br /><br />1: PgSelect[84]<br />2: PgSelectRows[89]<br />ᐳ: 88, 90, 99, 101, 103"):::bucket
    Bucket11("Bucket 11 (polymorphicPartition)<br />|ThirdPartyVulnerability<br />Deps: 13, 83<br />ᐳThirdPartyVulnerability<br /><br />1: PgSelect[92]<br />2: PgSelectRows[97]<br />ᐳ: 96, 98, 100, 102, 104, 105"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2
    Bucket1 --> Bucket7
    Bucket2 --> Bucket4
    Bucket4 --> Bucket5 & Bucket6
    Bucket7 --> Bucket8
    Bucket8 --> Bucket9
    Bucket9 --> Bucket10 & Bucket11

    %% plan dependencies
    PgUnionAll10[["PgUnionAll[10∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[108]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[16]"]]:::plan
    Lambda15{{"Lambda[15∈0] ➊<br />ᐸparseCursorᐳ<br />More deps:<br />- Constantᐸ'WyJkNGRlODQ2NjQ3IiwiMTAiLCJUaGlyZFBhcnR5VnVsbmVyYWJpbGl0eSIᐳ[109]"}}:::plan
    Lambda15 --> PgUnionAll10
    PgUnionAll19[["PgUnionAll[19∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[108]<br />- Constantᐸ1ᐳ[110]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[21]"]]:::plan
    PgUnionAll28[["PgUnionAll[28∈0] ➊<br />ᐸFirstPartyVulnerability,ThirdPartyVulnerabilityᐳ<br />More deps:<br />- Object[13]<br />- Constantᐸ3ᐳ[108]<br />- Constantᐸ[Function: applyInputConstant]ᐳ[16]"]]:::plan
    Lambda15 --> PgUnionAll28
    Connection14[["Connection[14∈0] ➊<br />ᐸ10ᐳ<br />Dependents: 4<br />More deps:<br />- Constantᐸ3ᐳ[108]"]]:::plan
    PgUnionAll10 & Lambda15 --> Connection14
    Object13{{"Object[13∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ<br />Dependents: 7"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access12 --> Object13
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access12
    ConnectionItems25[["ConnectionItems[25∈0] ➊<br />Dependents: 3<br />More deps:<br />- Connection[14]"]]:::plan
    First29{{"First[29∈0] ➊"}}:::plan
    Access107{{"Access[107∈0] ➊<br />ᐸ28.itemsᐳ"}}:::plan
    Access107 --> First29
    First61{{"First[61∈0] ➊<br />More deps:<br />- ConnectionItems[25]"}}:::plan
    Access62{{"Access[62∈0] ➊<br />ᐸ10.cursorDetailsᐳ<br />Dependents: 3"}}:::plan
    PgUnionAll10 --> Access62
    Last66{{"Last[66∈0] ➊<br />More deps:<br />- ConnectionItems[25]"}}:::plan
    Access106{{"Access[106∈0] ➊<br />ᐸ19.itemsᐳ"}}:::plan
    PgUnionAll19 --> Access106
    PgUnionAll28 --> Access107
    PageInfo33{{"PageInfo[33∈1] ➊<br />More deps:<br />- Connection[14]"}}:::plan
    Access70{{"Access[70∈1] ➊<br />ᐸ14.hasNextPageᐳ<br />More deps:<br />- Connection[14]"}}:::plan
    Access72{{"Access[72∈1] ➊<br />ᐸ14.hasPreviousPageᐳ<br />More deps:<br />- Connection[14]"}}:::plan
    List37{{"List[37∈2]<br />ᐸ34,35,36ᐳ<br />More deps:<br />- Constantᐸ[HIDDEN]ᐳ[36]"}}:::plan
    Access34{{"Access[34∈2]<br />ᐸ23.0ᐳ"}}:::plan
    Access35{{"Access[35∈2]<br />ᐸ23.1ᐳ"}}:::plan
    Access34 & Access35 --> List37
    __Item23[/"__Item[23∈2]<br />ᐸ106ᐳ"\]:::itemplan
    Access106 ==> __Item23
    __Item23 --> Access34
    __Item23 --> Access35
    Lambda38{{"Lambda[38∈2]<br />ᐸtoSpecifierᐳ"}}:::plan
    List37 --> Lambda38
    Access40{{"Access[40∈2]<br />ᐸ38.__typenameᐳ"}}:::plan
    Lambda38 -->|rejectNull| Access40
    Access41{{"Access[41∈2]<br />ᐸ38.idᐳ"}}:::plan
    Lambda38 -->|rejectNull| Access41
    PgSelect42[["PgSelect[42∈5]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳFirstPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access41 --> PgSelect42
    First46{{"First[46∈5]^"}}:::plan
    PgSelectRows47[["PgSelectRows[47∈5]^"]]:::plan
    PgSelectRows47 --> First46
    PgSelect42 --> PgSelectRows47
    PgSelectSingle48{{"PgSelectSingle[48∈5]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First46 --> PgSelectSingle48
    PgClassExpression59{{"PgClassExpression[59∈5]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression59
    PgClassExpression64{{"PgClassExpression[64∈5]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression59 o--o PgClassExpression64
    PgClassExpression68{{"PgClassExpression[68∈5]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression64 o--o PgClassExpression68
    PgSelect50[["PgSelect[50∈6]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳThirdPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access41 --> PgSelect50
    First54{{"First[54∈6]^"}}:::plan
    PgSelectRows55[["PgSelectRows[55∈6]^"]]:::plan
    PgSelectRows55 --> First54
    PgSelect50 --> PgSelectRows55
    PgSelectSingle56{{"PgSelectSingle[56∈6]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First54 --> PgSelectSingle56
    PgClassExpression60{{"PgClassExpression[60∈6]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression60
    PgClassExpression65{{"PgClassExpression[65∈6]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression60 o--o PgClassExpression65
    PgClassExpression69{{"PgClassExpression[69∈6]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression65 o--o PgClassExpression69
    PgClassExpression71{{"PgClassExpression[71∈6]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgClassExpression69 o--o PgClassExpression71
    List79{{"List[79∈7]<br />ᐸ76,77,78ᐳ<br />More deps:<br />- Constantᐸ[HIDDEN]ᐳ[78]"}}:::plan
    Access76{{"Access[76∈7]<br />ᐸ57.0ᐳ"}}:::plan
    Access77{{"Access[77∈7]<br />ᐸ57.1ᐳ"}}:::plan
    Access76 & Access77 --> List79
    Edge58{{"Edge[58∈7]"}}:::plan
    __Item57[/"__Item[57∈7]<br />ᐸ25ᐳ<br />More deps:<br />- ConnectionItems[25]"\]:::itemplan
    PgCursor74{{"PgCursor[74∈7]<br />More deps:<br />- Access[62]"}}:::plan
    __Item57 & PgCursor74 --> Edge58
    __Item57 --> PgCursor74
    __Item57 --> Access76
    __Item57 --> Access77
    Lambda80{{"Lambda[80∈7]<br />ᐸtoSpecifierᐳ"}}:::plan
    List79 --> Lambda80
    Access83{{"Access[83∈7]<br />ᐸ80.idᐳ"}}:::plan
    Lambda80 -->|rejectNull| Access83
    Access82{{"Access[82∈8]<br />ᐸ80.__typenameᐳ"}}:::plan
    Lambda80 -->|rejectNull| Access82
    PgSelect84[["PgSelect[84∈10]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳFirstPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access83 --> PgSelect84
    First88{{"First[88∈10]^"}}:::plan
    PgSelectRows89[["PgSelectRows[89∈10]^"]]:::plan
    PgSelectRows89 --> First88
    PgSelect84 --> PgSelectRows89
    PgSelectSingle90{{"PgSelectSingle[90∈10]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First88 --> PgSelectSingle90
    PgClassExpression99{{"PgClassExpression[99∈10]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression99
    PgClassExpression101{{"PgClassExpression[101∈10]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression99 o--o PgClassExpression101
    PgClassExpression103{{"PgClassExpression[103∈10]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression101 o--o PgClassExpression103
    PgSelect92[["PgSelect[92∈11]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳThirdPartyVulnerability<br />More deps:<br />- Object[13]"]]:::plan
    Access83 --> PgSelect92
    First96{{"First[96∈11]^"}}:::plan
    PgSelectRows97[["PgSelectRows[97∈11]^"]]:::plan
    PgSelectRows97 --> First96
    PgSelect92 --> PgSelectRows97
    PgSelectSingle98{{"PgSelectSingle[98∈11]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First96 --> PgSelectSingle98
    PgClassExpression100{{"PgClassExpression[100∈11]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle98 --> PgClassExpression100
    PgClassExpression102{{"PgClassExpression[102∈11]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression100 o--o PgClassExpression102
    PgClassExpression104{{"PgClassExpression[104∈11]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression102 o--o PgClassExpression104
    PgClassExpression105{{"PgClassExpression[105∈11]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgClassExpression104 o--o PgClassExpression105

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,PgUnionAll10,Access11,Access12,Object13,Connection14,Lambda15,PgUnionAll19,ConnectionItems25,PgUnionAll28,First29,First61,Access62,Last66,Access106,Access107 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PageInfo33,Access70,Access72 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item23,Access34,Access35,List37,Lambda38,Access40,Access41 bucket2
    classDef bucket4 stroke:#0000ff
    class Bucket4 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgSelect42,First46,PgSelectRows47,PgSelectSingle48,PgClassExpression59,PgClassExpression64,PgClassExpression68 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect50,First54,PgSelectRows55,PgSelectSingle56,PgClassExpression60,PgClassExpression65,PgClassExpression69,PgClassExpression71 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item57,Edge58,PgCursor74,Access76,Access77,List79,Lambda80,Access83 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,Access82 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgSelect84,First88,PgSelectRows89,PgSelectSingle90,PgClassExpression99,PgClassExpression101,PgClassExpression103 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgSelect92,First96,PgSelectRows97,PgSelectSingle98,PgClassExpression100,PgClassExpression102,PgClassExpression104,PgClassExpression105 bucket11

