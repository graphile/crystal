%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object15{{"Object[15∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access14{{"Access[14∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access13 & Access14 --> Object15
    __Flag49[["__Flag[49∈0] ➊<br />ᐸ48, if(44), rejectNull, onReject: Error: Invali…ᐳ"]]:::plan
    __Flag48[["__Flag[48∈0] ➊<br />ᐸ47, trapInhibited, onReject: INHIBITᐳ"]]:::plan
    Condition44{{"Condition[44∈0] ➊<br />ᐸexistsᐳ"}}:::plan
    __Flag48 & Condition44 --> __Flag49
    __Flag80[["__Flag[80∈0] ➊<br />ᐸ79, if(75), rejectNull, onReject: Error: Invali…ᐳ"]]:::plan
    __Flag79[["__Flag[79∈0] ➊<br />ᐸ78, trapInhibited, onReject: INHIBITᐳ"]]:::plan
    Condition75{{"Condition[75∈0] ➊<br />ᐸexistsᐳ"}}:::plan
    __Flag79 & Condition75 --> __Flag80
    __Flag112[["__Flag[112∈0] ➊<br />ᐸ111, if(107), rejectNull, onReject: Error: Invali…ᐳ"]]:::plan
    __Flag111[["__Flag[111∈0] ➊<br />ᐸ110, trapInhibited, onReject: INHIBITᐳ"]]:::plan
    Condition107{{"Condition[107∈0] ➊<br />ᐸexistsᐳ"}}:::plan
    __Flag111 & Condition107 --> __Flag112
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access13
    __Value2 --> Access14
    Lambda17{{"Lambda[17∈0] ➊<br />ᐸextractList_grafast_pgSelectApplyᐳ"}}:::plan
    Constant136{{"Constant[136∈0] ➊<br />ᐸ[ 'PRIMARY_KEY_ASC' ]ᐳ"}}:::plan
    Constant136 --> Lambda17
    Access38{{"Access[38∈0] ➊<br />ᐸ0.aliceᐳ"}}:::plan
    __Value0["__Value[0∈0] ➊<br />ᐸvariableValuesᐳ"]:::plan
    __Value0 --> Access38
    Access38 --> Condition44
    Lambda45{{"Lambda[45∈0] ➊<br />ᐸspecifier_Person_base64JSONᐳ"}}:::plan
    Access38 --> Lambda45
    Access46{{"Access[46∈0] ➊<br />ᐸ45.1ᐳ"}}:::plan
    Lambda45 --> Access46
    __Flag47[["__Flag[47∈0] ➊<br />ᐸ46, rejectNull, onReject: INHIBITᐳ"]]:::plan
    Access46 --> __Flag47
    __Flag47 --> __Flag48
    Constant134{{"Constant[134∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant134 --> Condition75
    Lambda76{{"Lambda[76∈0] ➊<br />ᐸspecifier_Person_base64JSONᐳ"}}:::plan
    Constant134 --> Lambda76
    Access77{{"Access[77∈0] ➊<br />ᐸ76.1ᐳ"}}:::plan
    Lambda76 --> Access77
    __Flag78[["__Flag[78∈0] ➊<br />ᐸ77, rejectNull, onReject: INHIBITᐳ"]]:::plan
    Access77 --> __Flag78
    __Flag78 --> __Flag79
    Access101{{"Access[101∈0] ➊<br />ᐸ0.post3ᐳ"}}:::plan
    __Value0 --> Access101
    Access101 --> Condition107
    Lambda108{{"Lambda[108∈0] ➊<br />ᐸspecifier_Person_base64JSONᐳ"}}:::plan
    Access101 --> Lambda108
    Access109{{"Access[109∈0] ➊<br />ᐸ108.1ᐳ"}}:::plan
    Lambda108 --> Access109
    __Flag110[["__Flag[110∈0] ➊<br />ᐸ109, rejectNull, onReject: INHIBITᐳ"]]:::plan
    Access109 --> __Flag110
    __Flag110 --> __Flag111
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Connection16{{"Connection[16∈0] ➊<br />ᐸ12ᐳ"}}:::plan
    Constant30{{"Constant[30∈0] ➊<br />ᐸ'people'ᐳ"}}:::plan
    Connection42{{"Connection[42∈0] ➊<br />ᐸ40ᐳ"}}:::plan
    Connection73{{"Connection[73∈0] ➊<br />ᐸ71ᐳ"}}:::plan
    Connection105{{"Connection[105∈0] ➊<br />ᐸ103ᐳ"}}:::plan
    PgSelect18[["PgSelect[18∈1] ➊<br />ᐸpostᐳ"]]:::plan
    Object15 & Lambda17 & Connection16 --> PgSelect18
    PgSelectRows19[["PgSelectRows[19∈1] ➊"]]:::plan
    PgSelect18 --> PgSelectRows19
    __Item20[/"__Item[20∈2]<br />ᐸ19ᐳ"\]:::itemplan
    PgSelectRows19 ==> __Item20
    PgSelectSingle21{{"PgSelectSingle[21∈2]<br />ᐸpostᐳ"}}:::plan
    __Item20 --> PgSelectSingle21
    PgSelect23[["PgSelect[23∈3]<br />ᐸpersonᐳ"]]:::plan
    PgClassExpression22{{"PgClassExpression[22∈3]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    Object15 & PgClassExpression22 --> PgSelect23
    PgSelectSingle21 --> PgClassExpression22
    First27{{"First[27∈3]"}}:::plan
    PgSelectRows28[["PgSelectRows[28∈3]"]]:::plan
    PgSelectRows28 --> First27
    PgSelect23 --> PgSelectRows28
    PgSelectSingle29{{"PgSelectSingle[29∈3]<br />ᐸpersonᐳ"}}:::plan
    First27 --> PgSelectSingle29
    PgClassExpression34{{"PgClassExpression[34∈3]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle21 --> PgClassExpression34
    List32{{"List[32∈4]<br />ᐸ30,31ᐳ"}}:::plan
    PgClassExpression31{{"PgClassExpression[31∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant30 & PgClassExpression31 --> List32
    PgSelectSingle29 --> PgClassExpression31
    Lambda33{{"Lambda[33∈4]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List32 --> Lambda33
    PgSelect50[["PgSelect[50∈5] ➊<br />ᐸpostᐳ"]]:::plan
    Object15 & Lambda17 & __Flag49 & Connection42 --> PgSelect50
    PgSelectRows51[["PgSelectRows[51∈5] ➊"]]:::plan
    PgSelect50 --> PgSelectRows51
    __Item52[/"__Item[52∈6]<br />ᐸ51ᐳ"\]:::itemplan
    PgSelectRows51 ==> __Item52
    PgSelectSingle53{{"PgSelectSingle[53∈6]<br />ᐸpostᐳ"}}:::plan
    __Item52 --> PgSelectSingle53
    PgSelect55[["PgSelect[55∈7]<br />ᐸpersonᐳ"]]:::plan
    PgClassExpression54{{"PgClassExpression[54∈7]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    Object15 & PgClassExpression54 --> PgSelect55
    PgSelectSingle53 --> PgClassExpression54
    First59{{"First[59∈7]"}}:::plan
    PgSelectRows60[["PgSelectRows[60∈7]"]]:::plan
    PgSelectRows60 --> First59
    PgSelect55 --> PgSelectRows60
    PgSelectSingle61{{"PgSelectSingle[61∈7]<br />ᐸpersonᐳ"}}:::plan
    First59 --> PgSelectSingle61
    PgClassExpression66{{"PgClassExpression[66∈7]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle53 --> PgClassExpression66
    List64{{"List[64∈8]<br />ᐸ30,63ᐳ"}}:::plan
    PgClassExpression63{{"PgClassExpression[63∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant30 & PgClassExpression63 --> List64
    PgSelectSingle61 --> PgClassExpression63
    Lambda65{{"Lambda[65∈8]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List64 --> Lambda65
    PgSelect81[["PgSelect[81∈9] ➊<br />ᐸpostᐳ"]]:::plan
    Object15 & Lambda17 & __Flag80 & Connection73 --> PgSelect81
    PgSelectRows82[["PgSelectRows[82∈9] ➊"]]:::plan
    PgSelect81 --> PgSelectRows82
    __Item83[/"__Item[83∈10]<br />ᐸ82ᐳ"\]:::itemplan
    PgSelectRows82 ==> __Item83
    PgSelectSingle84{{"PgSelectSingle[84∈10]<br />ᐸpostᐳ"}}:::plan
    __Item83 --> PgSelectSingle84
    PgSelect86[["PgSelect[86∈11]<br />ᐸpersonᐳ"]]:::plan
    PgClassExpression85{{"PgClassExpression[85∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    Object15 & PgClassExpression85 --> PgSelect86
    PgSelectSingle84 --> PgClassExpression85
    First90{{"First[90∈11]"}}:::plan
    PgSelectRows91[["PgSelectRows[91∈11]"]]:::plan
    PgSelectRows91 --> First90
    PgSelect86 --> PgSelectRows91
    PgSelectSingle92{{"PgSelectSingle[92∈11]<br />ᐸpersonᐳ"}}:::plan
    First90 --> PgSelectSingle92
    PgClassExpression97{{"PgClassExpression[97∈11]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle84 --> PgClassExpression97
    List95{{"List[95∈12]<br />ᐸ30,94ᐳ"}}:::plan
    PgClassExpression94{{"PgClassExpression[94∈12]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant30 & PgClassExpression94 --> List95
    PgSelectSingle92 --> PgClassExpression94
    Lambda96{{"Lambda[96∈12]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List95 --> Lambda96
    PgSelect113[["PgSelect[113∈13] ➊<br />ᐸpostᐳ"]]:::plan
    Object15 & Lambda17 & __Flag112 & Connection105 --> PgSelect113
    PgSelectRows114[["PgSelectRows[114∈13] ➊"]]:::plan
    PgSelect113 --> PgSelectRows114
    __Item115[/"__Item[115∈14]<br />ᐸ114ᐳ"\]:::itemplan
    PgSelectRows114 ==> __Item115
    PgSelectSingle116{{"PgSelectSingle[116∈14]<br />ᐸpostᐳ"}}:::plan
    __Item115 --> PgSelectSingle116
    PgSelect118[["PgSelect[118∈15]<br />ᐸpersonᐳ"]]:::plan
    PgClassExpression117{{"PgClassExpression[117∈15]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    Object15 & PgClassExpression117 --> PgSelect118
    PgSelectSingle116 --> PgClassExpression117
    First122{{"First[122∈15]"}}:::plan
    PgSelectRows123[["PgSelectRows[123∈15]"]]:::plan
    PgSelectRows123 --> First122
    PgSelect118 --> PgSelectRows123
    PgSelectSingle124{{"PgSelectSingle[124∈15]<br />ᐸpersonᐳ"}}:::plan
    First122 --> PgSelectSingle124
    PgClassExpression129{{"PgClassExpression[129∈15]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle116 --> PgClassExpression129
    List127{{"List[127∈16]<br />ᐸ30,126ᐳ"}}:::plan
    PgClassExpression126{{"PgClassExpression[126∈16]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant30 & PgClassExpression126 --> List127
    PgSelectSingle124 --> PgClassExpression126
    Lambda128{{"Lambda[128∈16]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List127 --> Lambda128

    %% define steps

    subgraph "Buckets for queries/relay/conditionNodeId"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 13, 14, 16, 30, 38, 42, 73, 101, 105, 134, 136, 15, 17, 44, 45, 46, 75, 76, 77, 107, 108, 109<br />2: __Flag[47], __Flag[78], __Flag[110]<br />3: __Flag[48], __Flag[79], __Flag[111]<br />4: __Flag[49], __Flag[80], __Flag[112]"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value2,__Value4,Access13,Access14,Object15,Connection16,Lambda17,Constant30,Access38,Connection42,Condition44,Lambda45,Access46,__Flag47,__Flag48,__Flag49,Connection73,Condition75,Lambda76,Access77,__Flag78,__Flag79,__Flag80,Access101,Connection105,Condition107,Lambda108,Access109,__Flag110,__Flag111,__Flag112,Constant134,Constant136 bucket0
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 15, 17, 16, 30<br /><br />ROOT Connectionᐸ12ᐳ[16]<br />1: PgSelect[18]<br />2: PgSelectRows[19]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect18,PgSelectRows19 bucket1
    Bucket2("Bucket 2 (listItem)<br />Deps: 15, 30<br /><br />ROOT __Item{2}ᐸ19ᐳ[20]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item20,PgSelectSingle21 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 21, 15, 30<br /><br />ROOT PgSelectSingle{2}ᐸpostᐳ[21]<br />1: <br />ᐳ: 22, 34<br />2: PgSelect[23]<br />3: PgSelectRows[28]<br />ᐳ: First[27], PgSelectSingle[29]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression22,PgSelect23,First27,PgSelectRows28,PgSelectSingle29,PgClassExpression34 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 29, 30<br /><br />ROOT PgSelectSingle{3}ᐸpersonᐳ[29]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression31,List32,Lambda33 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 15, 17, 49, 42, 30<br /><br />ROOT Connectionᐸ40ᐳ[42]<br />1: PgSelect[50]<br />2: PgSelectRows[51]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgSelect50,PgSelectRows51 bucket5
    Bucket6("Bucket 6 (listItem)<br />Deps: 15, 30<br /><br />ROOT __Item{6}ᐸ51ᐳ[52]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item52,PgSelectSingle53 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 53, 15, 30<br /><br />ROOT PgSelectSingle{6}ᐸpostᐳ[53]<br />1: <br />ᐳ: 54, 66<br />2: PgSelect[55]<br />3: PgSelectRows[60]<br />ᐳ: First[59], PgSelectSingle[61]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression54,PgSelect55,First59,PgSelectRows60,PgSelectSingle61,PgClassExpression66 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 61, 30<br /><br />ROOT PgSelectSingle{7}ᐸpersonᐳ[61]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression63,List64,Lambda65 bucket8
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 15, 17, 80, 73, 30<br /><br />ROOT Connectionᐸ71ᐳ[73]<br />1: PgSelect[81]<br />2: PgSelectRows[82]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgSelect81,PgSelectRows82 bucket9
    Bucket10("Bucket 10 (listItem)<br />Deps: 15, 30<br /><br />ROOT __Item{10}ᐸ82ᐳ[83]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item83,PgSelectSingle84 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 84, 15, 30<br /><br />ROOT PgSelectSingle{10}ᐸpostᐳ[84]<br />1: <br />ᐳ: 85, 97<br />2: PgSelect[86]<br />3: PgSelectRows[91]<br />ᐳ: First[90], PgSelectSingle[92]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgClassExpression85,PgSelect86,First90,PgSelectRows91,PgSelectSingle92,PgClassExpression97 bucket11
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 92, 30<br /><br />ROOT PgSelectSingle{11}ᐸpersonᐳ[92]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgClassExpression94,List95,Lambda96 bucket12
    Bucket13("Bucket 13 (nullableBoundary)<br />Deps: 15, 17, 112, 105, 30<br /><br />ROOT Connectionᐸ103ᐳ[105]<br />1: PgSelect[113]<br />2: PgSelectRows[114]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgSelect113,PgSelectRows114 bucket13
    Bucket14("Bucket 14 (listItem)<br />Deps: 15, 30<br /><br />ROOT __Item{14}ᐸ114ᐳ[115]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14,__Item115,PgSelectSingle116 bucket14
    Bucket15("Bucket 15 (nullableBoundary)<br />Deps: 116, 15, 30<br /><br />ROOT PgSelectSingle{14}ᐸpostᐳ[116]<br />1: <br />ᐳ: 117, 129<br />2: PgSelect[118]<br />3: PgSelectRows[123]<br />ᐳ: First[122], PgSelectSingle[124]"):::bucket
    classDef bucket15 stroke:#ff00ff
    class Bucket15,PgClassExpression117,PgSelect118,First122,PgSelectRows123,PgSelectSingle124,PgClassExpression129 bucket15
    Bucket16("Bucket 16 (nullableBoundary)<br />Deps: 124, 30<br /><br />ROOT PgSelectSingle{15}ᐸpersonᐳ[124]"):::bucket
    classDef bucket16 stroke:#f5deb3
    class Bucket16,PgClassExpression126,List127,Lambda128 bucket16
    Bucket0 --> Bucket1 & Bucket5 & Bucket9 & Bucket13
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket5 --> Bucket6
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket9 --> Bucket10
    Bucket10 --> Bucket11
    Bucket11 --> Bucket12
    Bucket13 --> Bucket14
    Bucket14 --> Bucket15
    Bucket15 --> Bucket16
    end
