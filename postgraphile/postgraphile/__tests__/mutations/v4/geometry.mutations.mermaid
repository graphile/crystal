%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object85{{"Object[85∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access83{{"Access[83∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access84{{"Access[84∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access83 & Access84 --> Object85
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access83
    __Value2 --> Access84
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant183{{"Constant[183∈0] ➊<br />ᐸ§{ x: 99, y: 1234 }ᐳ"}}:::plan
    Constant196{{"Constant[196∈0] ➊<br />ᐸ§{ a: §{ x: 25, y: 200 }, b: §{ x: 0, y: 100 } }ᐳ"}}:::plan
    Constant197{{"Constant[197∈0] ➊<br />ᐸ§{ a: §{ x: 99, y: 111 }, b: §{ x: 2935, y: 3548 } }ᐳ"}}:::plan
    Constant198{{"Constant[198∈0] ➊<br />ᐸ§{ a: §{ x: 123, y: 52635 }, b: §{ x: 2342, y: 12445 } }ᐳ"}}:::plan
    Constant200{{"Constant[200∈0] ➊<br />ᐸ§{ center: §{ x: 7, y: 11 }, radius: 3 }ᐳ"}}:::plan
    Constant201{{"Constant[201∈0] ➊<br />ᐸ§{ points: [ §{ x: 0, y: 0 }, §{ x: 0, y: 10 }, §{ x: 10, y:ᐳ"}}:::plan
    Constant202{{"Constant[202∈0] ➊<br />ᐸ§{ points: [ §{ x: 0, y: 0 }, §{ x: 0, y: 10 }, §{ x: 10, y:ᐳ"}}:::plan
    Constant203{{"Constant[203∈0] ➊<br />ᐸ§{ points: [ §{ x: 0, y: 0 }, §{ x: 0, y: 10 }, §{ x: 10, y:ᐳ"}}:::plan
    PgInsertSingle82[["PgInsertSingle[82∈1] ➊<br />ᐸgeom(point,line,lseg,box,open_path,closed_path,polygon,circle)ᐳ"]]:::sideeffectplan
    Object85 & Constant183 & Constant196 & Constant197 & Constant198 & Constant201 & Constant202 & Constant203 & Constant200 --> PgInsertSingle82
    Object86{{"Object[86∈1] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle82 --> Object86
    PgClassExpression117{{"PgClassExpression[117∈3] ➊<br />ᐸ__geom__.”id”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression117
    PgClassExpression118{{"PgClassExpression[118∈3] ➊<br />ᐸ__geom__.”point”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression118
    PgClassExpression121{{"PgClassExpression[121∈3] ➊<br />ᐸ__geom__.”line”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression121
    PgClassExpression128{{"PgClassExpression[128∈3] ➊<br />ᐸ__geom__.”lseg”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression128
    PgClassExpression135{{"PgClassExpression[135∈3] ➊<br />ᐸ__geom__.”box”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression135
    PgClassExpression142{{"PgClassExpression[142∈3] ➊<br />ᐸ__geom__.”open_path”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression142
    PgClassExpression148{{"PgClassExpression[148∈3] ➊<br />ᐸ__geom__.”closed_path”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression148
    PgClassExpression154{{"PgClassExpression[154∈3] ➊<br />ᐸ__geom__.”polygon”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression154
    PgClassExpression159{{"PgClassExpression[159∈3] ➊<br />ᐸ__geom__.”circle”ᐳ"}}:::plan
    PgInsertSingle82 --> PgClassExpression159
    Access144{{"Access[144∈8] ➊<br />ᐸ142.pointsᐳ"}}:::plan
    PgClassExpression142 --> Access144
    __Item145[/"__Item[145∈9]<br />ᐸ144ᐳ"\]:::itemplan
    Access144 ==> __Item145
    Access150{{"Access[150∈10] ➊<br />ᐸ148.pointsᐳ"}}:::plan
    PgClassExpression148 --> Access150
    __Item151[/"__Item[151∈11]<br />ᐸ150ᐳ"\]:::itemplan
    Access150 ==> __Item151
    Access155{{"Access[155∈12] ➊<br />ᐸ154.pointsᐳ"}}:::plan
    PgClassExpression154 --> Access155
    __Item156[/"__Item[156∈13]<br />ᐸ155ᐳ"\]:::itemplan
    Access155 ==> __Item156

    %% define steps

    subgraph "Buckets for mutations/v4/geometry.mutations"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access83,Access84,Object85,Constant183,Constant196,Constant197,Constant198,Constant200,Constant201,Constant202,Constant203 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 85, 183, 196, 197, 198, 201, 202, 203, 200<br /><br />1: PgInsertSingle[82]<br />2: <br />ᐳ: Object[86]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgInsertSingle82,Object86 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 86, 82<br /><br />ROOT Object{1}ᐸ{result}ᐳ[86]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 82<br /><br />ROOT PgInsertSingle{1}ᐸgeom(point,line,lseg,box,open_path,closed_path,polygon,circle)ᐳ[82]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression117,PgClassExpression118,PgClassExpression121,PgClassExpression128,PgClassExpression135,PgClassExpression142,PgClassExpression148,PgClassExpression154,PgClassExpression159 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 118<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”point”ᐳ[118]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 121<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”line”ᐳ[121]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 128<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”lseg”ᐳ[128]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 135<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”box”ᐳ[135]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 142<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”open_path”ᐳ[142]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,Access144 bucket8
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ144ᐳ[145]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item145 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 148<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”closed_path”ᐳ[148]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,Access150 bucket10
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ150ᐳ[151]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item151 bucket11
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 154<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”polygon”ᐳ[154]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,Access155 bucket12
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ155ᐳ[156]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item156 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgClassExpression{3}ᐸ__geom__.”circle”ᐳ[159]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket10 & Bucket12 & Bucket14
    Bucket8 --> Bucket9
    Bucket10 --> Bucket11
    Bucket12 --> Bucket13
    end
