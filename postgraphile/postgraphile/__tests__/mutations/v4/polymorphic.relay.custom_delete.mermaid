%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object38{{"Object[38∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access36{{"Access[36∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access37{{"Access[37∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access36 & Access37 --> Object38
    Lambda9{{"Lambda[9∈0] ➊<br />ᐸdecodeNodeIdWithCodecsᐳ"}}:::plan
    Constant116{{"Constant[116∈0] ➊<br />ᐸ'WyJyZWxhdGlvbmFsX3RvcGljcyIsMV0='ᐳ"}}:::plan
    Constant116 --> Lambda9
    List14{{"List[14∈0] ➊<br />ᐸ115ᐳ"}}:::plan
    Access115{{"Access[115∈0] ➊<br />ᐸ9.base64JSON.1ᐳ"}}:::plan
    Access115 --> List14
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access36
    __Value2 --> Access37
    Lambda9 --> Access115
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant74{{"Constant[74∈0] ➊<br />ᐸ'relational_topics'ᐳ"}}:::plan
    Constant84{{"Constant[84∈0] ➊<br />ᐸ'relational_posts'ᐳ"}}:::plan
    Constant93{{"Constant[93∈0] ➊<br />ᐸ'relational_dividers'ᐳ"}}:::plan
    Constant102{{"Constant[102∈0] ➊<br />ᐸ'relational_checklists'ᐳ"}}:::plan
    Constant111{{"Constant[111∈0] ➊<br />ᐸ'relational_checklist_items'ᐳ"}}:::plan
    Constant117{{"Constant[117∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Constant120{{"Constant[120∈0] ➊<br />ᐸ[ 'PRIMARY_KEY_ASC' ]ᐳ"}}:::plan
    List32{{"List[32∈1] ➊<br />ᐸ15,19,23,27,31ᐳ"}}:::plan
    Object15{{"Object[15∈1] ➊<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object19{{"Object[19∈1] ➊<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object23{{"Object[23∈1] ➊<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object27{{"Object[27∈1] ➊<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object31{{"Object[31∈1] ➊<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object15 & Object19 & Object23 & Object27 & Object31 --> List32
    Lambda13[["Lambda[13∈1] ➊"]]:::unbatchedplan
    Lambda13 & List14 --> Object15
    Lambda17[["Lambda[17∈1] ➊"]]:::unbatchedplan
    Lambda17 & List14 --> Object19
    Lambda21[["Lambda[21∈1] ➊"]]:::unbatchedplan
    Lambda21 & List14 --> Object23
    Lambda25[["Lambda[25∈1] ➊"]]:::unbatchedplan
    Lambda25 & List14 --> Object27
    Lambda29[["Lambda[29∈1] ➊"]]:::unbatchedplan
    Lambda29 & List14 --> Object31
    PgSelect35[["PgSelect[35∈1] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    Access34{{"Access[34∈1] ➊<br />ᐸ33.0ᐳ"}}:::plan
    Object38 & Access34 --> PgSelect35
    PgSelect43[["PgSelect[43∈1] ➊<br />ᐸcustom_delete_relational_item(mutation)ᐳ"]]:::sideeffectplan
    PgClassExpression42{{"PgClassExpression[42∈1] ➊<br />ᐸ__relational_items__ᐳ"}}:::plan
    Object38 & PgClassExpression42 --> PgSelect43
    Lambda9 --> Lambda13
    Lambda9 --> Lambda17
    Lambda9 --> Lambda21
    Lambda9 --> Lambda25
    Lambda9 --> Lambda29
    Lambda33{{"Lambda[33∈1] ➊"}}:::plan
    List32 --> Lambda33
    Lambda33 --> Access34
    First39{{"First[39∈1] ➊"}}:::plan
    PgSelectRows40[["PgSelectRows[40∈1] ➊"]]:::plan
    PgSelectRows40 --> First39
    PgSelect35 --> PgSelectRows40
    PgSelectSingle41{{"PgSelectSingle[41∈1] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First39 --> PgSelectSingle41
    PgSelectSingle41 --> PgClassExpression42
    First47{{"First[47∈1] ➊"}}:::plan
    PgSelectRows48[["PgSelectRows[48∈1] ➊"]]:::plan
    PgSelectRows48 --> First47
    PgSelect43 --> PgSelectRows48
    PgSelectSingle49{{"PgSelectSingle[49∈1] ➊<br />ᐸcustom_delete_relational_itemᐳ"}}:::plan
    First47 --> PgSelectSingle49
    PgClassExpression50{{"PgClassExpression[50∈1] ➊<br />ᐸ__custom_d...l_item__.vᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression50
    Object51{{"Object[51∈1] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression50 --> Object51
    Connection60{{"Connection[60∈2] ➊<br />ᐸ56ᐳ"}}:::plan
    Constant117 --> Connection60
    Lambda61{{"Lambda[61∈2] ➊<br />ᐸextractList_grafast_pgSelectApplyᐳ"}}:::plan
    Constant120 --> Lambda61
    PgSelect62[["PgSelect[62∈4] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    Object38 & Lambda61 & Connection60 & Constant117 --> PgSelect62
    PgSelectRows63[["PgSelectRows[63∈4] ➊"]]:::plan
    PgSelect62 --> PgSelectRows63
    __Item64[/"__Item[64∈5]<br />ᐸ63ᐳ"\]:::itemplan
    PgSelectRows63 ==> __Item64
    PgSelectSingle65{{"PgSelectSingle[65∈5]<br />ᐸrelational_itemsᐳ"}}:::plan
    __Item64 --> PgSelectSingle65
    PgClassExpression66{{"PgClassExpression[66∈5]<br />ᐸ__relation...ems__.”id”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression66
    PgClassExpression78{{"PgClassExpression[78∈5]<br />ᐸ__relation...s__.”type”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression78
    PgSelect67[["PgSelect[67∈6]<br />ᐸrelational_topicsᐳ<br />ᐳRelationalTopic"]]:::plan
    Object38 & PgClassExpression66 --> PgSelect67
    List76{{"List[76∈6]<br />ᐸ74,75ᐳ<br />ᐳRelationalTopic"}}:::plan
    PgClassExpression75{{"PgClassExpression[75∈6]<br />ᐸ__relation...c_item_id”ᐳ"}}:::plan
    Constant74 & PgClassExpression75 --> List76
    PgSelect79[["PgSelect[79∈6]<br />ᐸrelational_postsᐳ<br />ᐳRelationalPost"]]:::plan
    Object38 & PgClassExpression66 --> PgSelect79
    List86{{"List[86∈6]<br />ᐸ84,85ᐳ<br />ᐳRelationalPost"}}:::plan
    PgClassExpression85{{"PgClassExpression[85∈6]<br />ᐸ__relation...t_item_id”ᐳ"}}:::plan
    Constant84 & PgClassExpression85 --> List86
    PgSelect88[["PgSelect[88∈6]<br />ᐸrelational_dividersᐳ<br />ᐳRelationalDivider"]]:::plan
    Object38 & PgClassExpression66 --> PgSelect88
    List95{{"List[95∈6]<br />ᐸ93,94ᐳ<br />ᐳRelationalDivider"}}:::plan
    PgClassExpression94{{"PgClassExpression[94∈6]<br />ᐸ__relation...r_item_id”ᐳ"}}:::plan
    Constant93 & PgClassExpression94 --> List95
    PgSelect97[["PgSelect[97∈6]<br />ᐸrelational_checklistsᐳ<br />ᐳRelationalChecklist"]]:::plan
    Object38 & PgClassExpression66 --> PgSelect97
    List104{{"List[104∈6]<br />ᐸ102,103ᐳ<br />ᐳRelationalChecklist"}}:::plan
    PgClassExpression103{{"PgClassExpression[103∈6]<br />ᐸ__relation...t_item_id”ᐳ"}}:::plan
    Constant102 & PgClassExpression103 --> List104
    PgSelect106[["PgSelect[106∈6]<br />ᐸrelational_checklist_itemsᐳ<br />ᐳRelationalChecklistItem"]]:::plan
    Object38 & PgClassExpression66 --> PgSelect106
    List113{{"List[113∈6]<br />ᐸ111,112ᐳ<br />ᐳRelationalChecklistItem"}}:::plan
    PgClassExpression112{{"PgClassExpression[112∈6]<br />ᐸ__relation...m_item_id”ᐳ"}}:::plan
    Constant111 & PgClassExpression112 --> List113
    First71{{"First[71∈6]"}}:::plan
    PgSelectRows72[["PgSelectRows[72∈6]"]]:::plan
    PgSelectRows72 --> First71
    PgSelect67 --> PgSelectRows72
    PgSelectSingle73{{"PgSelectSingle[73∈6]<br />ᐸrelational_topicsᐳ"}}:::plan
    First71 --> PgSelectSingle73
    PgSelectSingle73 --> PgClassExpression75
    Lambda77{{"Lambda[77∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List76 --> Lambda77
    First81{{"First[81∈6]"}}:::plan
    PgSelectRows82[["PgSelectRows[82∈6]"]]:::plan
    PgSelectRows82 --> First81
    PgSelect79 --> PgSelectRows82
    PgSelectSingle83{{"PgSelectSingle[83∈6]<br />ᐸrelational_postsᐳ"}}:::plan
    First81 --> PgSelectSingle83
    PgSelectSingle83 --> PgClassExpression85
    Lambda87{{"Lambda[87∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List86 --> Lambda87
    First90{{"First[90∈6]"}}:::plan
    PgSelectRows91[["PgSelectRows[91∈6]"]]:::plan
    PgSelectRows91 --> First90
    PgSelect88 --> PgSelectRows91
    PgSelectSingle92{{"PgSelectSingle[92∈6]<br />ᐸrelational_dividersᐳ"}}:::plan
    First90 --> PgSelectSingle92
    PgSelectSingle92 --> PgClassExpression94
    Lambda96{{"Lambda[96∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List95 --> Lambda96
    First99{{"First[99∈6]"}}:::plan
    PgSelectRows100[["PgSelectRows[100∈6]"]]:::plan
    PgSelectRows100 --> First99
    PgSelect97 --> PgSelectRows100
    PgSelectSingle101{{"PgSelectSingle[101∈6]<br />ᐸrelational_checklistsᐳ"}}:::plan
    First99 --> PgSelectSingle101
    PgSelectSingle101 --> PgClassExpression103
    Lambda105{{"Lambda[105∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List104 --> Lambda105
    First108{{"First[108∈6]"}}:::plan
    PgSelectRows109[["PgSelectRows[109∈6]"]]:::plan
    PgSelectRows109 --> First108
    PgSelect106 --> PgSelectRows109
    PgSelectSingle110{{"PgSelectSingle[110∈6]<br />ᐸrelational_checklist_itemsᐳ"}}:::plan
    First108 --> PgSelectSingle110
    PgSelectSingle110 --> PgClassExpression112
    Lambda114{{"Lambda[114∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List113 --> Lambda114

    %% define steps

    subgraph "Buckets for mutations/v4/polymorphic.relay.custom_delete"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Lambda9,List14,Access36,Access37,Object38,Constant74,Constant84,Constant93,Constant102,Constant111,Access115,Constant116,Constant117,Constant120 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 9, 14, 38, 117, 120, 4, 74, 84, 93, 102, 111<br /><br />1: Lambda[13]<br />2: Object[15]<br />3: Lambda[17]<br />4: Object[19]<br />5: Lambda[21]<br />6: Object[23]<br />7: Lambda[25]<br />8: Object[27]<br />9: Lambda[29]<br />10: Object[31]<br />11: List[32]<br />12: Lambda[33]<br />13: Access[34]<br />14: PgSelect[35]<br />15: PgSelectRows[40]<br />16: First[39]<br />17: PgSelectSingle[41]<br />18: PgClassExpression[42]<br />19: PgSelect[43]<br />20: PgSelectRows[48]<br />ᐳ: 47, 49, 50, 51"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,Lambda13,Object15,Lambda17,Object19,Lambda21,Object23,Lambda25,Object27,Lambda29,Object31,List32,Lambda33,Access34,PgSelect35,First39,PgSelectRows40,PgSelectSingle41,PgClassExpression42,PgSelect43,First47,PgSelectRows48,PgSelectSingle49,PgClassExpression50,Object51 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 117, 120, 51, 4, 38, 74, 84, 93, 102, 111, 50<br /><br />ROOT Object{1}ᐸ{result}ᐳ[51]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,Connection60,Lambda61 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 4, 38, 61, 60, 117, 74, 84, 93, 102, 111<br /><br />ROOT __ValueᐸrootValueᐳ[4]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 38, 61, 60, 117, 74, 84, 93, 102, 111<br /><br />ROOT Connection{2}ᐸ56ᐳ[60]<br />1: PgSelect[62]<br />2: PgSelectRows[63]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect62,PgSelectRows63 bucket4
    Bucket5("Bucket 5 (listItem)<br />Deps: 38, 74, 84, 93, 102, 111<br /><br />ROOT __Item{5}ᐸ63ᐳ[64]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item64,PgSelectSingle65,PgClassExpression66,PgClassExpression78 bucket5
    Bucket6("Bucket 6 (polymorphic)<br />RelationalTopic,RelationalPost,RelationalDivider,RelationalChecklist,RelationalChecklistItem<br />Deps: 38, 66, 74, 84, 93, 102, 111, 65, 78<br />ᐳRelationalTopic<br />ᐳRelationalPost<br />ᐳRelationalDivider<br />ᐳRelationalChecklist<br />ᐳRelationalChecklistItem<br /><br />1: 67, 79, 88, 97, 106<br />2: 72, 82, 91, 100, 109<br />ᐳ: 71, 73, 75, 76, 77, 81, 83, 85, 86, 87, 90, 92, 94, 95, 96, 99, 101, 103, 104, 105, 108, 110, 112, 113, 114"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect67,First71,PgSelectRows72,PgSelectSingle73,PgClassExpression75,List76,Lambda77,PgSelect79,First81,PgSelectRows82,PgSelectSingle83,PgClassExpression85,List86,Lambda87,PgSelect88,First90,PgSelectRows91,PgSelectSingle92,PgClassExpression94,List95,Lambda96,PgSelect97,First99,PgSelectRows100,PgSelectSingle101,PgClassExpression103,List104,Lambda105,PgSelect106,First108,PgSelectRows109,PgSelectSingle110,PgClassExpression112,List113,Lambda114 bucket6
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket4 --> Bucket5
    Bucket5 --> Bucket6
    end
