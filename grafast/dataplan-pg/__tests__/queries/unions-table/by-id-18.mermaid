%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/unions-table/by-id-18"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 8, 9, 62, 135, 10<br />2: PgSelect[7], PgUnionAll[20]<br />ᐳ: 134, 22, 60, 61, 63, 64, 65, 66<br />3: PgSelectRows[12]<br />ᐳ: 11, 13, 14, 16, 17"):::bucket
    Bucket1("Bucket 1 (polymorphic)<br />__typename: Lambda[16]<br />Deps: 16, 10, 17"):::bucket
    Bucket2("Bucket 2 (polymorphic)<br />__typename: Access[65]<br />Deps: 65, 10, 66"):::bucket
    Bucket3("Bucket 3 (polymorphicPartition)<br />|UnionTopic<br />Deps: 10, 17<br />ᐳUnionTopic<br /><br />1: PgSelect[25]<br />2: PgSelectRows[30]<br />ᐳ: 29, 31, 106, 107"):::bucket
    Bucket4("Bucket 4 (polymorphicPartition)<br />|UnionPost<br />Deps: 10, 17<br />ᐳUnionPost<br /><br />1: PgSelect[32]<br />2: PgSelectRows[37]<br />ᐳ: 36, 38, 108, 109, 110, 111"):::bucket
    Bucket5("Bucket 5 (polymorphicPartition)<br />|UnionDivider<br />Deps: 10, 17<br />ᐳUnionDivider<br /><br />1: PgSelect[39]<br />2: PgSelectRows[44]<br />ᐳ: 43, 45, 112, 113, 114"):::bucket
    Bucket6("Bucket 6 (polymorphicPartition)<br />|UnionChecklist<br />Deps: 10, 17<br />ᐳUnionChecklist<br /><br />1: PgSelect[46]<br />2: PgSelectRows[51]<br />ᐳ: 50, 52, 115, 116"):::bucket
    Bucket7("Bucket 7 (polymorphicPartition)<br />|UnionChecklistItem<br />Deps: 10, 17<br />ᐳUnionChecklistItem<br /><br />1: PgSelect[53]<br />2: PgSelectRows[58]<br />ᐳ: 57, 59, 117, 118, 119"):::bucket
    Bucket8("Bucket 8 (polymorphicPartition)<br />|UnionTopic<br />Deps: 10, 66<br />ᐳUnionTopic<br /><br />1: PgSelect[67]<br />2: PgSelectRows[72]<br />ᐳ: 71, 73, 120, 121"):::bucket
    Bucket9("Bucket 9 (polymorphicPartition)<br />|UnionPost<br />Deps: 10, 66<br />ᐳUnionPost<br /><br />1: PgSelect[75]<br />2: PgSelectRows[80]<br />ᐳ: 79, 81, 122, 123, 124, 125"):::bucket
    Bucket10("Bucket 10 (polymorphicPartition)<br />|UnionDivider<br />Deps: 10, 66<br />ᐳUnionDivider<br /><br />1: PgSelect[83]<br />2: PgSelectRows[88]<br />ᐳ: 87, 89, 126, 127, 128"):::bucket
    Bucket11("Bucket 11 (polymorphicPartition)<br />|UnionChecklist<br />Deps: 10, 66<br />ᐳUnionChecklist<br /><br />1: PgSelect[91]<br />2: PgSelectRows[96]<br />ᐳ: 95, 97, 129, 130"):::bucket
    Bucket12("Bucket 12 (polymorphicPartition)<br />|UnionChecklistItem<br />Deps: 10, 66<br />ᐳUnionChecklistItem<br /><br />1: PgSelect[99]<br />2: PgSelectRows[104]<br />ᐳ: 103, 105, 131, 132, 133"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2
    Bucket1 --> Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7
    Bucket2 --> Bucket8 & Bucket9 & Bucket10 & Bucket11 & Bucket12

    %% plan dependencies
    List63{{"List[63∈0] ➊<br />ᐸ60,61,62ᐳ"}}:::plan
    Access60{{"Access[60∈0] ➊<br />ᐸ22.0ᐳ"}}:::plan
    Access61{{"Access[61∈0] ➊<br />ᐸ22.1ᐳ"}}:::plan
    Constant62{{"Constant[62∈0] ➊<br />ᐸ[HIDDEN]ᐳ"}}:::plan
    Access60 & Access61 & Constant62 --> List63
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸunion_itemsᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant135{{"Constant[135∈0] ➊<br />ᐸ18ᐳ"}}:::plan
    Object10 & Constant135 --> PgSelect7
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    PgUnionAll20[["PgUnionAll[20∈0] ➊<br />ᐸUnionTopic,UnionPost,UnionDivider,UnionChecklist,UnionChecklistItemᐳ"]]:::plan
    Object10 & Constant135 --> PgUnionAll20
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    First11{{"First[11∈0] ➊"}}:::plan
    PgSelectRows12[["PgSelectRows[12∈0] ➊"]]:::plan
    PgSelectRows12 --> First11
    PgSelect7 --> PgSelectRows12
    PgSelectSingle13{{"PgSelectSingle[13∈0] ➊<br />ᐸunion_itemsᐳ"}}:::plan
    First11 --> PgSelectSingle13
    PgClassExpression14{{"PgClassExpression[14∈0] ➊<br />ᐸ__union_items__.”type”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression14
    Lambda16{{"Lambda[16∈0] ➊<br />ᐸunionItemTypeNameFromTypeᐳ"}}:::plan
    PgClassExpression14 -->|rejectNull| Lambda16
    PgClassExpression17{{"PgClassExpression[17∈0] ➊<br />ᐸ__union_items__.”id”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression17
    First22{{"First[22∈0] ➊"}}:::plan
    Access134{{"Access[134∈0] ➊<br />ᐸ20.itemsᐳ"}}:::plan
    Access134 --> First22
    First22 --> Access60
    First22 --> Access61
    Lambda64{{"Lambda[64∈0] ➊<br />ᐸtoSpecifierᐳ"}}:::plan
    List63 --> Lambda64
    Access65{{"Access[65∈0] ➊<br />ᐸ64.__typenameᐳ"}}:::plan
    Lambda64 --> Access65
    Access66{{"Access[66∈0] ➊<br />ᐸ64.idᐳ"}}:::plan
    Lambda64 --> Access66
    PgUnionAll20 --> Access134
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    PgSelect25[["PgSelect[25∈3] ➊<br />ᐸunion_topicsᐳ<br />ᐳUnionTopic"]]:::plan
    Object10 & PgClassExpression17 --> PgSelect25
    First29{{"First[29∈3] ➊^"}}:::plan
    PgSelectRows30[["PgSelectRows[30∈3] ➊^"]]:::plan
    PgSelectRows30 --> First29
    PgSelect25 --> PgSelectRows30
    PgSelectSingle31{{"PgSelectSingle[31∈3] ➊^<br />ᐸunion_topicsᐳ"}}:::plan
    First29 --> PgSelectSingle31
    PgClassExpression106{{"PgClassExpression[106∈3] ➊^<br />ᐸ__union_topics__.”id”ᐳ"}}:::plan
    PgSelectSingle31 --> PgClassExpression106
    PgClassExpression107{{"PgClassExpression[107∈3] ➊^<br />ᐸ__union_to...__.”title”ᐳ"}}:::plan
    PgSelectSingle31 --> PgClassExpression107
    PgSelect32[["PgSelect[32∈4] ➊<br />ᐸunion_postsᐳ<br />ᐳUnionPost"]]:::plan
    Object10 & PgClassExpression17 --> PgSelect32
    First36{{"First[36∈4] ➊^"}}:::plan
    PgSelectRows37[["PgSelectRows[37∈4] ➊^"]]:::plan
    PgSelectRows37 --> First36
    PgSelect32 --> PgSelectRows37
    PgSelectSingle38{{"PgSelectSingle[38∈4] ➊^<br />ᐸunion_postsᐳ"}}:::plan
    First36 --> PgSelectSingle38
    PgClassExpression108{{"PgClassExpression[108∈4] ➊^<br />ᐸ__union_posts__.”id”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression108
    PgClassExpression109{{"PgClassExpression[109∈4] ➊^<br />ᐸ__union_posts__.”title”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression109
    PgClassExpression110{{"PgClassExpression[110∈4] ➊^<br />ᐸ__union_po...scription”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression110
    PgClassExpression111{{"PgClassExpression[111∈4] ➊^<br />ᐸ__union_posts__.”note”ᐳ"}}:::plan
    PgSelectSingle38 --> PgClassExpression111
    PgSelect39[["PgSelect[39∈5] ➊<br />ᐸunion_dividersᐳ<br />ᐳUnionDivider"]]:::plan
    Object10 & PgClassExpression17 --> PgSelect39
    First43{{"First[43∈5] ➊^"}}:::plan
    PgSelectRows44[["PgSelectRows[44∈5] ➊^"]]:::plan
    PgSelectRows44 --> First43
    PgSelect39 --> PgSelectRows44
    PgSelectSingle45{{"PgSelectSingle[45∈5] ➊^<br />ᐸunion_dividersᐳ"}}:::plan
    First43 --> PgSelectSingle45
    PgClassExpression112{{"PgClassExpression[112∈5] ➊^<br />ᐸ__union_dividers__.”id”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression112
    PgClassExpression113{{"PgClassExpression[113∈5] ➊^<br />ᐸ__union_di...__.”title”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression113
    PgClassExpression114{{"PgClassExpression[114∈5] ➊^<br />ᐸ__union_di...__.”color”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression114
    PgSelect46[["PgSelect[46∈6] ➊<br />ᐸunion_checklistsᐳ<br />ᐳUnionChecklist"]]:::plan
    Object10 & PgClassExpression17 --> PgSelect46
    First50{{"First[50∈6] ➊^"}}:::plan
    PgSelectRows51[["PgSelectRows[51∈6] ➊^"]]:::plan
    PgSelectRows51 --> First50
    PgSelect46 --> PgSelectRows51
    PgSelectSingle52{{"PgSelectSingle[52∈6] ➊^<br />ᐸunion_checklistsᐳ"}}:::plan
    First50 --> PgSelectSingle52
    PgClassExpression115{{"PgClassExpression[115∈6] ➊^<br />ᐸ__union_ch...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle52 --> PgClassExpression115
    PgClassExpression116{{"PgClassExpression[116∈6] ➊^<br />ᐸ__union_ch...__.”title”ᐳ"}}:::plan
    PgSelectSingle52 --> PgClassExpression116
    PgSelect53[["PgSelect[53∈7] ➊<br />ᐸunion_checklist_itemsᐳ<br />ᐳUnionChecklistItem"]]:::plan
    Object10 & PgClassExpression17 --> PgSelect53
    First57{{"First[57∈7] ➊^"}}:::plan
    PgSelectRows58[["PgSelectRows[58∈7] ➊^"]]:::plan
    PgSelectRows58 --> First57
    PgSelect53 --> PgSelectRows58
    PgSelectSingle59{{"PgSelectSingle[59∈7] ➊^<br />ᐸunion_checklist_itemsᐳ"}}:::plan
    First57 --> PgSelectSingle59
    PgClassExpression117{{"PgClassExpression[117∈7] ➊^<br />ᐸ__union_ch...ems__.”id”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression117
    PgClassExpression118{{"PgClassExpression[118∈7] ➊^<br />ᐸ__union_ch...scription”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression118
    PgClassExpression119{{"PgClassExpression[119∈7] ➊^<br />ᐸ__union_ch...s__.”note”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression119
    PgSelect67[["PgSelect[67∈8] ➊<br />ᐸunion_topicsᐳ<br />ᐳUnionTopic"]]:::plan
    Object10 & Access66 --> PgSelect67
    First71{{"First[71∈8] ➊^"}}:::plan
    PgSelectRows72[["PgSelectRows[72∈8] ➊^"]]:::plan
    PgSelectRows72 --> First71
    PgSelect67 --> PgSelectRows72
    PgSelectSingle73{{"PgSelectSingle[73∈8] ➊^<br />ᐸunion_topicsᐳ"}}:::plan
    First71 --> PgSelectSingle73
    PgClassExpression120{{"PgClassExpression[120∈8] ➊^<br />ᐸ__union_topics__.”id”ᐳ"}}:::plan
    PgSelectSingle73 --> PgClassExpression120
    PgClassExpression121{{"PgClassExpression[121∈8] ➊^<br />ᐸ__union_to...__.”title”ᐳ"}}:::plan
    PgSelectSingle73 --> PgClassExpression121
    PgSelect75[["PgSelect[75∈9] ➊<br />ᐸunion_postsᐳ<br />ᐳUnionPost"]]:::plan
    Object10 & Access66 --> PgSelect75
    First79{{"First[79∈9] ➊^"}}:::plan
    PgSelectRows80[["PgSelectRows[80∈9] ➊^"]]:::plan
    PgSelectRows80 --> First79
    PgSelect75 --> PgSelectRows80
    PgSelectSingle81{{"PgSelectSingle[81∈9] ➊^<br />ᐸunion_postsᐳ"}}:::plan
    First79 --> PgSelectSingle81
    PgClassExpression122{{"PgClassExpression[122∈9] ➊^<br />ᐸ__union_posts__.”id”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression122
    PgClassExpression123{{"PgClassExpression[123∈9] ➊^<br />ᐸ__union_posts__.”title”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression123
    PgClassExpression124{{"PgClassExpression[124∈9] ➊^<br />ᐸ__union_po...scription”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression124
    PgClassExpression125{{"PgClassExpression[125∈9] ➊^<br />ᐸ__union_posts__.”note”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression125
    PgSelect83[["PgSelect[83∈10] ➊<br />ᐸunion_dividersᐳ<br />ᐳUnionDivider"]]:::plan
    Object10 & Access66 --> PgSelect83
    First87{{"First[87∈10] ➊^"}}:::plan
    PgSelectRows88[["PgSelectRows[88∈10] ➊^"]]:::plan
    PgSelectRows88 --> First87
    PgSelect83 --> PgSelectRows88
    PgSelectSingle89{{"PgSelectSingle[89∈10] ➊^<br />ᐸunion_dividersᐳ"}}:::plan
    First87 --> PgSelectSingle89
    PgClassExpression126{{"PgClassExpression[126∈10] ➊^<br />ᐸ__union_dividers__.”id”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression126
    PgClassExpression127{{"PgClassExpression[127∈10] ➊^<br />ᐸ__union_di...__.”title”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression127
    PgClassExpression128{{"PgClassExpression[128∈10] ➊^<br />ᐸ__union_di...__.”color”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression128
    PgSelect91[["PgSelect[91∈11] ➊<br />ᐸunion_checklistsᐳ<br />ᐳUnionChecklist"]]:::plan
    Object10 & Access66 --> PgSelect91
    First95{{"First[95∈11] ➊^"}}:::plan
    PgSelectRows96[["PgSelectRows[96∈11] ➊^"]]:::plan
    PgSelectRows96 --> First95
    PgSelect91 --> PgSelectRows96
    PgSelectSingle97{{"PgSelectSingle[97∈11] ➊^<br />ᐸunion_checklistsᐳ"}}:::plan
    First95 --> PgSelectSingle97
    PgClassExpression129{{"PgClassExpression[129∈11] ➊^<br />ᐸ__union_ch...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle97 --> PgClassExpression129
    PgClassExpression130{{"PgClassExpression[130∈11] ➊^<br />ᐸ__union_ch...__.”title”ᐳ"}}:::plan
    PgSelectSingle97 --> PgClassExpression130
    PgSelect99[["PgSelect[99∈12] ➊<br />ᐸunion_checklist_itemsᐳ<br />ᐳUnionChecklistItem"]]:::plan
    Object10 & Access66 --> PgSelect99
    First103{{"First[103∈12] ➊^"}}:::plan
    PgSelectRows104[["PgSelectRows[104∈12] ➊^"]]:::plan
    PgSelectRows104 --> First103
    PgSelect99 --> PgSelectRows104
    PgSelectSingle105{{"PgSelectSingle[105∈12] ➊^<br />ᐸunion_checklist_itemsᐳ"}}:::plan
    First103 --> PgSelectSingle105
    PgClassExpression131{{"PgClassExpression[131∈12] ➊^<br />ᐸ__union_ch...ems__.”id”ᐳ"}}:::plan
    PgSelectSingle105 --> PgClassExpression131
    PgClassExpression132{{"PgClassExpression[132∈12] ➊^<br />ᐸ__union_ch...scription”ᐳ"}}:::plan
    PgSelectSingle105 --> PgClassExpression132
    PgClassExpression133{{"PgClassExpression[133∈12] ➊^<br />ᐸ__union_ch...s__.”note”ᐳ"}}:::plan
    PgSelectSingle105 --> PgClassExpression133

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect7,Access8,Access9,Object10,First11,PgSelectRows12,PgSelectSingle13,PgClassExpression14,Lambda16,PgClassExpression17,PgUnionAll20,First22,Access60,Access61,Constant62,List63,Lambda64,Access65,Access66,Access134,Constant135 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect25,First29,PgSelectRows30,PgSelectSingle31,PgClassExpression106,PgClassExpression107 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect32,First36,PgSelectRows37,PgSelectSingle38,PgClassExpression108,PgClassExpression109,PgClassExpression110,PgClassExpression111 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgSelect39,First43,PgSelectRows44,PgSelectSingle45,PgClassExpression112,PgClassExpression113,PgClassExpression114 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect46,First50,PgSelectRows51,PgSelectSingle52,PgClassExpression115,PgClassExpression116 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgSelect53,First57,PgSelectRows58,PgSelectSingle59,PgClassExpression117,PgClassExpression118,PgClassExpression119 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgSelect67,First71,PgSelectRows72,PgSelectSingle73,PgClassExpression120,PgClassExpression121 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgSelect75,First79,PgSelectRows80,PgSelectSingle81,PgClassExpression122,PgClassExpression123,PgClassExpression124,PgClassExpression125 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgSelect83,First87,PgSelectRows88,PgSelectSingle89,PgClassExpression126,PgClassExpression127,PgClassExpression128 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgSelect91,First95,PgSelectRows96,PgSelectSingle97,PgClassExpression129,PgClassExpression130 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgSelect99,First103,PgSelectRows104,PgSelectSingle105,PgClassExpression131,PgClassExpression132,PgClassExpression133 bucket12

