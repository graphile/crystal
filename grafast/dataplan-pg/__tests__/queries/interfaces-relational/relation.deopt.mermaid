%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/interfaces-relational/relation"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 8, 9, 197, 10<br />2: PgSelect[7]<br />ᐳ: Access[11]<br />3: First[12]<br />ᐳ: 13, 14, 16, 17, 58<br />4: PgSelect[59]<br />ᐳ: Access[63]<br />5: First[64]<br />ᐳ: PgSelectSingle[65]"):::bucket
    Bucket1("Bucket 1 (polymorphic)<br />__typename: Lambda[17]<br />Deps: 17, 10, 14, 65"):::bucket
    Bucket2("Bucket 2 (polymorphicPartition)<br />|RelationalTopic<br />Deps: 10, 14, 65<br />ᐳRelationalTopic<br /><br />1: PgSelect[19]<br />ᐳ: Access[23]<br />2: First[24]<br />ᐳ: PgSelectSingle[25]"):::bucket
    Bucket3("Bucket 3 (polymorphicPartition)<br />|RelationalPost<br />Deps: 10, 14, 65<br />ᐳRelationalPost<br /><br />1: PgSelect[27]<br />ᐳ: Access[31]<br />2: First[32]<br />ᐳ: PgSelectSingle[33]"):::bucket
    Bucket4("Bucket 4 (polymorphicPartition)<br />|RelationalDivider<br />Deps: 10, 14, 65<br />ᐳRelationalDivider<br /><br />1: PgSelect[35]<br />ᐳ: Access[39]<br />2: First[40]<br />ᐳ: PgSelectSingle[41]"):::bucket
    Bucket5("Bucket 5 (polymorphicPartition)<br />|RelationalChecklist<br />Deps: 10, 14, 65<br />ᐳRelationalChecklist<br /><br />1: PgSelect[43]<br />ᐳ: Access[47]<br />2: First[48]<br />ᐳ: PgSelectSingle[49]"):::bucket
    Bucket6("Bucket 6 (polymorphicPartition)<br />|RelationalChecklistItem<br />Deps: 10, 14, 65<br />ᐳRelationalChecklistItem<br /><br />1: PgSelect[51]<br />ᐳ: Access[55]<br />2: First[56]<br />ᐳ: PgSelectSingle[57]"):::bucket
    Bucket7("Bucket 7 (combined)<br />Deps: 65, 10<br /><br />1: 103, 105, 152<br />ᐳ: Lambda[106]<br />2: PgSelect[153]<br />ᐳ: Access[157]<br />3: First[158]<br />ᐳ: PgSelectSingle[159]"):::bucket
    Bucket8("Bucket 8 (polymorphic)<br />__typename: Lambda[106]<br />Deps: 106, 10, 103, 159"):::bucket
    Bucket9("Bucket 9 (polymorphicPartition)<br />|RelationalTopic<br />Deps: 10, 103, 159<br />(5) ...ᐳRelationalTopic<br /><br />1: PgSelect[108]<br />ᐳ: Access[112]<br />2: First[113]<br />ᐳ: PgSelectSingle[114]"):::bucket
    Bucket10("Bucket 10 (polymorphicPartition)<br />|RelationalPost<br />Deps: 10, 103, 159<br />(5) ...ᐳRelationalPost<br /><br />1: PgSelect[116]<br />ᐳ: Access[120]<br />2: First[121]<br />ᐳ: PgSelectSingle[122]"):::bucket
    Bucket11("Bucket 11 (polymorphicPartition)<br />|RelationalDivider<br />Deps: 10, 103, 159<br />(5) ...ᐳRelationalDivider<br /><br />1: PgSelect[124]<br />ᐳ: Access[128]<br />2: First[129]<br />ᐳ: PgSelectSingle[130]"):::bucket
    Bucket12("Bucket 12 (polymorphicPartition)<br />|RelationalChecklist<br />Deps: 10, 103, 159<br />(5) ...ᐳRelationalChecklist<br /><br />1: PgSelect[132]<br />ᐳ: Access[136]<br />2: First[137]<br />ᐳ: PgSelectSingle[138]"):::bucket
    Bucket13("Bucket 13 (polymorphicPartition)<br />|RelationalChecklistItem<br />Deps: 10, 103, 159<br />(5) ...ᐳRelationalChecklistItem<br /><br />1: PgSelect[140]<br />ᐳ: Access[144]<br />2: First[145]<br />ᐳ: PgSelectSingle[146]"):::bucket
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[159]"):::bucket
    Bucket15("Bucket 15 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[159]"):::bucket
    Bucket16("Bucket 16 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[159]"):::bucket
    Bucket17("Bucket 17 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[159]"):::bucket
    Bucket18("Bucket 18 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[159]"):::bucket
    end
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6
    Bucket2 --> Bucket7
    Bucket3 --> Bucket7
    Bucket4 --> Bucket7
    Bucket5 --> Bucket7
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket8 --> Bucket9 & Bucket10 & Bucket11 & Bucket12 & Bucket13
    Bucket9 --> Bucket14
    Bucket10 --> Bucket15
    Bucket11 --> Bucket16
    Bucket12 --> Bucket17
    Bucket13 --> Bucket18

    %% plan dependencies
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸrelational_itemsᐳ<br />More deps:<br />- Object[10]<br />- Constantᐸ15ᐳ[197]"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ<br />Dependents: 13"}}:::plan
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    PgSelect59[["PgSelect[59∈0] ➊<br />ᐸrelational_itemsᐳ<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression58{{"PgClassExpression[58∈0] ➊<br />ᐸ__relation...parent_id”ᐳ"}}:::plan
    PgClassExpression58 --> PgSelect59
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    Access11{{"Access[11∈0] ➊<br />ᐸ7.itemsᐳ"}}:::plan
    PgSelect7 --> Access11
    First12[["First[12∈0] ➊"]]:::plan
    Access11 --> First12
    PgSelectSingle13{{"PgSelectSingle[13∈0] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First12 --> PgSelectSingle13
    PgClassExpression14{{"PgClassExpression[14∈0] ➊<br />ᐸ__relation...ems__.”id”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression14
    PgClassExpression16{{"PgClassExpression[16∈0] ➊<br />ᐸ__relation...s__.”type”ᐳ"}}:::plan
    PgSelectSingle13 --> PgClassExpression16
    PgSelectSingle13 --> PgClassExpression58
    Access63{{"Access[63∈0] ➊<br />ᐸ59.itemsᐳ"}}:::plan
    PgSelect59 --> Access63
    First64[["First[64∈0] ➊"]]:::plan
    Access63 --> First64
    PgSelectSingle65{{"PgSelectSingle[65∈0] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First64 --> PgSelectSingle65
    PgSelect19[["PgSelect[19∈2] ➊<br />ᐸrelational_topicsᐳ<br />ᐳRelationalTopic<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression14 --> PgSelect19
    Access23{{"Access[23∈2] ➊^<br />ᐸ19.itemsᐳ"}}:::plan
    PgSelect19 --> Access23
    First24[["First[24∈2] ➊^"]]:::plan
    Access23 --> First24
    PgSelectSingle25{{"PgSelectSingle[25∈2] ➊^<br />ᐸrelational_topicsᐳ"}}:::plan
    First24 --> PgSelectSingle25
    PgSelect27[["PgSelect[27∈3] ➊<br />ᐸrelational_postsᐳ<br />ᐳRelationalPost<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression14 --> PgSelect27
    Access31{{"Access[31∈3] ➊^<br />ᐸ27.itemsᐳ"}}:::plan
    PgSelect27 --> Access31
    First32[["First[32∈3] ➊^"]]:::plan
    Access31 --> First32
    PgSelectSingle33{{"PgSelectSingle[33∈3] ➊^<br />ᐸrelational_postsᐳ"}}:::plan
    First32 --> PgSelectSingle33
    PgSelect35[["PgSelect[35∈4] ➊<br />ᐸrelational_dividersᐳ<br />ᐳRelationalDivider<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression14 --> PgSelect35
    Access39{{"Access[39∈4] ➊^<br />ᐸ35.itemsᐳ"}}:::plan
    PgSelect35 --> Access39
    First40[["First[40∈4] ➊^"]]:::plan
    Access39 --> First40
    PgSelectSingle41{{"PgSelectSingle[41∈4] ➊^<br />ᐸrelational_dividersᐳ"}}:::plan
    First40 --> PgSelectSingle41
    PgSelect43[["PgSelect[43∈5] ➊<br />ᐸrelational_checklistsᐳ<br />ᐳRelationalChecklist<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression14 --> PgSelect43
    Access47{{"Access[47∈5] ➊^<br />ᐸ43.itemsᐳ"}}:::plan
    PgSelect43 --> Access47
    First48[["First[48∈5] ➊^"]]:::plan
    Access47 --> First48
    PgSelectSingle49{{"PgSelectSingle[49∈5] ➊^<br />ᐸrelational_checklistsᐳ"}}:::plan
    First48 --> PgSelectSingle49
    PgSelect51[["PgSelect[51∈6] ➊<br />ᐸrelational_checklist_itemsᐳ<br />ᐳRelationalChecklistItem<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression14 --> PgSelect51
    Access55{{"Access[55∈6] ➊^<br />ᐸ51.itemsᐳ"}}:::plan
    PgSelect51 --> Access55
    First56[["First[56∈6] ➊^"]]:::plan
    Access55 --> First56
    PgSelectSingle57{{"PgSelectSingle[57∈6] ➊^<br />ᐸrelational_checklist_itemsᐳ"}}:::plan
    First56 --> PgSelectSingle57
    PgSelect153[["PgSelect[153∈7] ➊^<br />ᐸpeopleᐳ<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression152{{"PgClassExpression[152∈7] ➊<br />ᐸ__relation...author_id”ᐳ<br />ᐳRelationalTopic<br />ᐳRelationalPost<br />ᐳRelationalDivider<br />ᐳRelationalChecklist<br />ᐳRelationalChecklistItem"}}:::plan
    PgClassExpression152 --> PgSelect153
    PgClassExpression103{{"PgClassExpression[103∈7] ➊<br />ᐸ__relation...ems__.”id”ᐳ<br />ᐳRelationalTopic<br />ᐳRelationalPost<br />ᐳRelationalDivider<br />ᐳRelationalChecklist<br />ᐳRelationalChecklistItem"}}:::plan
    PgSelectSingle65 --> PgClassExpression103
    PgClassExpression105{{"PgClassExpression[105∈7] ➊<br />ᐸ__relation...s__.”type”ᐳ<br />ᐳRelationalTopic<br />ᐳRelationalPost<br />ᐳRelationalDivider<br />ᐳRelationalChecklist<br />ᐳRelationalChecklistItem"}}:::plan
    PgSelectSingle65 --> PgClassExpression105
    Lambda106{{"Lambda[106∈7] ➊^<br />ᐸrelationalItemTypeNameFromTypeᐳ"}}:::plan
    PgClassExpression105 --> Lambda106
    PgSelectSingle65 --> PgClassExpression152
    Access157{{"Access[157∈7] ➊^<br />ᐸ153.itemsᐳ"}}:::plan
    PgSelect153 --> Access157
    First158[["First[158∈7] ➊^"]]:::plan
    Access157 --> First158
    PgSelectSingle159{{"PgSelectSingle[159∈7] ➊^<br />ᐸpeopleᐳ"}}:::plan
    First158 --> PgSelectSingle159
    PgSelect108[["PgSelect[108∈9] ➊<br />ᐸrelational_topicsᐳ<br />(5) ...ᐳRelationalTopic<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression103 --> PgSelect108
    Access112{{"Access[112∈9] ➊^<br />ᐸ108.itemsᐳ"}}:::plan
    PgSelect108 --> Access112
    First113[["First[113∈9] ➊^"]]:::plan
    Access112 --> First113
    PgSelectSingle114{{"PgSelectSingle[114∈9] ➊^<br />ᐸrelational_topicsᐳ"}}:::plan
    First113 --> PgSelectSingle114
    PgSelect116[["PgSelect[116∈10] ➊<br />ᐸrelational_postsᐳ<br />(5) ...ᐳRelationalPost<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression103 --> PgSelect116
    Access120{{"Access[120∈10] ➊^<br />ᐸ116.itemsᐳ"}}:::plan
    PgSelect116 --> Access120
    First121[["First[121∈10] ➊^"]]:::plan
    Access120 --> First121
    PgSelectSingle122{{"PgSelectSingle[122∈10] ➊^<br />ᐸrelational_postsᐳ"}}:::plan
    First121 --> PgSelectSingle122
    PgSelect124[["PgSelect[124∈11] ➊<br />ᐸrelational_dividersᐳ<br />(5) ...ᐳRelationalDivider<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression103 --> PgSelect124
    Access128{{"Access[128∈11] ➊^<br />ᐸ124.itemsᐳ"}}:::plan
    PgSelect124 --> Access128
    First129[["First[129∈11] ➊^"]]:::plan
    Access128 --> First129
    PgSelectSingle130{{"PgSelectSingle[130∈11] ➊^<br />ᐸrelational_dividersᐳ"}}:::plan
    First129 --> PgSelectSingle130
    PgSelect132[["PgSelect[132∈12] ➊<br />ᐸrelational_checklistsᐳ<br />(5) ...ᐳRelationalChecklist<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression103 --> PgSelect132
    Access136{{"Access[136∈12] ➊^<br />ᐸ132.itemsᐳ"}}:::plan
    PgSelect132 --> Access136
    First137[["First[137∈12] ➊^"]]:::plan
    Access136 --> First137
    PgSelectSingle138{{"PgSelectSingle[138∈12] ➊^<br />ᐸrelational_checklistsᐳ"}}:::plan
    First137 --> PgSelectSingle138
    PgSelect140[["PgSelect[140∈13] ➊<br />ᐸrelational_checklist_itemsᐳ<br />(5) ...ᐳRelationalChecklistItem<br />More deps:<br />- Object[10]"]]:::plan
    PgClassExpression103 --> PgSelect140
    Access144{{"Access[144∈13] ➊^<br />ᐸ140.itemsᐳ"}}:::plan
    PgSelect140 --> Access144
    First145[["First[145∈13] ➊^"]]:::plan
    Access144 --> First145
    PgSelectSingle146{{"PgSelectSingle[146∈13] ➊^<br />ᐸrelational_checklist_itemsᐳ"}}:::plan
    First145 --> PgSelectSingle146
    PgClassExpression192{{"PgClassExpression[192∈14] ➊<br />ᐸ__people__.”username”ᐳ<br />(5) ...ᐳRelationalTopic"}}:::plan
    PgSelectSingle159 --> PgClassExpression192
    PgClassExpression193{{"PgClassExpression[193∈15] ➊<br />ᐸ__people__.”username”ᐳ<br />(5) ...ᐳRelationalPost"}}:::plan
    PgSelectSingle159 --> PgClassExpression193
    PgClassExpression194{{"PgClassExpression[194∈16] ➊<br />ᐸ__people__.”username”ᐳ<br />(5) ...ᐳRelationalDivider"}}:::plan
    PgSelectSingle159 --> PgClassExpression194
    PgClassExpression195{{"PgClassExpression[195∈17] ➊<br />ᐸ__people__.”username”ᐳ<br />(5) ...ᐳRelationalChecklist"}}:::plan
    PgSelectSingle159 --> PgClassExpression195
    PgClassExpression196{{"PgClassExpression[196∈18] ➊<br />ᐸ__people__.”username”ᐳ<br />(5) ...ᐳRelationalChecklistItem"}}:::plan
    PgSelectSingle159 --> PgClassExpression196

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,PgSelect7,Access8,Access9,Object10,Access11,First12,PgSelectSingle13,PgClassExpression14,PgClassExpression16,PgClassExpression58,PgSelect59,Access63,First64,PgSelectSingle65 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgSelect19,Access23,First24,PgSelectSingle25 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect27,Access31,First32,PgSelectSingle33 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect35,Access39,First40,PgSelectSingle41 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgSelect43,Access47,First48,PgSelectSingle49 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect51,Access55,First56,PgSelectSingle57 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression103,PgClassExpression105,Lambda106,PgClassExpression152,PgSelect153,Access157,First158,PgSelectSingle159 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgSelect108,Access112,First113,PgSelectSingle114 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgSelect116,Access120,First121,PgSelectSingle122 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgSelect124,Access128,First129,PgSelectSingle130 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgSelect132,Access136,First137,PgSelectSingle138 bucket12
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgSelect140,Access144,First145,PgSelectSingle146 bucket13
    classDef bucket14 stroke:#a52a2a
    class Bucket14,PgClassExpression192 bucket14
    classDef bucket15 stroke:#ff00ff
    class Bucket15,PgClassExpression193 bucket15
    classDef bucket16 stroke:#f5deb3
    class Bucket16,PgClassExpression194 bucket16
    classDef bucket17 stroke:#696969
    class Bucket17,PgClassExpression195 bucket17
    classDef bucket18 stroke:#00bfff
    class Bucket18,PgClassExpression196 bucket18

