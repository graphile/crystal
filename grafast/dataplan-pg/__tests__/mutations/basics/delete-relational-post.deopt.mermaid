%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant86{{"Constant[86∈0] ➊<br />ᐸ4ᐳ"}}:::plan
    Constant87{{"Constant[87∈0] ➊<br />ᐸ3141592ᐳ"}}:::plan
    PgDeleteSingle8[["PgDeleteSingle[8∈1] ➊<br />ᐸrelational_posts(id)ᐳ"]]:::sideeffectplan
    Object11 & Constant86 --> PgDeleteSingle8
    PgSelect15[["PgSelect[15∈1] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgFromExpression17{{"PgFromExpression[17∈1] ➊"}}:::plan
    Object11 & PgFromExpression17 --> PgSelect15
    PgSelect26[["PgSelect[26∈1] ➊<br />ᐸrelational_posts_title_lowerᐳ"]]:::plan
    PgFromExpression28{{"PgFromExpression[28∈1] ➊"}}:::plan
    Object11 & PgFromExpression28 --> PgSelect26
    PgSelect33[["PgSelect[33∈1] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    PgClassExpression21{{"PgClassExpression[21∈1] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object11 & PgClassExpression21 --> PgSelect33
    PgSelect39[["PgSelect[39∈1] ➊<br />ᐸpeopleᐳ"]]:::plan
    PgClassExpression38{{"PgClassExpression[38∈1] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    Object11 & PgClassExpression38 --> PgSelect39
    PgClassExpression12{{"PgClassExpression[12∈1] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access13{{"Access[13∈1] ➊<br />ᐸ8.tᐳ"}}:::plan
    Access13 --> PgClassExpression12
    PgDeleteSingle8 --> Access13
    PgClassExpression14{{"PgClassExpression[14∈1] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    Access13 --> PgClassExpression14
    PgClassExpression14 --> PgFromExpression17
    First18{{"First[18∈1] ➊"}}:::plan
    PgSelectRows19[["PgSelectRows[19∈1] ➊"]]:::plan
    PgSelectRows19 --> First18
    PgSelect15 --> PgSelectRows19
    PgSelectSingle20{{"PgSelectSingle[20∈1] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First18 --> PgSelectSingle20
    PgSelectSingle20 --> PgClassExpression21
    PgClassExpression22{{"PgClassExpression[22∈1] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle20 --> PgClassExpression22
    PgClassExpression23{{"PgClassExpression[23∈1] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle20 --> PgClassExpression23
    PgClassExpression24{{"PgClassExpression[24∈1] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle20 --> PgClassExpression24
    PgClassExpression25{{"PgClassExpression[25∈1] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectSingle20 --> PgClassExpression25
    PgClassExpression25 --> PgFromExpression28
    First29{{"First[29∈1] ➊"}}:::plan
    PgSelectRows30[["PgSelectRows[30∈1] ➊"]]:::plan
    PgSelectRows30 --> First29
    PgSelect26 --> PgSelectRows30
    PgSelectSingle31{{"PgSelectSingle[31∈1] ➊<br />ᐸtextᐳ"}}:::plan
    First29 --> PgSelectSingle31
    PgClassExpression32{{"PgClassExpression[32∈1] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle31 --> PgClassExpression32
    First35{{"First[35∈1] ➊"}}:::plan
    PgSelectRows36[["PgSelectRows[36∈1] ➊"]]:::plan
    PgSelectRows36 --> First35
    PgSelect33 --> PgSelectRows36
    PgSelectSingle37{{"PgSelectSingle[37∈1] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First35 --> PgSelectSingle37
    PgSelectSingle37 --> PgClassExpression38
    First41{{"First[41∈1] ➊"}}:::plan
    PgSelectRows42[["PgSelectRows[42∈1] ➊"]]:::plan
    PgSelectRows42 --> First41
    PgSelect39 --> PgSelectRows42
    PgSelectSingle43{{"PgSelectSingle[43∈1] ➊<br />ᐸpeopleᐳ"}}:::plan
    First41 --> PgSelectSingle43
    PgClassExpression44{{"PgClassExpression[44∈1] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression44
    PgClassExpression45{{"PgClassExpression[45∈1] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression45
    PgDeleteSingle48[["PgDeleteSingle[48∈2] ➊<br />ᐸrelational_posts(id)ᐳ"]]:::sideeffectplan
    Object51{{"Object[51∈2] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object51 & Constant87 --> PgDeleteSingle48
    Access49{{"Access[49∈2] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access50{{"Access[50∈2] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access49 & Access50 --> Object51
    PgSelect55[["PgSelect[55∈2] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgFromExpression57{{"PgFromExpression[57∈2] ➊"}}:::plan
    Object51 & PgFromExpression57 --> PgSelect55
    PgSelect66[["PgSelect[66∈2] ➊<br />ᐸrelational_posts_title_lowerᐳ"]]:::plan
    PgFromExpression68{{"PgFromExpression[68∈2] ➊"}}:::plan
    Object51 & PgFromExpression68 --> PgSelect66
    PgSelect73[["PgSelect[73∈2] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    PgClassExpression61{{"PgClassExpression[61∈2] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object51 & PgClassExpression61 --> PgSelect73
    PgSelect79[["PgSelect[79∈2] ➊<br />ᐸpeopleᐳ"]]:::plan
    PgClassExpression78{{"PgClassExpression[78∈2] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    Object51 & PgClassExpression78 --> PgSelect79
    __Value2 --> Access49
    __Value2 --> Access50
    PgClassExpression52{{"PgClassExpression[52∈2] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access53{{"Access[53∈2] ➊<br />ᐸ48.tᐳ"}}:::plan
    Access53 --> PgClassExpression52
    PgDeleteSingle48 --> Access53
    PgClassExpression54{{"PgClassExpression[54∈2] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    Access53 --> PgClassExpression54
    PgClassExpression54 --> PgFromExpression57
    First58{{"First[58∈2] ➊"}}:::plan
    PgSelectRows59[["PgSelectRows[59∈2] ➊"]]:::plan
    PgSelectRows59 --> First58
    PgSelect55 --> PgSelectRows59
    PgSelectSingle60{{"PgSelectSingle[60∈2] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First58 --> PgSelectSingle60
    PgSelectSingle60 --> PgClassExpression61
    PgClassExpression62{{"PgClassExpression[62∈2] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression62
    PgClassExpression63{{"PgClassExpression[63∈2] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression63
    PgClassExpression64{{"PgClassExpression[64∈2] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression64
    PgClassExpression65{{"PgClassExpression[65∈2] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression65
    PgClassExpression65 --> PgFromExpression68
    First69{{"First[69∈2] ➊"}}:::plan
    PgSelectRows70[["PgSelectRows[70∈2] ➊"]]:::plan
    PgSelectRows70 --> First69
    PgSelect66 --> PgSelectRows70
    PgSelectSingle71{{"PgSelectSingle[71∈2] ➊<br />ᐸtextᐳ"}}:::plan
    First69 --> PgSelectSingle71
    PgClassExpression72{{"PgClassExpression[72∈2] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression72
    First75{{"First[75∈2] ➊"}}:::plan
    PgSelectRows76[["PgSelectRows[76∈2] ➊"]]:::plan
    PgSelectRows76 --> First75
    PgSelect73 --> PgSelectRows76
    PgSelectSingle77{{"PgSelectSingle[77∈2] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First75 --> PgSelectSingle77
    PgSelectSingle77 --> PgClassExpression78
    First81{{"First[81∈2] ➊"}}:::plan
    PgSelectRows82[["PgSelectRows[82∈2] ➊"]]:::plan
    PgSelectRows82 --> First81
    PgSelect79 --> PgSelectRows82
    PgSelectSingle83{{"PgSelectSingle[83∈2] ➊<br />ᐸpeopleᐳ"}}:::plan
    First81 --> PgSelectSingle83
    PgClassExpression84{{"PgClassExpression[84∈2] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression84
    PgClassExpression85{{"PgClassExpression[85∈2] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression85

    %% define steps

    subgraph "Buckets for mutations/basics/delete-relational-post"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access9,Access10,Object11,Constant86,Constant87 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 11, 86<br /><br />1: PgDeleteSingle[8]<br />2: <br />ᐳ: 13, 12, 14, 17<br />3: PgSelect[15]<br />4: PgSelectRows[19]<br />ᐳ: 18, 20, 21, 22, 23, 24, 25, 28<br />5: PgSelect[26], PgSelect[33]<br />6: PgSelectRows[30], PgSelectRows[36]<br />ᐳ: 29, 31, 32, 35, 37, 38<br />7: PgSelect[39]<br />8: PgSelectRows[42]<br />ᐳ: 41, 43, 44, 45"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgDeleteSingle8,PgClassExpression12,Access13,PgClassExpression14,PgSelect15,PgFromExpression17,First18,PgSelectRows19,PgSelectSingle20,PgClassExpression21,PgClassExpression22,PgClassExpression23,PgClassExpression24,PgClassExpression25,PgSelect26,PgFromExpression28,First29,PgSelectRows30,PgSelectSingle31,PgClassExpression32,PgSelect33,First35,PgSelectRows36,PgSelectSingle37,PgClassExpression38,PgSelect39,First41,PgSelectRows42,PgSelectSingle43,PgClassExpression44,PgClassExpression45 bucket1
    Bucket2("Bucket 2 (mutationField)<br />Deps: 87, 2<br /><br />1: Access[49]<br />2: Access[50]<br />3: Object[51]<br />4: PgDeleteSingle[48]<br />5: <br />ᐳ: 53, 52, 54, 57<br />6: PgSelect[55]<br />7: PgSelectRows[59]<br />ᐳ: 58, 60, 61, 62, 63, 64, 65, 68<br />8: PgSelect[66], PgSelect[73]<br />9: PgSelectRows[70], PgSelectRows[76]<br />ᐳ: 69, 71, 72, 75, 77, 78<br />10: PgSelect[79]<br />11: PgSelectRows[82]<br />ᐳ: 81, 83, 84, 85"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgDeleteSingle48,Access49,Access50,Object51,PgClassExpression52,Access53,PgClassExpression54,PgSelect55,PgFromExpression57,First58,PgSelectRows59,PgSelectSingle60,PgClassExpression61,PgClassExpression62,PgClassExpression63,PgClassExpression64,PgClassExpression65,PgSelect66,PgFromExpression68,First69,PgSelectRows70,PgSelectSingle71,PgClassExpression72,PgSelect73,First75,PgSelectRows76,PgSelectSingle77,PgClassExpression78,PgSelect79,First81,PgSelectRows82,PgSelectSingle83,PgClassExpression84,PgClassExpression85 bucket2
    Bucket0 --> Bucket1 & Bucket2
    end
