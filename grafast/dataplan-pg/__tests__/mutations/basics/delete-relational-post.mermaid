%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access10 --> Object11
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access10
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant94{{"Constant[94∈0] ➊<br />ᐸ4ᐳ"}}:::plan
    Constant95{{"Constant[95∈0] ➊<br />ᐸ3141592ᐳ"}}:::plan
    PgDeleteSingle8[["PgDeleteSingle[8∈1] ➊<br />ᐸrelational_posts(id)ᐳ"]]:::sideeffectplan
    Object11 & Constant94 --> PgDeleteSingle8
    PgSelect15[["PgSelect[15∈2] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgFromExpression19{{"PgFromExpression[19∈2] ➊"}}:::plan
    Object11 & PgFromExpression19 --> PgSelect15
    PgClassExpression12{{"PgClassExpression[12∈2] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access13{{"Access[13∈2] ➊<br />ᐸ8.tᐳ"}}:::plan
    Access13 --> PgClassExpression12
    PgDeleteSingle8 --> Access13
    PgClassExpression14{{"PgClassExpression[14∈2] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    Access13 --> PgClassExpression14
    PgClassExpression14 --> PgFromExpression19
    First20{{"First[20∈2] ➊"}}:::plan
    PgSelectRows21[["PgSelectRows[21∈2] ➊"]]:::plan
    PgSelectRows21 --> First20
    PgSelect15 --> PgSelectRows21
    PgSelectSingle22{{"PgSelectSingle[22∈2] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First20 --> PgSelectSingle22
    PgSelect28[["PgSelect[28∈3] ➊<br />ᐸrelational_posts_title_lowerᐳ"]]:::plan
    PgFromExpression32{{"PgFromExpression[32∈3] ➊"}}:::plan
    Object11 & PgFromExpression32 --> PgSelect28
    PgSelect37[["PgSelect[37∈3] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    PgClassExpression23{{"PgClassExpression[23∈3] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object11 & PgClassExpression23 --> PgSelect37
    PgSelect43[["PgSelect[43∈3] ➊<br />ᐸpeopleᐳ"]]:::plan
    PgClassExpression42{{"PgClassExpression[42∈3] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    Object11 & PgClassExpression42 --> PgSelect43
    PgSelectSingle22 --> PgClassExpression23
    PgClassExpression24{{"PgClassExpression[24∈3] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression24
    PgClassExpression25{{"PgClassExpression[25∈3] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression25
    PgClassExpression26{{"PgClassExpression[26∈3] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression26
    PgClassExpression27{{"PgClassExpression[27∈3] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectSingle22 --> PgClassExpression27
    PgClassExpression27 --> PgFromExpression32
    First33{{"First[33∈3] ➊"}}:::plan
    PgSelectRows34[["PgSelectRows[34∈3] ➊"]]:::plan
    PgSelectRows34 --> First33
    PgSelect28 --> PgSelectRows34
    PgSelectSingle35{{"PgSelectSingle[35∈3] ➊<br />ᐸtextᐳ"}}:::plan
    First33 --> PgSelectSingle35
    PgClassExpression36{{"PgClassExpression[36∈3] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle35 --> PgClassExpression36
    First39{{"First[39∈3] ➊"}}:::plan
    PgSelectRows40[["PgSelectRows[40∈3] ➊"]]:::plan
    PgSelectRows40 --> First39
    PgSelect37 --> PgSelectRows40
    PgSelectSingle41{{"PgSelectSingle[41∈3] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First39 --> PgSelectSingle41
    PgSelectSingle41 --> PgClassExpression42
    First45{{"First[45∈3] ➊"}}:::plan
    PgSelectRows46[["PgSelectRows[46∈3] ➊"]]:::plan
    PgSelectRows46 --> First45
    PgSelect43 --> PgSelectRows46
    PgSelectSingle47{{"PgSelectSingle[47∈3] ➊<br />ᐸpeopleᐳ"}}:::plan
    First45 --> PgSelectSingle47
    PgClassExpression48{{"PgClassExpression[48∈4] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression48
    PgClassExpression49{{"PgClassExpression[49∈4] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle47 --> PgClassExpression49
    PgDeleteSingle52[["PgDeleteSingle[52∈5] ➊<br />ᐸrelational_posts(id)ᐳ"]]:::sideeffectplan
    Object55{{"Object[55∈5] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object55 & Constant95 --> PgDeleteSingle52
    Access53{{"Access[53∈5] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access54{{"Access[54∈5] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access53 & Access54 --> Object55
    __Value2 --> Access53
    __Value2 --> Access54
    PgSelect59[["PgSelect[59∈6] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgFromExpression63{{"PgFromExpression[63∈6] ➊"}}:::plan
    Object55 & PgFromExpression63 --> PgSelect59
    PgClassExpression56{{"PgClassExpression[56∈6] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Access57{{"Access[57∈6] ➊<br />ᐸ52.tᐳ"}}:::plan
    Access57 --> PgClassExpression56
    PgDeleteSingle52 --> Access57
    PgClassExpression58{{"PgClassExpression[58∈6] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    Access57 --> PgClassExpression58
    PgClassExpression58 --> PgFromExpression63
    First64{{"First[64∈6] ➊"}}:::plan
    PgSelectRows65[["PgSelectRows[65∈6] ➊"]]:::plan
    PgSelectRows65 --> First64
    PgSelect59 --> PgSelectRows65
    PgSelectSingle66{{"PgSelectSingle[66∈6] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First64 --> PgSelectSingle66
    PgSelect72[["PgSelect[72∈7] ➊<br />ᐸrelational_posts_title_lowerᐳ"]]:::plan
    PgFromExpression76{{"PgFromExpression[76∈7] ➊"}}:::plan
    Object55 & PgFromExpression76 --> PgSelect72
    PgSelect81[["PgSelect[81∈7] ➊<br />ᐸrelational_itemsᐳ"]]:::plan
    PgClassExpression67{{"PgClassExpression[67∈7] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object55 & PgClassExpression67 --> PgSelect81
    PgSelect87[["PgSelect[87∈7] ➊<br />ᐸpeopleᐳ"]]:::plan
    PgClassExpression86{{"PgClassExpression[86∈7] ➊<br />ᐸ__relation...author_id”ᐳ"}}:::plan
    Object55 & PgClassExpression86 --> PgSelect87
    PgSelectSingle66 --> PgClassExpression67
    PgClassExpression68{{"PgClassExpression[68∈7] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression68
    PgClassExpression69{{"PgClassExpression[69∈7] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression69
    PgClassExpression70{{"PgClassExpression[70∈7] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression70
    PgClassExpression71{{"PgClassExpression[71∈7] ➊<br />ᐸ__relational_posts__ᐳ"}}:::plan
    PgSelectSingle66 --> PgClassExpression71
    PgClassExpression71 --> PgFromExpression76
    First77{{"First[77∈7] ➊"}}:::plan
    PgSelectRows78[["PgSelectRows[78∈7] ➊"]]:::plan
    PgSelectRows78 --> First77
    PgSelect72 --> PgSelectRows78
    PgSelectSingle79{{"PgSelectSingle[79∈7] ➊<br />ᐸtextᐳ"}}:::plan
    First77 --> PgSelectSingle79
    PgClassExpression80{{"PgClassExpression[80∈7] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle79 --> PgClassExpression80
    First83{{"First[83∈7] ➊"}}:::plan
    PgSelectRows84[["PgSelectRows[84∈7] ➊"]]:::plan
    PgSelectRows84 --> First83
    PgSelect81 --> PgSelectRows84
    PgSelectSingle85{{"PgSelectSingle[85∈7] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    First83 --> PgSelectSingle85
    PgSelectSingle85 --> PgClassExpression86
    First89{{"First[89∈7] ➊"}}:::plan
    PgSelectRows90[["PgSelectRows[90∈7] ➊"]]:::plan
    PgSelectRows90 --> First89
    PgSelect87 --> PgSelectRows90
    PgSelectSingle91{{"PgSelectSingle[91∈7] ➊<br />ᐸpeopleᐳ"}}:::plan
    First89 --> PgSelectSingle91
    PgClassExpression92{{"PgClassExpression[92∈8] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle91 --> PgClassExpression92
    PgClassExpression93{{"PgClassExpression[93∈8] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle91 --> PgClassExpression93

    %% define steps

    subgraph "Buckets for mutations/basics/delete-relational-post"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access9,Access10,Object11,Constant94,Constant95 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 11, 94"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgDeleteSingle8 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 8, 11<br /><br />ROOT PgDeleteSingle{1}ᐸrelational_posts(id)ᐳ[8]<br />1: <br />ᐳ: 13, 12, 14, 19<br />2: PgSelect[15]<br />3: PgSelectRows[21]<br />ᐳ: First[20], PgSelectSingle[22]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression12,Access13,PgClassExpression14,PgSelect15,PgFromExpression19,First20,PgSelectRows21,PgSelectSingle22 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 22, 11<br /><br />ROOT PgSelectSingle{2}ᐸrelational_postsᐳ[22]<br />1: <br />ᐳ: 23, 24, 25, 26, 27, 32<br />2: PgSelect[28], PgSelect[37]<br />3: PgSelectRows[34], PgSelectRows[40]<br />ᐳ: 33, 35, 36, 39, 41, 42<br />4: PgSelect[43]<br />5: PgSelectRows[46]<br />ᐳ: First[45], PgSelectSingle[47]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression23,PgClassExpression24,PgClassExpression25,PgClassExpression26,PgClassExpression27,PgSelect28,PgFromExpression32,First33,PgSelectRows34,PgSelectSingle35,PgClassExpression36,PgSelect37,First39,PgSelectRows40,PgSelectSingle41,PgClassExpression42,PgSelect43,First45,PgSelectRows46,PgSelectSingle47 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 47<br /><br />ROOT PgSelectSingle{3}ᐸpeopleᐳ[47]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression48,PgClassExpression49 bucket4
    Bucket5("Bucket 5 (mutationField)<br />Deps: 95, 2<br /><br />1: Access[53]<br />2: Access[54]<br />3: Object[55]<br />4: PgDeleteSingle[52]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgDeleteSingle52,Access53,Access54,Object55 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 52, 55<br /><br />ROOT PgDeleteSingle{5}ᐸrelational_posts(id)ᐳ[52]<br />1: <br />ᐳ: 57, 56, 58, 63<br />2: PgSelect[59]<br />3: PgSelectRows[65]<br />ᐳ: First[64], PgSelectSingle[66]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgClassExpression56,Access57,PgClassExpression58,PgSelect59,PgFromExpression63,First64,PgSelectRows65,PgSelectSingle66 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 66, 55<br /><br />ROOT PgSelectSingle{6}ᐸrelational_postsᐳ[66]<br />1: <br />ᐳ: 67, 68, 69, 70, 71, 76<br />2: PgSelect[72], PgSelect[81]<br />3: PgSelectRows[78], PgSelectRows[84]<br />ᐳ: 77, 79, 80, 83, 85, 86<br />4: PgSelect[87]<br />5: PgSelectRows[90]<br />ᐳ: First[89], PgSelectSingle[91]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression67,PgClassExpression68,PgClassExpression69,PgClassExpression70,PgClassExpression71,PgSelect72,PgFromExpression76,First77,PgSelectRows78,PgSelectSingle79,PgClassExpression80,PgSelect81,First83,PgSelectRows84,PgSelectSingle85,PgClassExpression86,PgSelect87,First89,PgSelectRows90,PgSelectSingle91 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 91<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[91]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression92,PgClassExpression93 bucket8
    Bucket0 --> Bucket1 & Bucket5
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket5 --> Bucket6
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    end
