%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object15{{"Object[15∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access14{{"Access[14∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access13 & Access14 --> Object15
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access13
    __Value2 --> Access14
    Lambda197{{"Lambda[197∈0] ➊<br />ᐸcalculateLimitAndOffsetSQLᐳ"}}:::plan
    Constant350{{"Constant[350∈0] ➊<br />ᐸ[Object: null prototype] {   cursorLower: null,   cursorUppeᐳ"}}:::plan
    Constant350 --> Lambda197
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant190{{"Constant[190∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant342{{"Constant[342∈0] ➊<br />ᐸ4ᐳ"}}:::plan
    Constant343{{"Constant[343∈0] ➊<br />ᐸ'A description'ᐳ"}}:::plan
    Constant345{{"Constant[345∈0] ➊<br />ᐸ'A note'ᐳ"}}:::plan
    Constant348{{"Constant[348∈0] ➊<br />ᐸ3141592ᐳ"}}:::plan
    PgUpdateSingle12[["PgUpdateSingle[12∈1] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object15 & Constant342 & Constant343 --> PgUpdateSingle12
    PgSelect18[["PgSelect[18∈2] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression16{{"PgClassExpression[16∈2] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object15 & PgClassExpression16 & Lambda197 & Lambda197 & Lambda197 & Lambda197 --> PgSelect18
    PgUpdateSingle12 --> PgClassExpression16
    First22{{"First[22∈2] ➊"}}:::plan
    PgSelect18 --> First22
    PgSelectSingle23{{"PgSelectSingle[23∈2] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First22 --> PgSelectSingle23
    PgClassExpression24{{"PgClassExpression[24∈3] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression24
    PgClassExpression25{{"PgClassExpression[25∈3] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression25
    PgClassExpression26{{"PgClassExpression[26∈3] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression26
    PgClassExpression27{{"PgClassExpression[27∈3] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression27
    PgSelectSingle34{{"PgSelectSingle[34∈3] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys218{{"RemapKeys[218∈3] ➊<br />ᐸ23:{”0”:7}ᐳ"}}:::plan
    RemapKeys218 --> PgSelectSingle34
    PgClassExpression35{{"PgClassExpression[35∈3] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle34 --> PgClassExpression35
    PgSelectSingle39{{"PgSelectSingle[39∈3] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle23 --> PgSelectSingle39
    PgClassExpression40{{"PgClassExpression[40∈3] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle39 --> PgClassExpression40
    PgSelectSingle49{{"PgSelectSingle[49∈3] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys198{{"RemapKeys[198∈3] ➊<br />ᐸ39:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys198 --> PgSelectSingle49
    PgSelectSingle39 --> RemapKeys198
    PgSelectSingle23 --> RemapKeys218
    PgClassExpression50{{"PgClassExpression[50∈4] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression50
    PgClassExpression51{{"PgClassExpression[51∈4] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression51
    PgUpdateSingle58[["PgUpdateSingle[58∈5] ➊<br />ᐸrelational_posts(id;note)ᐳ"]]:::sideeffectplan
    Object61{{"Object[61∈5] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object61 & Constant342 & Constant345 --> PgUpdateSingle58
    Access59{{"Access[59∈5] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access60{{"Access[60∈5] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access59 & Access60 --> Object61
    __Value2 --> Access59
    __Value2 --> Access60
    PgSelect64[["PgSelect[64∈6] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression62{{"PgClassExpression[62∈6] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object61 & PgClassExpression62 & Lambda197 & Lambda197 & Lambda197 & Lambda197 --> PgSelect64
    PgUpdateSingle58 --> PgClassExpression62
    First68{{"First[68∈6] ➊"}}:::plan
    PgSelect64 --> First68
    PgSelectSingle69{{"PgSelectSingle[69∈6] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First68 --> PgSelectSingle69
    PgClassExpression70{{"PgClassExpression[70∈7] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression70
    PgClassExpression71{{"PgClassExpression[71∈7] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression71
    PgClassExpression72{{"PgClassExpression[72∈7] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression72
    PgClassExpression73{{"PgClassExpression[73∈7] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression73
    PgSelectSingle80{{"PgSelectSingle[80∈7] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys256{{"RemapKeys[256∈7] ➊<br />ᐸ69:{”0”:7}ᐳ"}}:::plan
    RemapKeys256 --> PgSelectSingle80
    PgClassExpression81{{"PgClassExpression[81∈7] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression81
    PgSelectSingle85{{"PgSelectSingle[85∈7] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle69 --> PgSelectSingle85
    PgClassExpression86{{"PgClassExpression[86∈7] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle85 --> PgClassExpression86
    PgSelectSingle95{{"PgSelectSingle[95∈7] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys236{{"RemapKeys[236∈7] ➊<br />ᐸ85:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys236 --> PgSelectSingle95
    PgSelectSingle85 --> RemapKeys236
    PgSelectSingle69 --> RemapKeys256
    PgClassExpression96{{"PgClassExpression[96∈8] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression96
    PgClassExpression97{{"PgClassExpression[97∈8] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression97
    PgUpdateSingle104[["PgUpdateSingle[104∈9] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object107{{"Object[107∈9] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object107 & Constant342 & Constant190 --> PgUpdateSingle104
    Access105{{"Access[105∈9] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access106{{"Access[106∈9] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access105 & Access106 --> Object107
    __Value2 --> Access105
    __Value2 --> Access106
    PgSelect110[["PgSelect[110∈10] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression108{{"PgClassExpression[108∈10] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object107 & PgClassExpression108 & Lambda197 & Lambda197 & Lambda197 & Lambda197 --> PgSelect110
    PgUpdateSingle104 --> PgClassExpression108
    First114{{"First[114∈10] ➊"}}:::plan
    PgSelect110 --> First114
    PgSelectSingle115{{"PgSelectSingle[115∈10] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First114 --> PgSelectSingle115
    PgClassExpression116{{"PgClassExpression[116∈11] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle115 --> PgClassExpression116
    PgClassExpression117{{"PgClassExpression[117∈11] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle115 --> PgClassExpression117
    PgClassExpression118{{"PgClassExpression[118∈11] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle115 --> PgClassExpression118
    PgClassExpression119{{"PgClassExpression[119∈11] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle115 --> PgClassExpression119
    PgSelectSingle126{{"PgSelectSingle[126∈11] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys294{{"RemapKeys[294∈11] ➊<br />ᐸ115:{”0”:7}ᐳ"}}:::plan
    RemapKeys294 --> PgSelectSingle126
    PgClassExpression127{{"PgClassExpression[127∈11] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle126 --> PgClassExpression127
    PgSelectSingle131{{"PgSelectSingle[131∈11] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle115 --> PgSelectSingle131
    PgClassExpression132{{"PgClassExpression[132∈11] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle131 --> PgClassExpression132
    PgSelectSingle141{{"PgSelectSingle[141∈11] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys274{{"RemapKeys[274∈11] ➊<br />ᐸ131:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys274 --> PgSelectSingle141
    PgSelectSingle131 --> RemapKeys274
    PgSelectSingle115 --> RemapKeys294
    PgClassExpression142{{"PgClassExpression[142∈12] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle141 --> PgClassExpression142
    PgClassExpression143{{"PgClassExpression[143∈12] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle141 --> PgClassExpression143
    PgUpdateSingle150[["PgUpdateSingle[150∈13] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object153{{"Object[153∈13] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object153 & Constant348 & Constant190 --> PgUpdateSingle150
    Access151{{"Access[151∈13] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access152{{"Access[152∈13] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access151 & Access152 --> Object153
    __Value2 --> Access151
    __Value2 --> Access152
    PgSelect156[["PgSelect[156∈14] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression154{{"PgClassExpression[154∈14] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object153 & PgClassExpression154 & Lambda197 & Lambda197 & Lambda197 & Lambda197 --> PgSelect156
    PgUpdateSingle150 --> PgClassExpression154
    First160{{"First[160∈14] ➊"}}:::plan
    PgSelect156 --> First160
    PgSelectSingle161{{"PgSelectSingle[161∈14] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First160 --> PgSelectSingle161
    PgClassExpression162{{"PgClassExpression[162∈15] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle161 --> PgClassExpression162
    PgClassExpression163{{"PgClassExpression[163∈15] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle161 --> PgClassExpression163
    PgClassExpression164{{"PgClassExpression[164∈15] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle161 --> PgClassExpression164
    PgClassExpression165{{"PgClassExpression[165∈15] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle161 --> PgClassExpression165
    PgSelectSingle172{{"PgSelectSingle[172∈15] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys332{{"RemapKeys[332∈15] ➊<br />ᐸ161:{”0”:7}ᐳ"}}:::plan
    RemapKeys332 --> PgSelectSingle172
    PgClassExpression173{{"PgClassExpression[173∈15] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle172 --> PgClassExpression173
    PgSelectSingle177{{"PgSelectSingle[177∈15] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle161 --> PgSelectSingle177
    PgClassExpression178{{"PgClassExpression[178∈15] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle177 --> PgClassExpression178
    PgSelectSingle187{{"PgSelectSingle[187∈15] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys312{{"RemapKeys[312∈15] ➊<br />ᐸ177:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys312 --> PgSelectSingle187
    PgSelectSingle177 --> RemapKeys312
    PgSelectSingle161 --> RemapKeys332
    PgClassExpression188{{"PgClassExpression[188∈16] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression188
    PgClassExpression189{{"PgClassExpression[189∈16] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression189

    %% define steps

    subgraph "Buckets for mutations/basics/update-relational-post"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access13,Access14,Object15,Constant190,Lambda197,Constant342,Constant343,Constant345,Constant348,Constant350 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 15, 342, 343, 197"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgUpdateSingle12 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 12, 15, 197<br /><br />ROOT PgUpdateSingle{1}ᐸrelational_posts(id;description)ᐳ[12]<br />1: <br />ᐳ: PgClassExpression[16]<br />2: PgSelect[18]<br />ᐳ: First[22], PgSelectSingle[23]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression16,PgSelect18,First22,PgSelectSingle23 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 23<br /><br />ROOT PgSelectSingle{2}ᐸrelational_postsᐳ[23]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression24,PgClassExpression25,PgClassExpression26,PgClassExpression27,PgSelectSingle34,PgClassExpression35,PgSelectSingle39,PgClassExpression40,PgSelectSingle49,RemapKeys198,RemapKeys218 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 49<br /><br />ROOT PgSelectSingle{3}ᐸpeopleᐳ[49]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression50,PgClassExpression51 bucket4
    Bucket5("Bucket 5 (mutationField)<br />Deps: 342, 345, 2, 197<br /><br />1: Access[59]<br />2: Access[60]<br />3: Object[61]<br />4: PgUpdateSingle[58]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgUpdateSingle58,Access59,Access60,Object61 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 58, 61, 197<br /><br />ROOT PgUpdateSingle{5}ᐸrelational_posts(id;note)ᐳ[58]<br />1: <br />ᐳ: PgClassExpression[62]<br />2: PgSelect[64]<br />ᐳ: First[68], PgSelectSingle[69]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgClassExpression62,PgSelect64,First68,PgSelectSingle69 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 69<br /><br />ROOT PgSelectSingle{6}ᐸrelational_postsᐳ[69]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression70,PgClassExpression71,PgClassExpression72,PgClassExpression73,PgSelectSingle80,PgClassExpression81,PgSelectSingle85,PgClassExpression86,PgSelectSingle95,RemapKeys236,RemapKeys256 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 95<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[95]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression96,PgClassExpression97 bucket8
    Bucket9("Bucket 9 (mutationField)<br />Deps: 342, 190, 2, 197<br /><br />1: Access[105]<br />2: Access[106]<br />3: Object[107]<br />4: PgUpdateSingle[104]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgUpdateSingle104,Access105,Access106,Object107 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 104, 107, 197<br /><br />ROOT PgUpdateSingle{9}ᐸrelational_posts(id;description)ᐳ[104]<br />1: <br />ᐳ: PgClassExpression[108]<br />2: PgSelect[110]<br />ᐳ: First[114], PgSelectSingle[115]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression108,PgSelect110,First114,PgSelectSingle115 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 115<br /><br />ROOT PgSelectSingle{10}ᐸrelational_postsᐳ[115]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgClassExpression116,PgClassExpression117,PgClassExpression118,PgClassExpression119,PgSelectSingle126,PgClassExpression127,PgSelectSingle131,PgClassExpression132,PgSelectSingle141,RemapKeys274,RemapKeys294 bucket11
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 141<br /><br />ROOT PgSelectSingle{11}ᐸpeopleᐳ[141]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgClassExpression142,PgClassExpression143 bucket12
    Bucket13("Bucket 13 (mutationField)<br />Deps: 348, 190, 2, 197<br /><br />1: Access[151]<br />2: Access[152]<br />3: Object[153]<br />4: PgUpdateSingle[150]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgUpdateSingle150,Access151,Access152,Object153 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 150, 153, 197<br /><br />ROOT PgUpdateSingle{13}ᐸrelational_posts(id;description)ᐳ[150]<br />1: <br />ᐳ: PgClassExpression[154]<br />2: PgSelect[156]<br />ᐳ: First[160], PgSelectSingle[161]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14,PgClassExpression154,PgSelect156,First160,PgSelectSingle161 bucket14
    Bucket15("Bucket 15 (nullableBoundary)<br />Deps: 161<br /><br />ROOT PgSelectSingle{14}ᐸrelational_postsᐳ[161]"):::bucket
    classDef bucket15 stroke:#ff00ff
    class Bucket15,PgClassExpression162,PgClassExpression163,PgClassExpression164,PgClassExpression165,PgSelectSingle172,PgClassExpression173,PgSelectSingle177,PgClassExpression178,PgSelectSingle187,RemapKeys312,RemapKeys332 bucket15
    Bucket16("Bucket 16 (nullableBoundary)<br />Deps: 187<br /><br />ROOT PgSelectSingle{15}ᐸpeopleᐳ[187]"):::bucket
    classDef bucket16 stroke:#f5deb3
    class Bucket16,PgClassExpression188,PgClassExpression189 bucket16
    Bucket0 --> Bucket1 & Bucket5 & Bucket9 & Bucket13
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket5 --> Bucket6
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket9 --> Bucket10
    Bucket10 --> Bucket11
    Bucket11 --> Bucket12
    Bucket13 --> Bucket14
    Bucket14 --> Bucket15
    Bucket15 --> Bucket16
    end
